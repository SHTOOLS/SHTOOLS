<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="python,  spherical harmonics software package, spherical harmonic transform, legendre functions, multitaper spectral analysis, fortran, Python, gravity, magnetic field">
<title>SHLocalizedAdmitCorr (Python) | SHTOOLS - Tools for working with spherical harmonics</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://shtools.github.io/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> SHTOOLS</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/" target="_blank">GitHub</a></li>
                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/wiki" target="_blank">Wiki</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:mark.wieczorek@oca.eu?subject=SHTOOLS feedback&body=I have some feedback about SHLocalizedAdmitCorr (Python) page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="SHLocalizedAdmitCorr (Python)">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">SHTOOLS 4.1</li>
  
  
  
      
  
  <li>
      <a href="#">Getting started</a>
      <ul>
          
          
          
          <li><a href="index.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="installing.html">Installing</a></li>
          
          
          
          
          
          
          <li><a href="using-with-f95.html">Using with Fortran 95</a></li>
          
          
          
          
          
          
          <li><a href="using-with-python.html">Using with Python</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Spherical harmonics</a>
      <ul>
          
          
          
          <li><a href="real-spherical-harmonics.html">Real spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="complex-spherical-harmonics.html">Complex spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="implementation-details.html">Implementation details</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Fortran 95 Routines</a>
      <ul>
          
          
          
          <li><a href="f95-modules.html">Modules</a></li>
          
          
          
          
          
          
          <li><a href="legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="global-spectral-analysis.html">Global spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="localized-spectral-analysis.html">Localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="miscellaneous-routines.html">Miscellaneous</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Python components</a>
      <ul>
          
          
          
          <li><a href="python-classes.html">Python classes</a></li>
          
          
          
          
          
          
          <li><a href="python-legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="python-io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="python-spectral-analysis.html">Global and localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="python-gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="python-utilities.html">Utilities</a></li>
          
          
          
          
          
          
          <li><a href="python-constants.html">Constants</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Examples programs</a>
      <ul>
          
          
          
          <li><a href="python-examples.html">Python examples</a></li>
          
          
          
          
          
          
          <li><a href="fortran-examples.html">Fortran 95 examples</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Support</a>
      <ul>
          
          
          
          <li><a href="faq.html">FAQ</a></li>
          
          
          
          
          
          
          <li><a href="fortran-95-problems.html">Fortran 95 problems</a></li>
          
          
          
          
          
          
          <li><a href="how-to-contribute.html">How to contribute</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Release Notes</a>
      <ul>
          
          
          
          <li><a href="release-notes-v4.html">Version 4</a></li>
          
          
          
          
          
          
          <li><a href="release-notes-v3.html">Version 3</a></li>
          
          
          
          
          
          
          <li><a href="license.html">License</a></li>
          
          
          
          
          
          
          <li><a href="contributors.html">Contributors</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "2em"
});
</script>

<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<div class="post-header">
   <h1 class="post-title-main">SHLocalizedAdmitCorr (Python)</h1>
</div>



<div class="post-content">

   

    


    


    

  <p>Calculate the localized admittance and correlation spectra of two functions at a given location using spherical cap localization windows.</p>

<h2 id="usage">Usage</h2>

<p><code class="highlighter-rouge">admit</code>, <code class="highlighter-rouge">corr</code>, <code class="highlighter-rouge">admit_error</code>, <code class="highlighter-rouge">corr_error</code> = SHLocalizedAdmitCorr (<code class="highlighter-rouge">gilm</code>, <code class="highlighter-rouge">tilm</code>, <code class="highlighter-rouge">tapers</code>, <code class="highlighter-rouge">taper_order</code>, <code class="highlighter-rouge">lat</code>, <code class="highlighter-rouge">lon</code>, [<code class="highlighter-rouge">k</code>, <code class="highlighter-rouge">lwin</code>, <code class="highlighter-rouge">lmax</code>, <code class="highlighter-rouge">taper_wt</code>, <code class="highlighter-rouge">mtdef</code>, <code class="highlighter-rouge">k1linsig</code>])</p>

<h2 id="returns">Returns</h2>

<dl>
  <dt><code class="highlighter-rouge">admit</code> : float, dimension (<code class="highlighter-rouge">lmax</code>-<code class="highlighter-rouge">lwin</code>+1)</dt>
  <dd>The admittance function, which is equal to <code class="highlighter-rouge">Sgt/Stt</code>.</dd>
  <dt><code class="highlighter-rouge">corr</code> : float, dimension (<code class="highlighter-rouge">lmax</code>-<code class="highlighter-rouge">lwin</code>+1)</dt>
  <dd>The degree correlation function, which is equal to <code class="highlighter-rouge">Sgt/sqrt(Sgg Stt)</code>.</dd>
  <dt><code class="highlighter-rouge">admit_error</code> : float, dimension (<code class="highlighter-rouge">lmax</code>-<code class="highlighter-rouge">lwin</code>+1)</dt>
  <dd>The standard error of the admittance function.</dd>
  <dt><code class="highlighter-rouge">corr_error</code> : float, dimension (<code class="highlighter-rouge">lmax</code>-<code class="highlighter-rouge">lwin</code>+1)</dt>
  <dd>The standard error of the degree correlation function.</dd>
</dl>

<h2 id="parameters">Parameters</h2>

<dl>
  <dt><code class="highlighter-rouge">gilm</code> : float, dimension (2, <code class="highlighter-rouge">lmaxgin</code>+1, <code class="highlighter-rouge">lmaxgin</code>+1)</dt>
  <dd>The spherical harmonic coefficients of the function G.</dd>
  <dt><code class="highlighter-rouge">tilm</code> : float, dimension (2, <code class="highlighter-rouge">lmaxtin</code>+1, <code class="highlighter-rouge">lmaxtin</code>+1)</dt>
  <dd>The spherical harmonic coefficients of the function T.</dd>
  <dt><code class="highlighter-rouge">tapers</code> : float, dimension (<code class="highlighter-rouge">lwinin</code>+1, <code class="highlighter-rouge">kin</code>)</dt>
  <dd>A matrix of spherical cap localization functions obtained from <code class="highlighter-rouge">SHReturnTapers</code> or <code class="highlighter-rouge">SHReturnTapersM</code>.</dd>
  <dt><code class="highlighter-rouge">taper_order</code> : integer, dimension (<code class="highlighter-rouge">kin</code>)</dt>
  <dd>The angular order of the windowing coefficients in <code class="highlighter-rouge">tapers</code>.</dd>
  <dt><code class="highlighter-rouge">lat</code> : float</dt>
  <dd>The latitude of the localized analysis in degrees.</dd>
  <dt><code class="highlighter-rouge">lon</code> : float</dt>
  <dd>The longitude of the localized analysis in degrees.</dd>
  <dt><code class="highlighter-rouge">k</code> : optional, integer, default = <code class="highlighter-rouge">kin</code></dt>
  <dd>The number of tapers to be used in the multitaper spectral analysis.</dd>
  <dt><code class="highlighter-rouge">lwin</code> : optional, integer, default = <code class="highlighter-rouge">lwinin</code></dt>
  <dd>The spherical harmonic bandwidth of the localizing windows.</dd>
  <dt><code class="highlighter-rouge">lmax</code> : optional, integer, default = min(<code class="highlighter-rouge">lmaxgin</code>, <code class="highlighter-rouge">lmaxtin</code>)</dt>
  <dd>The maximum spherical harmonic degree of the input functions corresponding to <code class="highlighter-rouge">gilm</code> and <code class="highlighter-rouge">tilm</code>.</dd>
  <dt><code class="highlighter-rouge">taper_wt</code> : optional, float, dimension (<code class="highlighter-rouge">k</code>), default = -1 (not used)</dt>
  <dd>The weights to be applied to the spectral estimates when calculating the admittance, correlation, and their associated errors. This must sum to unity. The default value specifies that taper weights will not be used.</dd>
  <dt><code class="highlighter-rouge">mtdef</code> : optional, integer, default = 1</dt>
  <dd>1 (default): Calculate the multitaper spectral estimates Sgt, Sgg and Stt first, and then use these to calculate the admittance and correlation functions. 2: Calculate admittance and correlation spectra using each individual taper, and then average these to obtain the multitaper admittance and correlation functions.</dd>
  <dt><code class="highlighter-rouge">k1linsig</code> : optional, integer, default = -1</dt>
  <dd>If equal to one, and only a single taper is being used, the errors in the admittance function will be calculated by assuming that the coefficients of <code class="highlighter-rouge">gilm</code> and <code class="highlighter-rouge">tilm</code> are related by a linear degree-dependent transfer function and that the lack of correlation is a result of uncorrelated noise. This is the square root of eq. 33 of Simons et al. 1997. The default value specifies that this is not set.</dd>
</dl>

<h2 id="description">Description</h2>

<p><code class="highlighter-rouge">SHLocalizedAdmitCorr</code> will calculate the localized admittance and degree correlation spectra of two functions at a given location. The windowing functions are solutions to the spherical-cap concentration problem (as calculated by <code class="highlighter-rouge">SHReturnTapers</code> or <code class="highlighter-rouge">SHReturnTapersM</code>), of which the best <code class="highlighter-rouge">k</code> concentrated tapers are utilized. If <code class="highlighter-rouge">k</code> is greater than 1, then estimates of the standard error for the admittance and correlation will be returned in the optional arrays <code class="highlighter-rouge">admit_error</code> and <code class="highlighter-rouge">corr_error</code>. The symmetry axis of the localizing windows are rotated to the coordinates (<code class="highlighter-rouge">lat</code>, <code class="highlighter-rouge">lon</code>) before performing the windowing operation.</p>

<p>The admittance is defined as <code class="highlighter-rouge">Sgt/Stt</code>, where <code class="highlighter-rouge">Sgt</code> is the localized cross-power spectrum of two functions <code class="highlighter-rouge">G</code> and <code class="highlighter-rouge">T</code> expressed in spherical harmonics. The localized degree-correlation spectrum is defined as <code class="highlighter-rouge">Sgt/sqrt(Sgg Stt)</code>, which can possess values between -1 and 1. Two methods are available for calculating the multitaper admittance and correlation functions. When <code class="highlighter-rouge">mtdef</code> is 1 (default), the multitaper estimates and errors of Sgt, Stt, and Sgg are calculated by calls to <code class="highlighter-rouge">SHMultiTaperSE</code> and <code class="highlighter-rouge">SHMultiTaperCSE</code>, and these results are then used to calculate the final admittance and correlation functions. When <code class="highlighter-rouge">mtdef</code> is 2, the admitance and correlation are calculated invidivually for each individual taper, and these results are then averaged.</p>

<p>If the optional parameter <code class="highlighter-rouge">k1linsig</code> is specified, and only a single taper is being used, the uncertainty in the admittance function will be calculated by assuming the two sets of coefficients are related by a linear degree-dependent transfer function and that the lack of correlation is a result of uncorrelated noise.</p>

<p>When <code class="highlighter-rouge">mtdef</code> is 1, by default, the multitaper spectral estimates are calculated as an unweighted average of the individual tapered estimates. However, if the optional argument <code class="highlighter-rouge">taper_wt</code> is specified, a weighted average will be employed using the weights in this array. Minimum variance optimal weights can be obtained from the routines <code class="highlighter-rouge">SHMTVarOpt</code> if the form of the underlying global power spectrum is known. Taper weights can not be used when <code class="highlighter-rouge">mtdef</code> is 2</p>

<p>This routine assumes that the input functions and tapers are expressed using geodesy 4-pi normalized spherical harmonic functions that exclude the  Condon-Shortley phase factor of (-1)^m.</p>

<h2 id="references">References</h2>

<p>Wieczorek, M. A. and F. J. Simons, Minimum-variance multitaper spectral estimation on the sphere, J. Fourier Anal. Appl., 13, doi:10.1007/s00041-006-6904-1, 665-692, 2007.</p>

<p>Simons, F. J., F. A. Dahlen and M. A. Wieczorek, Spatiospectral concentration on the sphere, SIAM Review, 48, 504-536, doi:10.1137/S0036144504445765, 2006.</p>

<p>Wieczorek, M. A. and F. J. Simons, Localized spectral analysis on the sphere, 
Geophys. J. Int., 162, 655-675, 2005.</p>

<p>Simons, M., S. C. Solomon and B. H. Hager, Localization of gravity and topography: constrains on the tectonics and mantle dynamics of Venus, Geophys. J. Int., 131, 24-44, 1997.</p>

<h2 id="see-also">See also</h2>

<p><a href="pyshreturntapers.html">shreturntapers</a>, <a href="pyshreturntapersm.html">shreturntapersm</a>, <a href="pyshmultitaperse.html">shmultitaperse</a>, <a href="pyshmultitapercse.html">shmultitapercse</a></p>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_python.html" class="btn btn-default navbar-btn cursorNorm" role="button">python</a>
        
        
        
    </div>




</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 SHTOOLS. All rights reserved. <br />
<a href="https://www.oca.eu/?lang=en" target="_blank" rel="noopener">Observatoire de la CÃ´te d'Azur</a><br />
<a href="https://lagrange.oca.eu/fr/accueil-lagrange" target="_blank" rel="noopener">Laboratoire Lagrange</a><br />
<p><img src="images/company_logo.png" alt="SHTOOLS"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
