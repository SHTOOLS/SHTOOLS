<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
	<title>SHTOOLS - Gravity and magnetics routines</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="stylesheet" type="text/css" href="../../css/sh.css">
	<link rel="icon" type="image/vnd.microsoft.icon" href="../../images/favicon.ico">
</head>

<body>

<div class="main">

	<p class="centeredimage"><img src="../../images/logo.jpg" width=894 height=135 alt="SHTOOLS --- Tools for working with spherical harmonics"></p>
    	
	<table class="menu">
		<tbody>
			<tr>
				<td><a href="http://shtools.ipgp.fr/">HOME</a></td>
				<td><a href="https://github.com/SHTOOLS/SHTOOLS/releases">DOWNLOAD</a></td>
				<td class="selected"><a href="../../documentation.html">DOCUMENTATION</a></td>
				<td><a href="../../faq.html">FAQ</a> </td>
			</tr>
		</tbody>
	</table>

	<p class="dir">
>  <a href="../../../index.html" class="dir">Home</a> > <a href="../../documentation.html" class="dir">Documentation</a> > <a href="../../f95-routines.html" class="dir">Fortran 95</a> > <a href="../../gravmag.html" class="dir">Gravity and Magnetics</a></p>
<PRE>
<!-- Manpage converted by man2html 3.0.1 -->
<B>MAKEMAGGRIDDH(1)</B>                  SHTOOLS 3.0                 <B>MAKEMAGGRIDDH(1)</B>


</PRE>
<H2 class="man">MakeMagGridDH</H2 class="man"><PRE>
       MakeMagGridDH -  Create 2D cylindrical maps on a flattened ellipsoid of
                        all three vector components of the magnetic field, the
                        magnitude of the magnetic field, and the magnetic
                        potential.


</PRE>
<H2 class="man">SYNOPSIS</H2 class="man"><PRE>
       SUBROUTINE MakeMagGridDH ( CILM, LMAX, R0, A, F, RAD, THETA, PHI,
                                  TOTAL, N, SAMPLING, LMAX_CALC, POT_GRID)

           REAL*8             CILM(2, LMAX+1, LMAX+1), R0, A, F, RAD(2*LMAX+2,
                              2*LMAX+2), THETA(2*LMAX+2, 2*LMAX+2),
                              PHI(2*LMAX+2, 2*LMAX+2), TOTAL(2*LMAX+2,
                              2*LMAX+2)

           INTEGER            LMAX, N

           REAL*8, OPTIONAL   POT_GRID(2*LMAX+2,2*LMAX+2)

           INTEGER, OPTIONAL  SAMPLING, LMAX_CALC


</PRE>
<H2 class="man">DESCRIPTION</H2 class="man"><PRE>
       <B>MakeMagGridDH</B> will create 2-dimensional cylindrical maps from the
       spherical harmonic coefficients CILM, of all three components of the
       magnetic field, the total field strength, and the magnetic potential.
       The magnetic potential is given by

       V = R0 Sum_{l=1}^LMAX (R0/r)^{l+1} Sum_{m=-l}^l C_{lm} Y_{lm}

       and the magnetic field is

       B = - Grad V.

       The coefficients are referenced to a radius R0, and the function is
       computed on a flattened ellipsoid with semi-major axis A (i.e., the
       mean equatorial radius) and flattening F.

       The default is to calculate grids for use in the Driscoll and Healy
       routines that are equally sampled (N by N), but this can be changed to
       calculate equally spaced grids (N by 2N) by setting the optional
       argument SAMPLING to 2. The input value of LMAX determines the number
       of samples, N=2*LMAX+2, and the latitudinal sampling interval,
       90/(LMAX+1). The first latitudinal band of the grid corresponds to 90
       N, the latitudinal band for 90 S is not calculated, and the latitudinal
       sampling interval is 180/N degrees. The first longitudinal band is 0 E,
       the longitudinal band for 360 E is not calculated, and the longitudinal
       sampling interval is 360/N for equally sampled and 180/N for equally
       spaced grids, respectively.


</PRE>
<H2 class="man">ARGUMENTS</H2 class="man"><PRE>
       CILM       (input) REAL*8, DIMENSION (2, LMAX+1, LMAX+1)

                  The real Schmidt semi-normalized spherical harmonic
                  coefficients to be expanded in the space domain. The
                  coefficients C1lm and C2lm refer to the "cosine" (Clm) and
                  "sine" (Slm) coefficients, respectively, with Clm = CILM(1,
                  l+1, m+1) and Slm = CILM(2, l+1, m+1). Alternatively, C1lm
                  and C2lm correspond to the positive and negative order
                  coefficients, respectively.

       LMAX       (input) INTEGER

                  The maximum spherical harmonic degree of the coefficients
                  CILM. This determines the number of samples of the output
                  grids, N=2*LMAX+2, and the latitudinal sampling interval,
                  90/(LMAX+1).

       R0         (input) REAL*8

                  The reference radius of the spherical harmonic coefficients.

       A          (input) REAL*8

                  The semi-major axis of the flattened ellipsoid on which the
                  field is computed.

       F          (input) REAL*8

                  The flattening of the reference ellipsoid: i.e., F =
                  (R_equator - R_pole) / R_equator = (A - B) / A.

       RAD        (output) REAL*8, DIMENSION(2*LMAX+2, 2*LMAX+2) <B>or</B> (output)
                  REAL*8, DIMENSION(2*LMAX+2, 4*LMAX+4)

                  A 2D equally sampled (N by N) or equally spaced (N by 2N)
                  grid of the radial component of the magnetic field
                  corresponding to the input spherical harmonic coefficients
                  CILM. The first latitudinal band corresponds to 90 N, the
                  latitudinal band for 90 S is not included, and the
                  latitudinal sampling interval is 180/N degrees. The first
                  longitudinal band is 0 E, the longitudinal band for 360 E is
                  not included, and the longitudinal sampling interval is
                  360/N for an equally sampled and 180/N for an equally spaced
                  grid, respectively.

       THETA      (output) REAL*8, DIMENSION(2*LMAX+2, 2*LMAX+2) <B>or</B> (output)
                  REAL*8, DIMENSION(2*LMAX+2, 4*LMAX+4)

                  A 2D equally sampled or equally spaced grid of the theta
                  component of the magnetic field.

       PHI        (output) REAL*8, DIMENSION(2*LMAX+2, 2*LMAX+2) <B>or</B> (output)
                  REAL*8, DIMENSION(2*LMAX+2, 4*LMAX+4)

                  A 2D equally sampled or equally spaced grid of the phi
                  component of the magnetic field.

       TOTAL      (output) REAL*8, DIMENSION(180/INTERVAL+1, 360/INTERVAL+1)

                  A 2D equally sampled or equally spaced grid of the total
                  magnetic field strength.

       N          (output) INTEGER

                  The number of samples in latitude of the output grids. This
                  is equal to 2*LMAX + 2, which will always be even.

       SAMPLING   (input) INTEGER, OPTIONAL

                  If 1 (default) the output grids are equally sampled (N by
                  N). If 2, the grids are equally spaced (N by 2*N).

       LMAX_CALC  (input) INTEGER, OPTIONAL

                  The maximum spherical harmonic degree used in evaluating the
                  functions. This must be less than or equal to LMAX.

       POT_GRID   (output) REAL*8, DIMENSION(2*LMAX+2, 2*LMAX+2), OPTIONAL <B>or</B>
                  (output) REAL*8, DIMENSION(2*LMAX+2, 4*LMAX+4), OPTIONAL

                  A 2D equally sampled or equaly spaced grid of the magnetic
                  potential.


</PRE>
<H2 class="man">SEE ALSO</H2 class="man"><PRE>
       &lt;http://shtools.ipgp.fr/&gt;


</PRE>
<H2 class="man">COPYRIGHT AND LICENSE</H2 class="man"><PRE>
       Copyright 2012 by Mark Wieczorek &lt;wieczor@ipgp.fr&gt;.

       This is free software; you can distribute and modify it under the terms
       of the revised BSD license.

SHTOOLS 3.0                       2015-03-10                  <B>MAKEMAGGRIDDH(1)</B>
</PRE>

	<p class="dir">
>  <a href="../../../index.html" class="dir">Home</a> > <a href="../../documentation.html" class="dir">Documentation</a> > <a href="../../f95-routines.html" class="dir">Fortran 95</a> > <a href="../../gravmag.html" class="dir">Gravity and Magnetics</a></p>

	<table class="footer2" summary = "SHTOOLS; Fortran and Python spherical harmonic transform software package">
	<tbody>
		<tr>
			<td class="c1"><a href="http://www.ipgp.fr/">Institut de Physique du Globe de Paris</a></td>
			<td class="c2"><a href="http://www.sorbonne-paris-cite.fr/index.php/en">University of Sorbonne Paris Cit√©</a></td>
			<td class="c3">&copy; 2015 <a href="http://www.ipgp.fr/~wieczor">Mark Wieczorek</a></td>
		</tr>
	</tbody>
	</table>
	
</div>

</body>
</html>
