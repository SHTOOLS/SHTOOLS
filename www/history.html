<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
	<title>SHTOOLS - Version history</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<link rel="stylesheet" type="text/css" href="css/sh.css">
	<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="images/favicon.ico">
	<link rel="icon" type="image/vnd.microsoft.icon" href="images/favicon.ico">
	<meta name="description" content="SHTOOLS version history.">
</head>

<body>

<div class="main">

	<p class="centeredimage"><img src="images/logo.jpg" width=894 height=135 alt="SHTOOLS --- Tools for working with spherical harmonics"></p>

	<table class="menu">
		<tbody>
		<tr>
		<td><a href="../index.html">HOME</a></td>
		<td><a href="https://github.com/SHTOOLS/SHTOOLS/releases">DOWNLOAD</a></td>
		<td class="selected"><a href="documentation.html">DOCUMENTATION</a></td>
		<td><a href="faq.html">FAQ</a> </td>
		</tr>
		</tbody>
	</table>

	<p class="dir">
	>  <a href="../index.html" class="dir">Home</a> > <a href="documentation.html" class="dir">Documentation</a></p>

	<h1>Version History</h1>

	<h2>Version 4.0 (December 16, 2016)</h2>
	<ul>
		<li>Instead of executing a Fortran STOP, which kills the Python kernel, the Fortran subroutines now return an <tt>exitstatus</tt> that allows Python to raise an exception. This technique does not work with the few Fortran functions that pyshtools calls, but these functions are relatively benign, and will soon be phased out for Python native functions.</li>
		<li>The Fortran powerspectrum routines have been removed from pyshtools, and have been replaced with Python native routines <tt>spectrum</tt> and <tt>cross_spectrum</tt>. The Python routines allow to specify the normalization, whether the output should be power, energy or l2norm, and whether the spectrum is per degree, per coefficient, or per log bandwidth.</li>
		<li>The method <tt>plot_spectrum2d()</tt> was added to the class <tt>SHCoeffs</tt> to plot the power as a function of degree and order.</li>
		<li>All pyshtools modules have been converted into proper Python subpackages. The subpackage <tt>localizedpsectralanalysis</tt> has been merged into <tt>spectralanalysis</tt>, and the subpackage <tt>other</tt> has been renamed <tt>utils</tt>.</li>
		<li>The Python class method <tt>SHCoeffs.expand()</tt> now can evaluate the function either on an <tt>SHGrid</tt> or for a list of latitude and longitude points. As part of this change, a new fortran function <tt>MakeGridPointC</tt> was created for complex coefficients.</li>
		<li>The majority of the methods for the classes <tt>SHCoeffs</tt>, <tt>SHGrid</tt> and <tt>SHWindow</tt> have been rename for consistency (see documentation!). Also, the classes now give the option of reading or saving to files as numpy arrays.</li>
		<li>Added new Python function <tt>read_icgen_gfc</tt> for reading ICGEM-format gravity coefficient files.</li>
		<li>The operator <tt>pow</tt> was added to the class <tt>SHCoeffs</tt>.</li>
		<li>All methods in the pyshtools classes now return copies by default, which can be modified by the optional argument <tt>copy</tt>.</li>
		<li>Added <tt>pot</tt> as a mandatory return argument for the Python routine <tt>MakeGravGridDH</tt>.</li>
		<li>Several minor modifications and bug fixes were made to the makefiles to improve compatibility and to allow the use of <tt>make -j</tt>.</li>
		<li>The routines <tt>other.EigValSym</tt>, <tt>other.EigValVecSym</tt>, <tt>other.EigValVecSymTri</tt>, <tt>other.RandomGaussian</tt>, <tt>other.RandomN</tt> and <tt>other.PreGLQ</tt> were removed from pyshtools, as these can be found in other scipy packages.</li>
		<li>The SHTOOLS routine <tt>DHaj</tt> was added to the pyshtools subpackage <tt>utils</tt>.</li>
		<li>Python docstrings have been streamlined and standardized.</li>
		<li>...plus, many minor changes and optimizations...</li>
	</ul>

	<h2>Version 3.4 (August 30, 2016)</h2>
	<ul>
		<li>Add pyshtools to PyPI repository. Can now be installed using <tt>pip install pyshtools</tt>.</li>
		<li>Add new function <tt>SHBiasKMask</tt> which is the arbitrary window counterpart to the spherical cap window <tt>SHBiasK</tt>.</li>
		<li>Add <tt>get_biasedpowerspectrum()</tt> method to <tt>SHWindows</tt> for arbitrary windows.</li>
		<li>Add <tt>copy()</tt> method to all classes, which returns a deep copy of the instance.</li>
		<li>Add <tt>__sub__</tt>, <tt>__add__</tt>, <tt>__rsub__</tt>, <tt>__radd__</tt>, <tt>__mul__</tt>, <tt>__div__</tt>, <tt>__truediv__</tt>, and <tt>__pow__</tt> operators for two sets of coefficient or grid classes, or one coefficient or grid class and a scalar.</li>
		<li>Add <tt>nwinrot</tt> option when rotating spherical cap windows in <tt>SHWindow</tt> that will rotate only the first <tt>nwinrot</tt> windows.</li>
		<li>Add degrees option to <tt>get_lats()</tt> and <tt>get_lons()</tt> methods.</li>
		<li>Add the constructor <tt>from_file()</tt> to initialize an <tt>SHGrid</tt> with a numpy formatted data file. Add option to read coeffs and grids from a numpy formatted binary file. Add <tt>tofile()</tt> methods to output raw grid and coefficient data as either text or binary formatted files.</li>
		<li>Update Intro 1 notebook and add example to Intro notebook 2 showing how to use arbitrary localization windows.</li>
		<li>Convert notebooks to html and add links to web documentation.</li>
		<li>Add option <tt>fixed_power</tt> to <tt>SHCoeffs.from_random()</tt> method to generate random coefficients that fit exactly the expected power spectrum.</li>
		<li>Add Earth topography coefficients referenced to mean sea level to the example files, expanded to degree 300: srtmp300.msl.</li>
	</ul>

	<h2>Version 3.3 (August 11, 2016)</h2>
	<ul>
		<li>Added full support for Python 3.</li>
		<li>Fixed a critical, but rare, bug in <tt>MakeGridDH</tt>, <tt>MakeGravGridDH</tt>, <tt>MakeMagGridDH</tt>, and <tt>MakeGravGradGridDH</tt>. In these routines, the rows of the output grid are calculated by inverse Fourier transmforming a vector that depends upon the spherical harmonic coefficients. This vector, when using the complex-to-real FFTW routines, includes one element that corresponds to the coefficients with m=lmax+1. This element of the array was not properly initialized to zero in the Fortran code, and if the Fortran compiler did not explicitly zero all new arrays, this could have resulted in incorrect output. Given that this term is 1 index above the Nyquist frequency (m=lmax), if this element were not zero, each column of the grid would contain a component that oscillates from -1 to +1 (sclaed by the magnitude of the element). Even when this element was not initialized, a subsequent spherical harmonic expansion of the grid would usually give correct results.</li>
		<li>Added a <tt>setup.py</tt> file for easy installation.</li>
		<li>Makefiles were extensively modified to simplify the fortran and python builds: <tt>make all2</tt> and <tt>make all3</tt> were removed and replaced by flags that make use of the precompiler to resolve underscore problems; <tt>make install</tt> now places compiled module files in <tt>/usr/local/includes</tt>.</li>
		<li>Makefiles were improved to minimize problems when installing both <tt>fortran</tt> and <tt>fortran-mp</tt> components. When making the latter, all object and module files in the directory <tt>src</tt> are first deleted.</li>
		<li>The namespace of <tt>pyshtools</tt> was reorganized to list the routines by submodule name. A list of all routines is given in the submodule <tt>shtools</tt>.</li>
		<li>Add full support for the python classes <tt>SHCoeffs</tt>, <tt>SHGrid</tt>, and <tt>SHWindow</tt>.</li>
		<li>Added an <tt>info()</tt> method to shtools constants that prints an info string.</li>
		<li>Change python wrapper so that the output arrays in the <tt>SHExpand</tt> routines correspond to the optional input variable <tt>lmax_calc</tt>.</li>
		<li>Changed the primary input parameter of <tt>SHMTCouplingMatrix</tt> to be a matrix of power spectra of the localization windows instead of a matrix of spherical-harmonic coefficients of spherical-cap localization windows. Furthermore, the output dimensions of the matrix have been switched.</li>
		<li>Added two fortran routines for performing multitaper spectral analyses when using windows generaged from a mask, <tt>SHMultiTaperMaskSE</tt> and <tt>SHMultiTaperCSE</tt>.</li>
		<li>Minor modifications to the python example scripts.</li>
		<li>Minor bug fix to the scripts that create the unix <tt>man</tt> documentation.</li>
		<li>Add Python notebook tutorials.</li>
		<li>Created an SHTOOLS development fund, funded by bitcoin donations.</li>
	</ul>

	<h2>Version 3.2 (June 20, 2016)</h2>
	<ul>
		<li>Added the optional argument <tt>centralmeridian</tt> to <tt>Curve2Mask</tt> that accounts for cases where the curve makes a complete circle in longitude about the planet.</li>
		<li>Fixed in bug in the python implementation where the outputs <tt>error</tt> and <tt>corr</tt> of <tt>SHAdmitCorr</tt> were switched.</li>
		<li>Added OpenMP support. When compiling with <tt>make fortran-mp</tt>, <tt>make fortran2-mp</tt>, or <tt>make fortran3-mp</tt>, saved variables in the subroutines are defined as being <tt>threadprivate</tt>.</li>
		<li>Optimized performance of the routines <tt>SHMultiTaperSE</tt>, <tt>SHMultiTaperCSE</tt>, and <tt>SHLocalizedAdmitCorr</tt>.</li>
		<li>Minor documentation fixes.</li>
	</ul>

	<h2>Version 3.1 (July 21, 2015)</h2>
	<ul>
			<li>Added OSX installation support via <tt>brew</tt>.</li>
			<li>Added <tt>make install</tt> that copies files to <tt>/usr/local</tt></li>
			<li>Reformatted all Fortran documentation files and rewrote the Python documentation and man pages.</li>
			<li>Added the routines <tt>CilmMinus</tt> and <tt>CilmMinusRhoH</tt>, which are the counterparts to <tt>CilmPlus</tt> and <tt>CilmPlusRhoH</tt>.</li>
			<li>Removed the following routines from the fortran documentation and Python wrappers: <tt>DhAj</tt>, <tt>NGLQ</tt>, <tt>NGLQSH</tt>, <tt>NGLQSHN</tt>.</li>
			<li>Removed the following redundant routines from SHTOOLS: <tt>ComputeD0</tt>, <tt>SHMTVarOpt0</tt>, <tt>SHSjkPG0</tt>.</li>
			<li>Renamed the routine <tt>PreCompute</tt> to <tt>SHGLQ</tt>.</li>
			<li>Renamed the routine <tt>YilmIndex</tt> to <tt>YilmIndexVector</tt>.</li>
			<li>Renamed the routine <tt>Hilm</tt> to <tt>BAtoHilm</tt>, and <tt>HilmRhoH</tt> to <tt>BAtoHilmRhoH</tt>.</li>
			<li>Renamed the routine <tt>Wl</tt> to <tt>DownContFilterMA</tt>, and <tt>WlCurv</tt> to <tt>DownContFilterMC</tt>.</li>
			<li>Added minimal support for three python classes: <tt>SHGrid</tt>, <tt>SHCoeffs</tt>, and <tt>SHWindow</tt>.</li>
			<li>Added the routine <tt>SHMTCouplingMatrix</tt>.</li>

		</ul>

	<h2>Version 3.0 (March 10, 2015)</h2>
	<ul>
			<li>Added full python compatibility. This includes python wrappers for all SHTOOLS functions, python documentation for all functions, and a simple test suite to ensure that the SHTOOLS functions are working correctly.</li>
			<li>Moved the project from Sourceforge to <a href="https://github.com/SHTOOLS/SHTOOLS">GitHub</a>. The Sourceforge project will no longer be maintained.</li>
			<li>Fixed bugs in <tt>SHrtoc</tt> and <tt>SHctor</tt> when the optional parameter CONVENTION was set to its default values, causing zeros to be returned.</li>
			<li>Modified <tt>ComputeDMap</tt> and <tt>SJHReturnTapersMap</tt> such that the parameter <tt>SAMPLING</tt> is optional.</li>
			<li>Fixed a bug in <tt>Curve2Mask</tt> that could give rise to vertical lines when the longitudes of the profile points were decreasing.</li>
			<li>Removed the routines <tt>Import_Wisdom_From_File</tt> and <tt>Export_Wisdom_From_File</tt>.</li>
		</ul>

	<h2>Version 2.9 (August 11, 2014)</h2>
		<ul>
			<li>Modified <tt>CilmPlus</tt> and <tt>CilmRhoH</tt> so that they are accurate for powers beyond 13.</li>
			<li>Fixed a bug in <tt>MakeGeoidGrid</tt> that could give rise to runtime errors when the maximum dimension of <tt>CILM</tt> was less than <tt>LMAX</tt>.</li>
			<li>Transferred the discussion forum and download page to the <a href="https://sourceforge.net/projects/shtools">Sourceforge project page</a>.</li>
			<li>Minor fixes to documentation and web pages.</li>
		</ul>

	<h2>Version 2.8 (November 20, 2012)</h2>
		<ul>
			<li>Following the suggestions of Leonid Petrov, the routines <tt>ShExpandDH</tt>, <tt>ShExpandDHC</tt>, <tt>ShExpandGLQ</tt>, <tt>ShExpandGLQC</tt>, <tt>MakeGridDH</tt>, <tt>MakeGridDHC</tt>, <tt>MakeGridGLQ</tt>, and <tt>MakeGridGLQC</tt> were optimized, giving rise to performance gains of about two.</li>
			<li>Following the suggestions of Leonid Petrov, the routine <tt>MakeGridPoint</tt> was optimized, giving rise to large performance gains.</li>
			<li>Replaced the routine <tt>MakeGravGrid2D</tt> with <tt>MakeGravGridDH</tt>. This routine is orders of magnitude faster than its predecessor, and can calculate all three components of the gravity field and gravity disturbance of the 2190-degree EGM2008 field in under 300 seconds.</li>
			<li> Added the routine <tt>MakeGravGradGridDH</tt> which calculates the components of the gravity "gradient" tensor on a flattened ellipsoid. This routine can calculate the degree-2190 EGM2008 gravity tensor in under 720 seconds.</li>
			<li>Replaced the routine <tt>MakeMagGrid2D</tt> with <tt>MakeMagGridDH</tt>, which is orders of magnitude faster than its predecessor.</li>
			<li>Added the routine <tt>NormalGravity</tt> to calculate the normal gravity on an ellipsoid.</li>
			<li>Modified <tt>SHLocalizedAdmitCorr</tt> to increase performance.</li>
			<li>Modified <tt>MakeCircleCoord</tt> such that the output coordinates are organized in a clockwise manner with the first index corresponding to due north.</li>
			<li>Introduced a different scaling procedure in <tt>CilmPlus</tt> and <tt>CilmRho</tt> that should be more accurate at high powers.</li>
		</ul>

	<h2>Version 2.7 (July 4, 2012)</h2>
		<ul>
			<li>Improved memory management of <tt>CilmPlus</tt> and <tt>Hilm</tt>, avoiding potential runtime crashes at high degrees.</li>
			<li>Added routines <tt>CilmPlusRhoH</tt> and <tt>HilmRhoH</tt> (modified from <tt>CilmPlus</tt> and <tt>Hilm</tt>), which take into account lateral variations in density.</li>
			<li>Improved makefiles, including options to make and run example programs.</li>
			<li>Updated many of the example programs.</li>
		</ul>

	<h2>Version 2.6 (November 21, 2011)</h2>
		<ul>
			<li>Fixed a bug in <tt>ShExpandDH</tt>, <tt>ShExpandDHC</tt>, <tt>ShExpandGLQ</tt>, <tt>ShExpandGLQC</tt>, <tt>MakeGridDH</tt>, <tt>MakeGridDHC</tt>, <tt>MakeGridGLQ</tt>, <tt>MakeGridGLQC</tt> that could have given inaccurate results if called more than twice in a program with the same <tt>N</tt> but different values of <tt>NORM</tt>.</li>
			<li>Fixed a bug in <tt>ShExpandDHC</tt> and <tt>SHExpandGLQC</tt> that could have given rise to a runtime crash or errors in the degree-0 coefficients when called with <tt>LMAX_CALC = 0</tt>.</li>
			<li>Removed routine <tt>SHReadGRACE</tt> and renamed <tt>SHReadCHAMP</tt> to <tt>SHRead2</tt>. <tt>SHRead2</tt> now reads in time derivatives of terms, their epochs, and the starting and ending date of the gravity solution.</li>
			<li>Added the routine <tt>MakeEllipseCoord</tt> for calculating the (lat, long) coordinates of an ellipse placed on a sphere.</li>
			<li>Fixed a major bug in <tt>SHBiasK</tt> that would give wrong answers when <tt>SAVE_CG</tt> was set equal to 1.</li>
			<li>Fixed a minor bug in <tt>SHExpandGLQ</tt> and <tt>SHExpandGLQC</tt> that could have caused a runtime crash.</li>
			<li>Modified <tt>Hilm</tt> to accept Driscoll and Healy sampled grids, and added the optional parameter <tt>LMAX_CALC</tt> for calculating the spherical harmonic transforms up to a smaller value than the bandwidth corresponding to the input grids. </li>
			<li>Fixed a bug in <tt>CilmPlus</tt> that could cause an execution stop for Driscoll and Healy sampled grids when N was not equal to 2*LMAX+2.</li>
			<li>Modified the example code <tt>MarsCrustalThickness</tt> to use Driscoll and Healy sampled grids and to better remove high frequency aliases.</li>
			<li>Improved portability of routines <tt>RandomN</tt> and <tt>RandomGaussian</tt>.</li>
		</ul>

	<h2>Version 2.5 (August 20, 2009)</h2>
		<ul>
			<li>Added the routines <tt>ComputeDMap</tt> and <tt>SHReturnTapersMap</tt> to compute the space-concentration kernel and its eigenvalues and eigenfunctions for an arbitrary concentration region. The routine <tt>Curve2Mask</tt> can be used to compute a mask of the concentration region given a set of coordinates that specifies a single closed curve.</li>
			<li>Added the optional argument <tt>NORMAL_GRAVITY</tt> to <tt>MakeGravGrid2d</tt> in order to remove the normal gravity from the total gravitational acceleration on the ellipsoid.</li>
			<li>Added routines <tt>SHCilmToVector</tt> and <tt>SHVectorToCilm</tt> for converting between 3D arrays of spherical harmonic coefficients, <tt>Cilm</tt>, and a 1D vector of ordered coefficients. The index corresponding to a given I, L and M can be calculated by <tt>YilmIndex</tt>.</li>
			<li>Added optional parameter <tt>K</tt> to <tt>EigValVecSym</tt> in order to only calculate and return the <tt>K</tt> largest eigenvalues and corresponding eigenvectors.</li>
			<li>Fixed a bug in <tt>ShExpandDH</tt> and <tt>SHExpandGLQ</tt> that could have given rise to a crash or errors in the degree-0 coefficients when called with <tt>LMAX_CALC = 0</tt>.</li>
			<li>Added the routine <tt>SHBiasAdmitCorr</tt> that calculates the expected localized admittance and correlation functions given the known cross-power spectra of two functions and the power spectra of the localizing windows.</li>
			<li>Added the optional parameter <tt>SAVE_CG</tt> to the routines <tt>SHBias</tt> and <tt>SHBiasK</tt> that allows the Clebsch-Gordon coefficients to be precomputed and saved for future calls.</li>
			<li>Added the optional parameter <tt>MTDEF</tt> to the routine <tt>SHLocalizedAdmitCorr</tt>, allowing the multitaper admittance and correlation to be computed in one of two ways. In the first, the multitaper cross-power spectra are first calculated, and then from these the admittance and correlation. In the second, the admittance and correlation are calculated for each individual taper, and then these are averaged.</li>
			<li>Added the option to use Driscoll-Healy or Gauss-Legendre quadrature grids with the routine <tt>CilmPlus</tt>. It is now necessary to specify the <tt>GRIDTYPE</tt>, and the argument <tt>W</tt> is now optional.</li>
			<li>Added the option <tt>DREF</tt> to <tt>CilmPlus</tt> in order to set the reference radius to calculate the relief and spherical harmonic coefficients. If this parameter is absent, the mean radius of the input grid will be used.</li>
			<li>Reordered the GRIDTYPES in <tt>MakeGeoidGrid</tt> in order to be consistent with <tt>CilmPlus</tt>.</li>
			<li>Fixed two bugs in <tt>SHrtoc</tt> and <tt>SHctor</tt> that only arose when the default value of 0 was explicitly specified for the optional parameter <tt>switchcs</tt>. </li>
			<li>Modified <tt>Wigner3j</tt>, based on the suggestions of Roelof Rietbroek, so that certain unused variables did not get divided by zero.</li>
			<li>Fixed a memory problem in the example code <tt>MarsCrustalThickness</tt> that might have prevented the file from compiling, or to have crashed at runtime.</li>
			<li>Fixed a memory allocation problem that could have caused a runtime crash in <tt>SphericalCapCoef</tt>.</li>
			<li>Removed routines <tt>SHDeltaX</tt> and <tt>SHDeltaL</tt>.</li>
		</ul>

	<h2>Version 2.4 (May 4, 2008)</h2>
		<ul>
			<li>Added routines <tt>SHExpandDHC</tt>, <tt>MakeGridDHC</tt>, <tt>SHExpandGLQC</tt>, and <tt>MakeGridGLQC</tt> for performing complex spherical harmonic transforms and reconstructions.</li>
			<li>Added the optional parameter <tt>CNORM</tt> to the routines <tt>PlmBar</tt>, <tt>PlmBar_d1</tt>, <tt>PlmON</tt>, <tt>PlmON_d1</tt>, <tt>PlmSchmidt</tt>, <tt>PlmSchmidt_d1</tt> and <tt>PreCompute</tt> in order to use the complex normalization.</li>
			<li>Added complex power spectrum routines <tt>SHPowerLC</tt>, <tt>SHPowerDensityLC</tt>, <tt>SHCrossPowerLC</tt>, <tt>SHCrossPowerDensityLC</tt>, <tt>SHPowerSpectrumC</tt>, <tt>SHPowerSpectrumDensityC</tt>, <tt>SHCrossPowerSpectrumC</tt>, and <tt>SHCrossPowerSpectrumDensityC</tt>. </li>
			<li>Fixed bug in <tt>MakeGrid2d</tt>, <tt>MakeMagGrid2d</tt>, and <tt>MakeGravGrid2d</tt> where the optional input of a west boundary was not properly converted to radians, and where 360 degrees was mistakenly added to EAST when EAST was greater than WEST (instead of the converse).</li>
			<li>Added the option to calculate all three components and magnitude of the gravitational field in <tt>MakeGravGrid2D</tt>. The output is now in SI units (as opposed to mGals before), and the radial gravitational acceleration is now positive when directed upwards (as opposed to downwards before).</li>
			<li>Added routines <tt>SHMagPowerL</tt> and <tt>SHMagPowerSpectrum</tt> for computing the power spectrum of the magnetic field given the spherical harmonic coefficients of the magnetic potential.</li>
			<li>Changed routine names of <tt>SHPowerSpectra</tt> to <tt>SHPowerSpectrum</tt>, <tt>SHPowerSpectraDensity</tt> to <tt>SHPowerSpectrumDensity</tt>, <tt>SHCrossPowerSpectra</tt> to <tt>SHCrossPowerSpectrum</tt>, and <tt>SHCrossPowerSpectrumDensity</tt> to <tt>SHCrossPowerSpectrumDensity</tt>.</li>
			<li>Fixed a bug where the spherical harmonic transforms and reconstructions would crash for LMAX=0.</li>
		</ul>

	<h2>Version 2.3 (October 4, 2007)</h2>

		<ul>
			<li>Switched the naming convention of source files with a "2" appended at their end. If you previously compiled using <tt>Make all</tt>, you must now use <tt>Make all2</tt>, or vice versa.</li>
			<li> <tt>MakeGrid2D</tt> now requires the optional parameter semi-major axis <tt>A</tt> whenever the optional flattening parameter <tt>F</tt> is specified. Furthermore, the reference ellipsoid is now calculated exactly, instead of just using the degree-2 Legendre expansion coefficient as was done before.</li>
			<li> <tt>MakeGravGrid2D</tt> and <tt>MakeMagGrid2D</tt> now calculate fields on the ellipsoid using exact expressions for the ellipsoid, instead of just the degree-2 Legendre expansion coefficient as was done before. <b>The semi-major axis must now be input, instead of the average planetary radius</b>.</li>
			<li> Added optional parameter <tt>LMAX_CALC</tt> to <tt>MakeGridGLQ</tt> and <tt>MakeGridDH</tt> that specifies the maximum spherical harmonic degree to evaluate the function up to. The required parameter LMAX determines the grid spacing of the output grid, as well as the maximum expansion degree if <tt>LMAX_CALC</tt> is not present.</li>
			<li> Added the optional parameter <tt>LMAX_CALC</tt> to 
			<tt>SHExpandGLQ</tt> and <tt>SHExpandDH</tt> that specifies the maximum degree of the spherical harmonic expansion. <tt>LMAX</tt> determines the grid spacing of the input grids, and corresponds to the maximum degree of the expansion if <tt>LMAX_CALC</tt> is not specified.</li>
			<li> <tt>MakeGeoid2D</tt> has been rewritten and renamed to <tt>MakeGeoidGrid</tt>. This new routine allows one to calculate the geoid using either first, second, or third order approximations, and the map values can be specified on either a 2D Cartesian grid, a Gauss-Legendre quadrature grid, a N by N grid, or a N by 2N grid. The geoid can either be referenced to a flattened ellipsoid, or a spherical interface.</li>
			<li> Fixed an error in the documentation to <tt>SHRotateCoef</tt> and <tt>SHRotateRealCoef</tt>. The rotations use the "y convention" where the second rotation is with respect to the y axis, and not the x axis as was originally stated.</li>
			<li> Added the optional parameters <tt>NORTH</tt>, <tt>SOUTH</tt>, <tt>EAST</tt> and <tt>WEST</tt> to the routines <tt>MakeGrid2D</tt>, <tt>MakeMagGrid2D</tt> and <tt>MakeGravGrid2D</tt> that specifies the maximum and minimum latitudes and longitudes of the output grid.</li>
			<li>Large temporary arrays are now dynamically allocated in order to resolve problems with Absoft ProFortran 10 and stack overflows.</li>
		</ul>

	<h2>Version 2.2 (May 20, 2007)</h2>

		<ul>
			<li> Added routine <tt>MakeGravGrid</tt> that will create a map of the radial gravity or potential referenced to a flattened ellipsoid.</li>
			<li> Added routine <tt>SHConfidence</tt> that determines the probability two sets of spherical harmonic coefficients are correlated at a given degree with a given correlation coefficient.</li>
			<li> Added optional parameter <tt>f</tt> to the routine <tt>MakeGrid2D</tt> in order to reference the function to a flattened ellipsoid.</li>
			<li> Added optional parameter <tt>K1LINSIG</tt> to <tt>SHLocalizedAdmitCorr</tt> that allows one to calculate the expected uncertainty of the admittance function using a single localization window. The gravity and topography coefficients are assumed to be related by a linear (degree-dependent) transfer function and that the lack of correlation is a result of uncorrelated noise.</li>
			<li> Added optional argument <tt>CNUM</tt> to <tt>MakeCircleCoord</tt> that gives the number of elements in the output arrays.</li>
			<li> Fixed minor bugs in <tt>PlmSchmidt</tt>, <tt>PlmSchmidt_d1</tt>, <tt>PlmBar</tt>, <tt>PlmBar_d1</tt> and <tt>PlmON_d1</tt> that could have caused runtime crashes under certain circumstances.</li>
			<li> Fixed a minor bug in <tt>MakeGrid2d</tt> that could have caused a runtime crash.</li>
			<li> Fixed a minor bug in <tt>PlmON_d1</tt> that could cause compilation errors.</li>
			<li> Fixed a minor bug in <tt> SHSjkPG</tt> that would cause g95  compiled code to crash at runtime.</li>
			<li> Saved allocated memory in the associated Legendre function routines (<tt>PlmSchmidt</tt>, <tt>PlmSchmidt_d1</tt>, <tt>PlmON</tt>, <tt>PlmON_d1</tt>, <tt>PlmBar</tt>, and <tt>PlmBar_d1</tt>) can be deallocated by calling with a spherical harmonic degree of -1.</li>
			<li> All routines that call associated Legendre functions now deallocate the saved allocated memory.</li>
		</ul>

	<h2>Version 2.1 (October 20, 2006)</h2>

		<ul>
			<li> Modified <tt>PlmBar</tt>, <tt>PlmBar_d1</tt>, <tt>PlmON</tt>, <tt>PlmON_d1</tt>, <tt>PlmSchmidt</tt> and <tt>PlmSchmidt_d1</tt> to save certain variables that are repeatedly calculated with multiple calls using the same maximum degree.</li>
			<li> <tt>MakeGridDH</tt>, <tt>MakeGridGLQ</tt>, <tt>SHExpandDH</tt>, and <tt>SHExpandGLQ</tt> have been rewritten so that the Legendre functions are computed within these routines, as opposed to being computed externally. This results in a reduction in computation time by a factor of about three to four.</li>
			<li> Added optional argument <tt>sampling</tt> that allows for the calculation of either equally sampled (NxN) and equally spaced (Nx2N) grids.</li>
			<li> Fixed a bug in <tt>MakeGridDH</tt> that would cause this routine to crash if the optional argument <tt>norm</tt> was not specified.</li>
			<li> Fixed <tt>SHMTVarOpt</tt> so that it would calculate all elements of the covariance matrix, not just those where the two tapers had the same value of <i>m</i>.</li>
			<li> Added optional argument <tt>nocross</tt> to <tt>SHMTVarOpt</tt> and <tt>SHMTVarOpt0</tt> in order to calculate only the diagonal terms of the covariance matrix <i>Fij</i>.</li>
			<li> Fixed a bug in <tt>SHReturnTapersM</tt> where the eigenvalues and eigenvectors were wrong when <i>m</i> was not equal to zero.</li>
			<li>Added subroutine <tt>SHMTDebais</tt> that inverts for the global power spectrum given a localized multitaper spectrum estimate.</li>
			<li> Minor tweaks and improved documentation.</li>
		</ul>

	<h2>Version 2.0.1 (August 7, 2006)</h2>

		<ul>
			<li> Updated the FAQ to describe common linking and compilation problems.</li>
			<li> <tt>make all</tt> and <tt>make all2</tt> will compile the source code with and without underscores appended to the LAPACK subroutine names, respectively.</li>
			<li> Created the user group <a href="http://groups.google.com/group/SHTOOLS">SHTOOLS</a> at Google groups. This is probably the best place to look for answers to common problems.</li>
			<li> The optional argument <tt>csphase</tt> was mistakenly declared for the function <tt>PLegendre_d1</tt> instead of <tt>PLegendreA_d1</tt> in the <tt>SHTOOLS.f95</tt> module file. This might have caused <tt>SHReturnTapersM</tt> to crash for <tt>m=0</tt>.</li>
			<li> Fixed a minor bug in the example file <tt>TestExpandDH.f95</tt> that might have caused this program to crash.</li>
			<li> Fixed a minor array allocation problem in <tt>SHBiasK</tt> and <tt>SHBias</tt> that might have caused this routine to crash.</li>
			<li> Added example programs for determining the timing and accuracy of the spherical harmonic transform routines.</li>
			<li> Modified the FFTW wisdom example to only create a wisdom file for a single spherical harmonic degree.</li>
			<li> Minor tweaks.</li>
		</ul>

	<h2>Version 2.0 (July 21, 2006)</h2>

		<ul>
			<li> Complete man and web based documentation has been written. In addition, all routines now check that the input arrays are dimensioned properly, and output informative errors if this is not the case.</li>
			<li> Subroutines <tt>Cilm_plus</tt> and <tt>DH_aj</tt> have been rename to <tt>CilmPlus</tt> and <tt>DHaj</tt>, respectively.</li>
			<li> <tt>MakeGridCoordGLQ</tt> renamed and completely written as <tt>GLQGridCoord</tt>.</li>
			<li> Subroutine <tt>ShannonNumber</tt> has been removed.</li>
			<li> Arguments of <tt>MakeGridDH</tt> have been reordered.</li>
			<li> Renamed <tt>SHReturnTapers</tt> to <tt>SHReturnTapers0</tt>.</li>
			<li> Renamed <tt>SHReturnAllTapers</tt> to <tt>SHReturnTapers</tt>.</li>
			<li> Added optional argument <tt>NORM</tt> to <tt>SHMultiply</tt>.</li>
		</ul>

	<h2>Version 1.7 (June 4, 2006)</h2>

		<ul>
			<li> Modified <tt>SHExpandDH</tt>, <tt>MakeGridDH</tt>, <tt>SHExpandGLQ</tt> and <tt>MakeGridGLQ</tt> to make use of the symmetry relationship of Legendre functions about the equator. This leads to an increase in speed by almost a factor of 2 (note that the documentation under the section "Speed" was generated using the old routines).</li>
			<li> Renamed <tt>SHAdmitCoher</tt> to <tt>SHAdmitCorr</tt>.</li>
			<li> Modified <tt>SHDeltaX</tt> to work with non-zonal windows.</li>
			<li> Fixed bug in <tt>SHMultiply</tt> that caused this routine to crash.</li>
			<li> Added routine <tt>MakeCircleCoord</tt> for projecting circles on a map.</li>
			<li> Removed subroutines <tt>SHSjkPP</tt>, <tt>SHMTVarPP</tt>, <tt>SHBiasMT</tt>, <tt>SHBiasMTM</tt>, <tt>LmaxSimons</tt>, <tt>dpnlgndr</tt> and <tt>dpnlgndr_d1</tt>.</li>
			<li> Added functions <tt>SHSjkPG0</tt> and <tt>SHjkPG</tt>.</li>
			<li> Added subroutines <tt>SHMTVarOpt0</tt> and <tt>SHMTVarOpt</tt> for calculating optimal weights and minimum variances of multitaper spectral estimates using zonal and non-zonal tapers, respectively.</li>
			<li> Added subroutine <tt>SHReturnAllTapers</tt> to return all tapers of the spherical cap concentration problem (not just the zonal ones as in <tt>SHReturnTapers</tt>).</li>
			<li> <tt>SHExpandDH</tt> has been modified (as well as the example file <tt>TestExpandDH</tt>) to allow for grids that are N by 2N. This ensures that higher frequencies in longitude are not aliased into lower frequencies when using data expressed on equally spaced grids.</li>
			<li> <b><tt>SHBias</tt> was modified such that the routine now expects as input the window's power spectrum, and NOT the window's coefficients! Furthermore, the routine now assumes (as stated in the program) that the variable <tt>incspectra</tt> is zero beyond <tt>ldata</tt>.</b></li>
			<li> <tt>SHBiasK</tt>, <tt>SHMultiTaperCSE</tt>, <tt>SHMultiTaperSE</tt>, and <tt>SHLocalizedAdmitCorr</tt> have been rewritten to work with non-zonal tapers.</li>
			<li><tt>SHrtoc</tt> and <tt>SHctor</tt> now allow to switch between Condon-Shortley phase conventions.</li>
			<li><tt>SHRotateRealCoef</tt> now checks to see what the default value of the Condon-Shortley phase is before converting the real coefficients to complex form.</li>
			<li> <tt>PLegendreA</tt> and <tt>PLegendreA_d1</tt> have been modified such that the default is to <b>exclude</b> the Condon-Shortley phase of <tt>(-1)<sup>m</sup></tt>.</li>
			<li> All assocaiated Legendre function routines can use the Condon-Shortely phase factor by specifying the optional parameter <tt>csphase=-1</tt>.</li>
			<li> The default Condon-Shortley phase convention can be set at compile time by changeing the variable <tt>CSPHASE_DEFAULT</tt> in <tt>SHTOOLS.f95</tt>.</li>
			<li> Added the optional argument <tt>csphase</tt> to the routines <tt>SHExpandLSQ</tt>, <tt>MakeGridDH</tt>, <tt>SHExpandDH</tt>, <tt>MakeGrid2D</tt>, <tt>MakeGridPoint</tt>, <tt>MakeGridGLQ</tt>, <tt>SHExpandGLQ</tt>, <tt>PreCompute</tt>, <tt>SHMutiTaperCSE</tt>, <tt>SHMultiTaperSE</tt>, and <tt>SHMultiply</tt>. (Nevertheless, <tt>MakeMagGrid2D</tt>, <tt>MakeGeoid2D</tt>, <tt>Hilm</tt>, and <tt>Cilm_Plus</tt> never use the Condon-Shortely phase, regardless of what the default value is.)</li>
		</ul>

	<h2>Version 1.6 (November 12, 2005)</h2>

		<ul>
			<li> SHTOOLS is now copyrighted according to the terms of the revised BSD license.</li>
			<li> Added "ortho-normalized" Legendre functions <tt>PlmON</tt>, <tt>PlmON_d1</tt>, <tt>PlON</tt>, and <tt>PlON_d1</tt>.</li>
			<li> Added subroutine <tt>SHReadCHAMP</tt> and <tt>SHReadGRACE</tt> that reads CHAMP and GRACE formatted spherical harmonic files, respectively.</li>
			<li> Fixed bug in routines <tt>SHrtoc</tt> and <tt>SHctor</tt> when the optional parameter <tt>convention</tt> was set equal to 2. This case was never used in previous versions of <tt>SHTOOLS</tt>.</li>
			<li> More constants have been added to the module <tt>Planets_Const</tt>.</li>
			<li> Added subroutine <tt>MakeGeoid2D</tt> that will create a 2D equally spaced grid of the geoid, calculated to second order, that includes the pseudo-rotational potential.</li>
			<li> <b>Fixed a bug in <tt>SHExpandGLQ</tt> and <tt>SHExpandDH</tt> that only concerned the degree-0 term when using Schmidt-normalized harmonics</b>.</li>
			<li> <b>Fixed a bug in <tt>SHExpandDH</tt> that gave meaningless results for very last degree of the spherical harmonic coefficients.</b></li>
		</ul>

	<h2>Version 1.5 (October 7, 2005)</h2>

		<ul>
			<li><tt>PlmBar</tt>, <tt>PlmBar_d1</tt>, <tt>PlmSchmidt</tt>, and <tt>PlmSchmidt_d1</tt> have been rewritten in order to give more accurate results for large <tt>m</tt> near the poles. The square roots of the integers are also precomputed leading to an increase in speed of about a factor of two.</li>
			<li> Added documentation concerning the accuracy and speed of the routines.</li>
			<li> Added make files to create a static archive of the compiled routines.</li>
			<li> Added optional argument <tt>chi2</tt> to <tt>SHExpandLSQ</tt>, which is the residual sum of squares misfit for an overdetermined inversion.</li>
			<li><tt>PreCompute</tt>, <tt>MakeGridGLQ</tt>, <tt>SHExpandGLQ</tt>, <tt>MakeGrid2D</tt>, <tt>MakeGridPoint</tt>, <tt>SHExpandDH</tt> and <tt>SHExpandLSQ</tt> now allow the option of using orthonormalized, unnormalized, or Schmidt normalized spherical harmonics.</li>
			<li> Added subroutine <tt>SHReadJPL</tt> that reads JPL formatted spherical harmonic files.</li>
			<li> Modified <tt>SHExpandDH</tt> so that it takes up much less memory when working with large spherical harmonic degrees.</li>
			<li> Modified <tt>PreCompute</tt>, <tt>SHExpandGLQ</tt>, <tt>MakeGridGLQ</tt>, <tt>Cilm_Plus</tt>, <tt>Hilm</tt>, and <tt>SHMultiply</tt>, as well as the example files <tt>MarsCrustalThickness</tt> and <tt>TestExpandGLQ</tt>, such that the array <tt>plx</tt> is optional. When working with large spherical harmonic degrees, this array takes up a lot of memory and should not be precomputed. If this array is not specified when calling the subroutine, then the optional array <tt>zero</tt> (obtained from <tt>PreCompute</tt>) must be specified instead.</li>
		</ul>

	<h2>Version 1.4 (August 7, 2005)</h2>

		<ul>
			<li> Added optional argument <tt>taper_number</tt> to the function <tt>SHFindLWin</tt>.</li>
			<li>Added subroutines <tt>SHSjkPP</tt>, <tt>SHMTVarPP</tt>, <tt>SHMultiTaperSE</tt>, and <tt>SHMultiTaperCSE</tt>.</li>
			<li><tt>SHLocalizedAdmitCoher</tt> now requires the mandatory calling parameter <tt>K</tt> which is the number of tapers to be used in the spectral estimations. </li>
			<li>Changed name of <tt>SHLocalizedAdmitCoher</tt> to <tt>SHLocalizedAdmitCorr</tt>.</li>
			<li>Added planets_const.</li>
			<li>Added optional parameter to <tt>SHrtoc</tt> and <tt>SHctor</tt> in order to choose between <i>Varshalovich et al.</i> and 4-pi geodesy complex coefficients.</li>
			<li><tt>MakeGrid2D</tt> and <tt>MakeMagGrid2d</tt> have been speeded up by a factor of about 10.</li>
		</ul>

	<h2>Version 1.3 (August 17, 2004)</h2>

		<ul>
			<li>Added routines <tt>SHExpandLSQ</tt>, <tt>RandomN</tt>, <tt>RandomGaussian</tt>, <tt>SHMultiply</tt>, <tt>ReadWisdom</tt>, <tt>ComputeD0</tt>, <tt>ComputeDm</tt>, <tt>ComputeDG82</tt>, <tt>SphericalCapCoef</tt>, <tt>LmaxSimons</tt>, <tt>SHDeltaX</tt>, <tt>SHDeltaL</tt>, <tt>SHReturnTapers</tt>, <tt>EigValVecSym</tt>, <tt>EigValVecSymTri</tt>, <tt>EigValSym</tt>, <tt>SHFindLWin</tt>, <tt>SHLocalizedAdmitCoher</tt>, <tt>SHAdmitCoher</tt>, <tt>Wigner3j</tt>, <tt>SHBias</tt>, <tt>SHBiasK</tt>, <tt>SHBiasMT</tt>, <tt>SHBiasMTM</tt>.</li>
			<li>Added optional argument <tt>skip</tt> to <tt>SHRead</tt>.</li>
			<li><tt>PreCompute</tt> now tries to read a default system-wide <tt>FFTW</tt> wisdom file at <tt>/etc/fftw/wisdom</tt>, as well as an optional user defined <tt>FFTW</tt> wisdom file.</li>
			<li>Removed suffixes <tt>_FFTW</tt> from filenames and routines that use the <tt>FFTW</tt> routines.</li>
		</ul>

	<h2>Version 1.2</h2>

		<ul>
			<li>Added routines <tt>MakeGridPoint</tt>, <tt>PlmSchmidt_d1</tt>, <tt>PlBar</tt>, <tt>PlBar_d1</tt>, <tt>PlSchmidt</tt>, <tt>PlSchmidt_d1</tt>, <tt>PlmBar_d1</tt>, <tt>PLegendreL</tt>, <tt>PLegendreL_d1</tt>, <tt>PLegendreA</tt>, and <tt>PLegendreA_d1</tt>.</li>
			<li>Added function declarations for <tt>wl</tt> and <tt>wl_curv</tt> to the interface block in SHTOOLS.</li>
			<li>Renamed the function <tt>index</tt> to <tt>PlmIndex</tt>.</li>
			<li>Renamed module <tt>FFTW</tt> to <tt>FFTW3</tt>.</li>
			<li> Added the optional argument <tt>lmax</tt> to the spherical harmonic conversion routines <tt>SHrtoc</tt>, <tt>SHctor</tt>, <tt>SHcilmtocindex</tt>, <tt>SHcindextocilm</tt>.</li>
			<li>Added the optional argument <tt>norm</tt> (which defines the spherical harmonic normalization) to the routines <tt>MakeGrid2D</tt> and <tt>MakeGridPoint</tt>.</li>
		</ul>

	<h2>Version 1.1 (May 26, 2004)</h2>

		<ul>
			<li> Added routines <tt>SHExpandDH_FFTW</tt> and <tt>DH_aj</tt>.</li>
		</ul>

	<p class="dir">
	>  <a href="../index.html" class="dir">Home</a> > <a href="documentation.html" class="dir">Documentation</a></p>

	<table class="footer2">
	<tbody>
		<tr>
			<td class="c1"><a href="https://lagrange.oca.eu/?lang=en">Laboratoire Lagrange</a></td>
			<td class="c2"><a href="https://www.oca.eu/?lang=en">Observatoire de la CÃ´te d'Azur</a></td>
			<td class="c3">&copy; 2016 <a href="https://github.com/SHTOOLS">SHTOOLS</a></td>
		</tr>
	</tbody>
	</table>

</div>

</body>
</html>
