.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "shread" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.11"
.hy
.SH SHRead
.PP
Read spherical harmonic coefficients from an ascii-formatted file.
.SH Usage
.PP
call SHRead (\f[V]filename\f[R], \f[V]cilm\f[R], \f[V]lmax\f[R],
\f[V]skip\f[R], \f[V]header\f[R], \f[V]error\f[R], \f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]filename\f[R] : input, character(:)
The filename of the ascii file containing the spherical harmonic
coefficients.
.TP
\f[V]cilm\f[R] : output, real(dp), dimension (2, \f[V]lmax\f[R]+1, \f[V]lmax\f[R]+1)
The spherical harmonic coefficients contained in \f[V]filename\f[R].
.TP
\f[V]lmax\f[R] : output, integer(int32)
The maximum spherical harmonic degree of \f[V]cilm\f[R].
This is the minimum of the maximum spherical harmonic degree of
\f[V]filename\f[R] and the dimension of \f[V]cilm\f[R]-1.
.TP
\f[V]skip\f[R] : input, optional, integer(int32)
The number of lines to skip before parsing \f[V]filename\f[R].
.TP
\f[V]header\f[R] : output, optional, real(dp) dimension (\f[V]n\f[R])
A vector containing the first \f[V]n\f[R] numbers in the first line of
the file (following any skipped lines).
.TP
\f[V]error\f[R] : output, optional, real(dp) dimension (2, \f[V]lmax\f[R]+1, \f[V]lmax\f[R]+1)
The errors corresponding to the spherical harmonic coefficients
\f[V]cilm\f[R].
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[V]SHRead\f[R] will read spherical harmonic coefficients from an
ascii-formatted file into an array \f[V]cilm\f[R].
The maximum spherical harmonic degree that is read is determined by the
minimum of the dimension of the input array \f[V]cilm\f[R]-1 and the
maximum degree of the coefficients in the file.
If the optional array \f[V]skip\f[R] is specified, parsing of the file
will commence after the first \f[V]skip\f[R] lines.
If the optional array \f[V]header\f[R] is specified, then the first
\f[V]n\f[R] elements after the skipped lines will be output, where
\f[V]n\f[R] is the length of the array \f[V]header\f[R].
.PP
The spherical harmonic coefficients in the file are assumed to be
ordered by increasing degree \f[V]l\f[R] and angular order \f[V]m\f[R]
according to the format
.PP
\f[V]l, m, cilm(1,l+1,m+1), cilm(2,l+1,m+1)\f[R]
.PP
The actual delimeters (commas, spaces, or tabs) are unimportant.
If the optional array \f[V]error\f[R] is specified, then the error for
each coefficient will be read according to the format
.PP
\f[V]l, m, cilm(1,l+1,m+1), cilm(2,l+1,m+1), error(1,l+1,m+1), error(2,l+1,m+1)\f[R]
.PP
The ordering of the file is explcitly given by
.PP
\f[V]l, 0 / l, 1 / l, 2 /l, ... / l, m / l+1, 0 / l+1, 1 / ...\f[R]
.PP
The first spherical harmonic degree of the filename does not have to be
0; this is determined from the first element after the \f[V]skip\f[R]
and \f[V]header\f[R] lines.
.SH See also
.PP
shread2, shreadjpl
