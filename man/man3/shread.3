.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shread" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH SHRead
Read spherical harmonic coefficients from an ascii\-formatted file.
.SH Usage
call SHRead (\f[CR]filename\f[R], \f[CR]cilm\f[R], \f[CR]lmax\f[R],
\f[CR]skip\f[R], \f[CR]header\f[R], \f[CR]error\f[R],
\f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]filename\f[R] : input, character(:)
The filename of the ascii file containing the spherical harmonic
coefficients.
.TP
\f[CR]cilm\f[R] : output, real(dp), dimension (2, \f[CR]lmax\f[R]+1, \f[CR]lmax\f[R]+1)
The spherical harmonic coefficients contained in \f[CR]filename\f[R].
.TP
\f[CR]lmax\f[R] : output, integer(int32)
The maximum spherical harmonic degree of \f[CR]cilm\f[R].
This is the minimum of the maximum spherical harmonic degree of
\f[CR]filename\f[R] and the dimension of \f[CR]cilm\f[R]\-1.
.TP
\f[CR]skip\f[R] : input, optional, integer(int32)
The number of lines to skip before parsing \f[CR]filename\f[R].
.TP
\f[CR]header\f[R] : output, optional, real(dp) dimension (\f[CR]n\f[R])
A vector containing the first \f[CR]n\f[R] numbers in the first line of
the file (following any skipped lines).
.TP
\f[CR]error\f[R] : output, optional, real(dp) dimension (2, \f[CR]lmax\f[R]+1, \f[CR]lmax\f[R]+1)
The errors corresponding to the spherical harmonic coefficients
\f[CR]cilm\f[R].
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]SHRead\f[R] will read spherical harmonic coefficients from an
ascii\-formatted file into an array \f[CR]cilm\f[R].
The maximum spherical harmonic degree that is read is determined by the
minimum of the dimension of the input array \f[CR]cilm\f[R]\-1 and the
maximum degree of the coefficients in the file.
If the optional array \f[CR]skip\f[R] is specified, parsing of the file
will commence after the first \f[CR]skip\f[R] lines.
If the optional array \f[CR]header\f[R] is specified, then the first
\f[CR]n\f[R] elements after the skipped lines will be output, where
\f[CR]n\f[R] is the length of the array \f[CR]header\f[R].
.PP
The spherical harmonic coefficients in the file are assumed to be
ordered by increasing degree \f[CR]l\f[R] and angular order \f[CR]m\f[R]
according to the format
.PP
\f[CR]l, m, cilm(1,l+1,m+1), cilm(2,l+1,m+1)\f[R]
.PP
The actual delimeters (commas, spaces, or tabs) are unimportant.
If the optional array \f[CR]error\f[R] is specified, then the error for
each coefficient will be read according to the format
.PP
\f[CR]l, m, cilm(1,l+1,m+1), cilm(2,l+1,m+1), error(1,l+1,m+1), error(2,l+1,m+1)\f[R]
.PP
The ordering of the file is explcitly given by
.PP
\f[CR]l, 0 / l, 1 / l, 2 /l, ... / l, m / l+1, 0 / l+1, 1 / ...\f[R]
.PP
The first spherical harmonic degree of the filename does not have to be
0; this is determined from the first element after the \f[CR]skip\f[R]
and \f[CR]header\f[R] lines.
.SH See also
shread2, shreadjpl
