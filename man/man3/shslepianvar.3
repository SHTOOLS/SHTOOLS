.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "shslepianvar" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.12"
.hy
.SH SHSlepianVar
.PP
Calculate the theoretical variance of the power of a function expanded
in spherical-cap Slepian functions for a given spherical harmonic
degree.
.SH Usage
.PP
call SHSlepianVar (\f[V]l\f[R], \f[V]galpha\f[R],
\f[V]galpha_order\f[R], \f[V]lmax\f[R], \f[V]kmax\f[R], \f[V]sff\f[R],
\f[V]variance\f[R], \f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]l\f[R] : input, integer(int32)
The spherical harmonic degree used to calculate the theoretical
variance.
.TP
\f[V]galpha\f[R] : input, real(dp), dimension (\f[V]lmax\f[R]+1, \f[V]kmax\f[R])
A matrix of spherical-cap Slepian functions obtained from
\f[V]SHReturnTapers\f[R] or \f[V]SHReturnTapersM\f[R].
.TP
\f[V]galpha_order\f[R] : input, integer(int32), dimension (\f[V]kmax\f[R])
The angular orders of the spherical-cap Slepian functions in
\f[V]galpha\f[R].
.TP
\f[V]lmax\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the Slepian functions.
.TP
\f[V]kmax\f[R] : input, integer(int32)
The maximum number of Slepian functions to use when calculating the
variance.
.TP
\f[V]sff\f[R] : input, real(dp), dimension (\f[V]lmax\f[R]+1)
The global power spectrum of the function.
.TP
\f[V]variance\f[R] : output, real(dp)
The theoretical variance of the spectral estimate for degree
\f[V]l\f[R].
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[V]SHSlepianVar\f[R] will compute the theoretical variance of the
power of a function expanded in spherical-cap Slepian functions for a
given spherical harmonic degree.
This routine takes as input the spherical harmonic coefficients of the
spherical-cap Slepian functions as obtained by a call to
\f[V]SHReturnTapers\f[R], and only the first \f[V]KMAX\f[R] Slepian
functions in the matrix \f[V]GALPHA\f[R] are used to compute the
variance.
.SH See also
.PP
shreturntapers, shreturntapersm, slepiancoeffs, slepiancoeffstosh,
shscouplingmatrixcap
