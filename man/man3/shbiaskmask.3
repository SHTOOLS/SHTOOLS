.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shbiaskmask" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH SHBiasKMask
Calculate the multitaper (cross\-)power spectrum expectation of a
function localized by arbitrary windows derived from a mask.
.SH Usage
call SHBiasK (\f[CR]tapers\f[R], \f[CR]lwin\f[R], \f[CR]k\f[R],
\f[CR]incspectra\f[R], \f[CR]ldata\f[R], \f[CR]outcspectra\f[R],
\f[CR]taper_wt\f[R], \f[CR]save_cg\f[R], \f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]tapers\f[R] : input, real(dp), dimension ((\f[CR]lwin\f[R]+1)**2, \f[CR]k\f[R])
The spherical harmonic coefficients of the localization windows
generated by a call to \f[CR]SHReturnTapersMap\f[R].
The coefficients in each column are ordered according to the convention
in \f[CR]SHCilmToVector\f[R].
.TP
\f[CR]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing windows.
.TP
\f[CR]k\f[R] : input, integer(int32)
The number of localization windows to use.
Only the first \f[CR]k\f[R] columns of \f[CR]tapers\f[R] will be
employed, which corresponds to the best\-concentrated windows.
.TP
\f[CR]incspectra\f[R] : input, real(dp), dimension (\f[CR]ldata\f[R]+1)
The global unwindowed power spectrum.
.TP
\f[CR]ldata\f[R] : input, integer(int32)
The maximum degree of the global unwindowed power spectrum.
.TP
\f[CR]outcspectra\f[R] : output, real(dp), dimension (\f[CR]ldata\f[R]+\f[CR]lwin\f[R]+1)
The expectation of the localized multitaper power spectrum.
.TP
\f[CR]taper_wt\f[R] : input, optional, real(dp), dimension (\f[CR]k\f[R])
The weights to apply to each individual windowed spectral estimate.
.TP
\f[CR]save_cg\f[R] : input, optional, integer(int32), default = 0
If set equal to 1, the Clebsch\-Gordon coefficients will be precomputed
and saved for future use (if \f[CR]lwin\f[R] or \f[CR]ldata\f[R] change,
these will be recomputed).
To deallocate the saved memory, set this parameter equal to 1.
If set equal to 0 (default), the Clebsch\-Gordon coefficients will be
recomputed for each call.
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]SHBiasKMask\f[R] will calculate the multitaper (cross\-)power
spectrum expectation of a function multiplied by the \f[CR]k\f[R]
best\-concentrated localization windows derived from an arbitrary mask.
This is given by equation 36 of Wieczorek and Simons (2005) (see also
eq.
2.11 of Wieczorek and Simons 2007).
In contrast to \f[CR]SHBias\f[R], which takes as input the power
spectrum of a single localization window, this routine expects as input
a matrix containing the spherical harmonic coefficients of the windows.
These can be generated by a call to \f[CR]SHReturnTapersMap\f[R] and the
coefficients in each column are ordered according to the convention in
\f[CR]SHCilmToVector\f[R].
.PP
The maximum calculated degree of the windowed power spectrum expectation
corresponds to the smaller of (\f[CR]ldata\f[R]+\f[CR]lwin\f[R]) and
\f[CR]size(outcspectra)\-1\f[R].
It is assumed implicitly that the power spectrum of
\f[CR]inspectrum\f[R] is zero beyond degree \f[CR]ldata\f[R].
If this is not the case, the ouput power spectrum should be considered
valid only for the degrees up to and including \f[CR]ldata\f[R] \-
\f[CR]lwin\f[R].
.PP
The default is to apply equal weights to each individual windowed
estimate of the spectrum, but this can be modified by specifying the
weights in the optional argument \f[CR]taper_wt\f[R].
The weights must sum to unity.
If this routine is to be called several times using the same values of
\f[CR]lwin\f[R] and \f[CR]ldata\f[R], then the Clebsch\-Gordon
coefficients can be precomputed and saved by setting the optional
parameter \f[CR]save_cg\f[R] equal to 1.
.SH References
Wieczorek, M. A. and F. J. Simons, Minimum\-variance multitaper spectral
estimation on the sphere, J. Fourier Anal.
Appl., 13, 665\-692, doi:10.1007/s00041\-006\-6904\-1, 2007.
.PP
Simons, F. J., F. A. Dahlen and M. A. Wieczorek, Spatiospectral
concentration on a sphere, SIAM Review, 48, 504\-536,
doi:10.1137/S0036144504445765, 2006.
.PP
Wieczorek, M. A. and F. J. Simons, Localized spectral analysis on the
sphere, Geophys.
J. Int., 162, 655\-675, doi:10.1111/j.1365\-246X.2005.02687.x, 2005.
.SH See also
shbias, shreturntapersmap, shmtcouplingmatrix
