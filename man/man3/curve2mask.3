.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "curve2mask" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH Curve2Mask
Given a set of latitude and longitude coordinates representing a closed
curve, output a gridded binary mask.
.SH Usage
call Curve2Mask (\f[CR]mask_dh\f[R], \f[CR]n\f[R], \f[CR]sampling\f[R],
\f[CR]profile\f[R], \f[CR]nprofile\f[R], \f[CR]np\f[R],
\f[CR]extend\f[R], \f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]dh_mask\f[R] : output, integer(int32), dimension (nlat, nlong)
A Driscoll and Healy (1994) sampled grid representing a mask denoted by
a closed curve.
All elements will either be 1 (for inside the curve) or 0 (for outside
the curve).
If \f[CR]sampling\f[R] is 1, the grid is equally sampled and is
dimensioned as (\f[CR]n\f[R] by \f[CR]n\f[R]), where \f[CR]n\f[R] is
\f[CR]2lmax+2\f[R].
If sampling is 2, the grid is equally spaced and is dimensioned as
(\f[CR]n\f[R] by 2\f[CR]n\f[R]).
The first latitudinal band of the grid corresponds to 90 N, the
latitudinal sampling interval is 180/\f[CR]n\f[R] degrees, and the
default behavior is to exclude the latitudinal band for 90 S. The first
longitudinal band of the grid is 0 E, by default the longitudinal band
for 360 E is not included, and the longitudinal sampling interval is
360/\f[CR]n\f[R] for an equally sampled and 180/\f[CR]n\f[R] for an
equally spaced grid, respectively.
If \f[CR]extend\f[R] is 1, the longitudinal band for 360 E and the
latitudinal band for 90 S will be included, which increases each of the
dimensions of the grid by 1.
.TP
\f[CR]n\f[R] : input, integer
The number of latitudinal samples in \f[CR]dh_mask\f[R].
The effective spherical harmonic bandwidth of this grid is
\f[CR]L=n/2\-1\f[R].
.TP
\f[CR]sampling\f[R] : input, integer(int32)
For 1, \f[CR]dh_mask\f[R] is dimensioned as (\f[CR]n\f[R],
\f[CR]n\f[R]), whereas for 2, \f[CR]dh_mask\f[R] is dimensioned as
(\f[CR]n\f[R], \f[CR]2n\f[R]).
.TP
\f[CR]profile\f[R] : input, real(dp), dimension (\f[CR]nprofile\f[R], 2)
List of latitude (:,1) and longitude (:,2) coordinates in degrees
specifying a single closed curve.
.TP
\f[CR]nprofile\f[R] : input, integer(int32)
The number of coordinates in the curve \f[CR]profile\f[R].
.TP
\f[CR]np\f[R] : input, integer(int32)
The value of the returned mask at the North pole (90N, 0E).
If the North pole is outside of the concentration region, set this to 0;
if it is inside the concentration region, set this to 1.
.TP
\f[CR]extend\f[R] : input, optional, integer(int32), default = 0
If 1, compute the longitudinal band for 360 E and the latitudinal band
for 90 S. This increases each of the dimensions of \f[CR]dh_mask\f[R] by
1.
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]Curve2Mask\f[R] will take a list of latitude and longitude
coordinates that represent a single closed curve, and output a mask
\f[CR]mask_dh\f[R] that contains ones and zeros where the grid nodes are
inside and outside of the curve, respectively.
\f[CR]mask_dh\f[R] must be sampled according to the Driscoll and Healy
(1994) sampling theorem with \f[CR]n\f[R] samples in latitude, and
either possess \f[CR]n\f[R] samples in longitude (\f[CR]sampling=1\f[R])
or \f[CR]2n\f[R] samples in longitude (\f[CR]sampling=2\f[R]).
It is necessary to specify a single point as being inside or outside of
the curve, and for this the value at the North pole (90N, 0E) must be
specified as either 0 or 1.
.PP
Longitudes of the curve can span the range from \-360 to 720 degrees.
If the longitudes of two adjacent points differ by more than 180
degrees, it will be assumed that the curve passes from 360 to 0 degrees,
or from \-180 to 180 degrees.
.SH Reference
Driscoll, J.R.
and D.M.
Healy, Computing Fourier transforms and convolutions on the 2\-sphere,
Adv.
Appl.
Math., 15, 202\-250, 1994.
.SH See also
shreturntapersmap, computedmap
