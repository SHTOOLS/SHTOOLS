.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shlocalizedadmitcorr" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH SHLocalizedAdmitCorr
Calculate the localized admittance and correlation spectra of two
functions at a given location using spherical cap localization windows.
.SH Usage
call SHLocalizedAdmitCorr (\f[CR]tapers\f[R], \f[CR]taper_order\f[R],
\f[CR]lwin\f[R], \f[CR]lat\f[R], \f[CR]lon\f[R], \f[CR]gilm\f[R],
\f[CR]tilm\f[R], \f[CR]lmax\f[R], \f[CR]admit\f[R], \f[CR]corr\f[R],
\f[CR]k\f[R], \f[CR]admit_error\f[R], \f[CR]corr_error\f[R],
\f[CR]taper_wt\f[R], \f[CR]mtdef\f[R], \f[CR]k1linsig\f[R],
\f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]tapers\f[R] : input, real(dp), dimension (\f[CR]lwin\f[R]+1, \f[CR]k\f[R])
A matrix of spherical cap localization functions obtained from
\f[CR]SHReturnTapers\f[R] or \f[CR]SHReturnTapersM\f[R].
.TP
\f[CR]taper_order\f[R] : input, integer(int32), dimension (\f[CR]k\f[R])
The angular order of the windowing coefficients in \f[CR]tapers\f[R].
.TP
\f[CR]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing windows.
.TP
\f[CR]lat\f[R] : input, real(dp)
The latitude of the localized analysis in degrees.
.TP
\f[CR]lon\f[R] : input, real(dp)
The longitude of the localized analysis in degrees.
.TP
\f[CR]gilm\f[R] : input, real(dp), dimension (2, \f[CR]lmax\f[R]+1, \f[CR]lmax\f[R]+1)
The spherical harmonic coefficients of the function G.
.TP
\f[CR]tilm\f[R] : input, real(dp), dimension (2, \f[CR]lmax\f[R]+1, \f[CR]lmax\f[R]+1)
The spherical harmonic coefficients of the function T.
.TP
\f[CR]lmax\f[R] : input, integer(int32)
The maximum spherical harmonic degree of the input functions
corresponding to \f[CR]gilm\f[R] and \f[CR]tilm\f[R].
.TP
\f[CR]admit\f[R] : output, real(dp), dimension (\f[CR]lmax\f[R]\-\f[CR]lwin\f[R]+1)
The admittance function, which is equal to \f[CR]Sgt/Stt\f[R].
.TP
\f[CR]corr\f[R] : output, real(dp), dimension (\f[CR]lmax\f[R]\-\f[CR]lwin\f[R]+1)
The degree correlation function, which is equal to
\f[CR]Sgt/sqrt(Sgg Stt)\f[R].
.TP
\f[CR]k\f[R] : input, integer(int32)
The number of tapers to be used in the multitaper spectral analysis.
.TP
\f[CR]admit_error\f[R] : output, optional, real(dp), dimension (\f[CR]lmax\f[R]\-\f[CR]lwin\f[R]+1)
The standard error of the admittance function.
.TP
\f[CR]corr_error\f[R] : output, optional, real(dp), dimension (\f[CR]lmax\f[R]\-\f[CR]lwin\f[R]+1)
The standard error of the degree correlation function.
.TP
\f[CR]taper_wt\f[R] : input, optional, real(dp), dimension (\f[CR]k\f[R])
The weights to be applied to the spectral estimates when calculating the
admittance, correlation, and their associated errors.
This must sum to unity.
.TP
\f[CR]mtdef\f[R] : input, optional, integer(int32), default = 1
1 (default): Calculate the multitaper spectral estimates Sgt, Sgg and
Stt first, and then use these to calculate the admittance and
correlation functions.
2: Calculate admittance and correlation spectra using each individual
taper, and then average these to obtain the multitaper admittance and
correlation functions.
.TP
\f[CR]k1linsig\f[R] : input, optional, integer(int32)
If equal to one, and only a single taper is being used, the errors in
the admittance function will be calculated by assuming that the
coefficients of \f[CR]gilm\f[R] and \f[CR]tilm\f[R] are related by a
linear degree\-dependent transfer function and that the lack of
correlation is a result of uncorrelated noise.
This is the square root of eq.
33 of Simons et al.\ 1997.
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]SHLocalizedAdmitCorr\f[R] will calculate the localized admittance
and degree correlation spectra of two functions at a given location.
The windowing functions are solutions to the spherical\-cap
concentration problem (as calculated by \f[CR]SHReturnTapers\f[R] or
\f[CR]SHReturnTapersM\f[R]), of which the best \f[CR]k\f[R] concentrated
tapers are utilized.
If \f[CR]k\f[R] is greater than 1, then estimates of the standard error
for the admittance and correlation will be returned in the optional
arrays \f[CR]admit_error\f[R] and \f[CR]corr_error\f[R].
The symmetry axis of the localizing windows are rotated to the
coordinates (\f[CR]lat\f[R], \f[CR]lon\f[R]) before performing the
windowing operation.
.PP
The admittance is defined as \f[CR]Sgt/Stt\f[R], where \f[CR]Sgt\f[R] is
the localized cross\-power spectrum of two functions \f[CR]G\f[R] and
\f[CR]T\f[R] expressed in spherical harmonics.
The localized degree\-correlation spectrum is defined as
\f[CR]Sgt/sqrt(Sgg Stt)\f[R], which can possess values between \-1 and
1.
Two methods are available for calculating the multitaper admittance and
correlation functions.
When \f[CR]mtdef\f[R] is 1 (default), the multitaper estimates and
errors of Sgt, Stt, and Sgg are calculated by calls to
\f[CR]SHMultiTaperSE\f[R] and \f[CR]SHMultiTaperCSE\f[R], and these
results are then used to calculate the final admittance and correlation
functions.
When \f[CR]mtdef\f[R] is 2, the admitance and correlation are calculated
invidivually for each individual taper, and these results are then
averaged.
.PP
If the optional parameter \f[CR]k1linsig\f[R] is specified, and only a
single taper is being used, the uncertainty in the admittance function
will be calculated by assuming the two sets of coefficients are related
by a linear degree\-dependent transfer function and that the lack of
correlation is a result of uncorrelated noise.
.PP
When \f[CR]mtdef\f[R] is 1, by default, the multitaper spectral
estimates are calculated as an unweighted average of the individual
tapered estimates.
However, if the optional argument \f[CR]taper_wt\f[R] is specified, a
weighted average will be employed using the weights in this array.
Minimum variance optimal weights can be obtained from the routines
\f[CR]SHMTVarOpt\f[R] if the form of the underlying global power
spectrum is known.
Taper weights can not be used when \f[CR]mtdef\f[R] is 2
.PP
This routine assumes that the input functions and tapers are expressed
using geodesy 4\-pi normalized spherical harmonic functions that exclude
the Condon\-Shortley phase factor of (\-1)\(ham.
.SH See also
shreturntapers, shreturntapersm, shmultitaperse, shmultitapercse
.SH References
Wieczorek, M. A. and F. J. Simons, Minimum\-variance multitaper spectral
estimation on the sphere, J. Fourier Anal.
Appl., 13, doi:10.1007/s00041\-006\-6904\-1, 665\-692, 2007.
.PP
Simons, F. J., F. A. Dahlen and M. A. Wieczorek, Spatiospectral
concentration on the sphere, SIAM Review, 48, 504\-536,
doi:10.1137/S0036144504445765, 2006.
.PP
Wieczorek, M. A. and F. J. Simons, Localized spectral analysis on the
sphere, Geophys.
J. Int., 162, 655\-675, 2005.
.PP
Simons, M., S. C. Solomon and B. H. Hager, Localization of gravity and
topography: constrains on the tectonics and mantle dynamics of Venus,
Geophys.
J. Int., 131, 24\-44, 1997.
