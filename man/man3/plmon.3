.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "plmon" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.13"
.hy
.SH PlmON
.PP
Compute all the orthonormalized associated Legendre functions.
.SH Usage
.PP
call PlmON (\f[V]p\f[R], \f[V]lmax\f[R], \f[V]z\f[R], \f[V]csphase\f[R],
\f[V]cnorm\f[R], \f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]p\f[R] : output, real(dp), dimension ((\f[V]lmax\f[R]+1)*(\f[V]lmax\f[R]+2)/2)
An array of orthonormalized associated Legendre functions up to degree
\f[V]lmax\f[R].
The index corresponds to \f[V]l*(l+1)/2+m+1\f[R], which can be
calculated by a call to \f[V]PlmIndex\f[R].
.TP
\f[V]lmax\f[R] : input, integer(int32)
The maximum degree of the associated Legendre functions to be computed.
If \f[V]lmax\f[R] is -1, allocated memory will be deallocated.
.TP
\f[V]z\f[R] : input, real(dp)
The argument of the associated Legendre functions.
.TP
\f[V]csphase\f[R] : input, optional, integer(int32), default = 1
If 1 (default), the Condon-Shortley phase will be excluded.
If -1, the Condon-Shortley phase of (-1)\[ha]m will be appended to the
associated Legendre functions.
.TP
\f[V]cnorm\f[R] : input, optional, integer(int32), default = 0
If 1, the complex normalization of the associated Legendre functions
will be used.
The default is to use the real normalization.
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[V]PlmON\f[R] will calculate all of the orthonormalized associated
Legendre functions up to degree \f[V]lmax\f[R] for a given argument.
These are calculated using a standard three-term recursion formula, and
in order to prevent overflows, the scaling approach of Holmes and
Featherstone (2002) is utilized.
These functions are accurate to about degree 2800.
The index of the array corresponding to a given degree \f[V]l\f[R] and
angular order \f[V]m\f[R] is \f[V]l*(l+1)/2+m+1\f[R], which can be
calculated by a call to \f[V]PlmIndex\f[R].
.PP
The integral of the squared Legendre functions over the interval [-1, 1]
is \f[V](2-delta(0,m))/(2pi)\f[R], where delta is the Kronecker delta
function.
If the optional parameter \f[V]cnorm\f[R] is set equal to 1, the complex
normalization will be used where the integral of the squared Legendre
functions over the interval [-1, 1] is \f[V]1/(2pi)\f[R].
The default is to exclude the Condon-Shortley phase, but this can be
modified by setting the optional argument \f[V]csphase\f[R] to -1.
.PP
This routine saves the three-term recursion factors and square roots of
the integers the first time being called.
If subsequent calls possess the same value of \f[V]lmax\f[R], these will
not be recomputed.
If you wish to deallocate this memory, which is an array of length
\f[V](lmax+1)*(lmax+2)\f[R], recall this routine with \f[V]lmax\f[R]=-1.
.SH References
.PP
Holmes, S.
A., and W.
E.
Featherstone, A unified approach to the Clenshaw summation and the
recursive computation of very high degree and order normalised
associated Legendre functions, J.
Geodesy, 76, 279- 299, 2002.
.SH See also
.PP
plbar, plbar_d1, plmbar, plmbar_d1, plon, plon_d1, plmon_d1, plschmidt,
plschmidt_d1, plmschmidt, plmschmidt_d1, plegendre, plegendre_d1,
plegendrea, plegendrea_d1, plmindex
