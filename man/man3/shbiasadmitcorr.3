.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "shbiasadmitcorr" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.12"
.hy
.SH SHBiasAdmitCorr
.PP
Calculate the expected multitaper admittance and correlation spectra
associated with the input global cross-power spectra of two functions.
.SH Usage
.PP
call SHAdmitCorr (\f[V]sgt\f[R], \f[V]sgg\f[R], \f[V]stt\f[R],
\f[V]lmax\f[R], \f[V]tapers\f[R], \f[V]lwin\f[R], \f[V]k\f[R],
\f[V]admit\f[R], \f[V]corr\f[R], \f[V]mtdef\f[R], \f[V]taper_wt\f[R],
\f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]sgt\f[R] : input, real(dp), dimension (\f[V]lmax\f[R]+1)
The global cross-power spectrum of the functions \f[V]G\f[R] and
\f[V]T\f[R].
.TP
\f[V]sgg\f[R] : input, real(dp), dimension (\f[V]lmax\f[R]+1)
The global power spectrum of the function \f[V]G\f[R].
.TP
\f[V]stt\f[R] : input, real(dp), dimension (\f[V]lmax\f[R]+1)
The global power spectrum of the function \f[V]T\f[R].
.TP
\f[V]lmax\f[R] : input, integer(int32)
The maximum spherical harmonic degree to use of the input spectra
\f[V]sgt\f[R], \f[V]sgg\f[R], \f[V]stt\f[R].
.TP
\f[V]tapers\f[R] : input, real(dp), dimension (\f[V]lwin\f[R]+1, \f[V]k\f[R])
The spherical harmonic coefficients of the spherical cap localizing
windows.
Each column corresponds to the non-zero coefficients of a single angular
order.
Since all that is important is the power spectrum of each window, the
exact angular order is not important.
These are generated by a call to \f[V]SHReturnTapers\f[R] or
\f[V]SHReturnTapersM\f[R].
.TP
\f[V]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing windows.
.TP
\f[V]k\f[R] : input, integer(int32)
The number of localizing windows to use.
Only the first \f[V]k\f[R] columns of \f[V]tapers\f[R] will be employed,
which corresponds to the \f[V]k\f[R] best-concentrated localizing
windows.
.TP
\f[V]admit\f[R] : output, real(dp), dimension (\f[V]lmax\f[R]-\f[V]lwin\f[R]+1)
The biased admittance spectrum obtained using the localized
(cross-)power spectra of Sgt and Stt.
.TP
\f[V]corr\f[R] : output, real(dp), dimension (\f[V]lmax\f[R]-\f[V]lwin\f[R]+1)
The biased correlation spectrum obtained using the localized
(cross-)power spectra of Sgt, Stt, and Sgg.
.TP
\f[V]mtdef\f[R] : optional, input, integer(int32), default = 1
1 (default): Calculate the multitaper spectral estimates Sgt, Sgg and
Stt first, and then use these to calculate the admittance and
correlation functions.
2: Calculate admittance and correlation spectra using each individual
taper, and then average these to obtain the multitaper admittance and
correlation functions.
.TP
\f[V]taper_wt\f[R] : input, optional, real(dp), dimension (\f[V]k\f[R])
The weights to apply to each individual windowed spectral estimate.
The weights must sum to unity and are obtained from
\f[V]SHMTVarOpt\f[R].
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
Given the global cross-power spectra \f[V]Sgt\f[R], \f[V]Sgg\f[R] and
\f[V]Stt\f[R] of two functions \f[V]G\f[R] and \f[V]T\f[R],
\f[V]SHBiasAdmitCorr\f[R] will calculate the expected multitaper
admittance and correlation spectra associated with the two global
functions.
This routine expects as input a matrix containing the spherical harmonic
coefficients of the localizing windows, which can be generated by a call
to \f[V]SHReturnTapers\f[R] or \f[V]SHReturnTapersM\f[R].
Only the \f[V]k\f[R] best-concentrated localization windows will be
employed when calculating the biased cross-power spectra.
The maximum calculated degree of the output biased admittance and
correlation spectra corresponds to \f[V]lmax-lwin\f[R], as it is assumed
that the input cross-power spectra beyond \f[V]lmax\f[R] are unknown,
and not zero.
.PP
Two manners of calculating the localized admittance and correlation
spectra are possible according to the value of the optional parameter
\f[V]mtdef\f[R].
In case 1, the multitaper cross-power spectra of Sgt, Sgg, and Stt are
first calculated, and from these, the admittance and correlation spectra
are formed.
In case 2, the biased admittance and correlation spectra are calculated
for each individual taper, and these are then averaged to obtain the
biased multitaper admittance and correlation spectra.
.PP
The default is to apply equal weights to each individual windowed
estimate of the spectrum, but this can be modified when \f[V]mtdef\f[R]
is 1 by specifying the weights in the optional argument
\f[V]taper_wt\f[R].
The weights must sum to unity and can be calculated by
\f[V]SHMTVarOpt\f[R].
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, doi:10.1007/s00041-006-6904-1, 665-692, 2007.
.PP
Simons, F.
J., F.
A.
Dahlen and M.
A.
Wieczorek, Spatiospectral concentration on the sphere, SIAM Review, 48,
504-536, doi:10.1137/S0036144504445765, 2006.
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Localized spectral analysis on the sphere, Geophys.
J.
Int., 162, 655-675.
.SH See also
.PP
shbias, shbiask, shreturntapers, shreturntapersm, shmtvaropt
