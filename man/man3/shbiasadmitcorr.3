.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shbiasadmitcorr" "1" "2024\-07\-09" "Fortran 95" "SHTOOLS 4.14"
.SH SHBiasAdmitCorr
Calculate the expected multitaper admittance and correlation spectra
associated with the input global cross\-power spectra of two functions.
.SH Usage
call SHBiasAdmitCorr (\f[CR]sgt\f[R], \f[CR]sgg\f[R], \f[CR]stt\f[R],
\f[CR]lmax\f[R], \f[CR]tapers\f[R], \f[CR]lwin\f[R], \f[CR]k\f[R],
\f[CR]admit\f[R], \f[CR]corr\f[R], \f[CR]mtdef\f[R],
\f[CR]taper_wt\f[R], \f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]sgt\f[R] : input, real(dp), dimension (\f[CR]lmax\f[R]+1)
The global cross\-power spectrum of the functions \f[CR]G\f[R] and
\f[CR]T\f[R].
.TP
\f[CR]sgg\f[R] : input, real(dp), dimension (\f[CR]lmax\f[R]+1)
The global power spectrum of the function \f[CR]G\f[R].
.TP
\f[CR]stt\f[R] : input, real(dp), dimension (\f[CR]lmax\f[R]+1)
The global power spectrum of the function \f[CR]T\f[R].
.TP
\f[CR]lmax\f[R] : input, integer(int32)
The maximum spherical harmonic degree to use of the input spectra
\f[CR]sgt\f[R], \f[CR]sgg\f[R], \f[CR]stt\f[R].
.TP
\f[CR]tapers\f[R] : input, real(dp), dimension (\f[CR]lwin\f[R]+1, \f[CR]k\f[R])
The spherical harmonic coefficients of the spherical cap localizing
windows.
Each column corresponds to the non\-zero coefficients of a single
angular order.
Since all that is important is the power spectrum of each window, the
exact angular order is not important.
These are generated by a call to \f[CR]SHReturnTapers\f[R] or
\f[CR]SHReturnTapersM\f[R].
.TP
\f[CR]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing windows.
.TP
\f[CR]k\f[R] : input, integer(int32)
The number of localizing windows to use.
Only the first \f[CR]k\f[R] columns of \f[CR]tapers\f[R] will be
employed, which corresponds to the \f[CR]k\f[R] best\-concentrated
localizing windows.
.TP
\f[CR]admit\f[R] : output, real(dp), dimension (\f[CR]lmax\f[R]\-\f[CR]lwin\f[R]+1)
The biased admittance spectrum obtained using the localized
(cross\-)power spectra of Sgt and Stt.
.TP
\f[CR]corr\f[R] : output, real(dp), dimension (\f[CR]lmax\f[R]\-\f[CR]lwin\f[R]+1)
The biased correlation spectrum obtained using the localized
(cross\-)power spectra of Sgt, Stt, and Sgg.
.TP
\f[CR]mtdef\f[R] : optional, input, integer(int32), default = 1
1 (default): Calculate the multitaper spectral estimates Sgt, Sgg and
Stt first, and then use these to calculate the admittance and
correlation functions.
2: Calculate admittance and correlation spectra using each individual
taper, and then average these to obtain the multitaper admittance and
correlation functions.
.TP
\f[CR]taper_wt\f[R] : input, optional, real(dp), dimension (\f[CR]k\f[R])
The weights to apply to each individual windowed spectral estimate.
The weights must sum to unity and are obtained from
\f[CR]SHMTVarOpt\f[R].
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
Given the global cross\-power spectra \f[CR]Sgt\f[R], \f[CR]Sgg\f[R] and
\f[CR]Stt\f[R] of two functions \f[CR]G\f[R] and \f[CR]T\f[R],
\f[CR]SHBiasAdmitCorr\f[R] will calculate the expected multitaper
admittance and correlation spectra associated with the two global
functions.
This routine expects as input a matrix containing the spherical harmonic
coefficients of the localizing windows, which can be generated by a call
to \f[CR]SHReturnTapers\f[R] or \f[CR]SHReturnTapersM\f[R].
Only the \f[CR]k\f[R] best\-concentrated localization windows will be
employed when calculating the biased cross\-power spectra.
The maximum calculated degree of the output biased admittance and
correlation spectra corresponds to \f[CR]lmax\-lwin\f[R], as it is
assumed that the input cross\-power spectra beyond \f[CR]lmax\f[R] are
unknown, and not zero.
.PP
Two manners of calculating the localized admittance and correlation
spectra are possible according to the value of the optional parameter
\f[CR]mtdef\f[R].
In case 1, the multitaper cross\-power spectra of Sgt, Sgg, and Stt are
first calculated, and from these, the admittance and correlation spectra
are formed.
In case 2, the biased admittance and correlation spectra are calculated
for each individual taper, and these are then averaged to obtain the
biased multitaper admittance and correlation spectra.
.PP
The default is to apply equal weights to each individual windowed
estimate of the spectrum, but this can be modified when \f[CR]mtdef\f[R]
is 1 by specifying the weights in the optional argument
\f[CR]taper_wt\f[R].
The weights must sum to unity and can be calculated by
\f[CR]SHMTVarOpt\f[R].
.SH References
Wieczorek, M. A. and F. J. Simons, Minimum\-variance multitaper spectral
estimation on the sphere, J. Fourier Anal.
Appl., 13, doi:10.1007/s00041\-006\-6904\-1, 665\-692, 2007.
.PP
Simons, F. J., F. A. Dahlen and M. A. Wieczorek, Spatiospectral
concentration on the sphere, SIAM Review, 48, 504\-536,
doi:10.1137/S0036144504445765, 2006.
.PP
Wieczorek, M. A. and F. J. Simons, Localized spectral analysis on the
sphere, Geophys.
J. Int., 162, 655\-675.
.SH See also
shbias, shbiask, shreturntapers, shreturntapersm, shmtvaropt
