.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "computedmap" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.12"
.hy
.SH ComputeDMap
.PP
Compute the space-concentration kernel of an arbitrary mask on the
sphere.
.SH Usage
.PP
call ComputeDMap (\f[V]dij\f[R], \f[V]dh_mask\f[R], \f[V]n\f[R],
\f[V]lmax\f[R], \f[V]sampling\f[R], \f[V]degrees\f[R],
\f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]dij\f[R] : output, real(dp), dimension ( (\f[V]lmax\f[R]+1)**2, (\f[V]lmax\f[R]+1)**2 )
The space-concentration kernel corresponding to the mask dh_mask.
.TP
\f[V]dh_mask\f[R] : input, integer(int32), dimension (\f[V]n\f[R], \f[V]sampling\f[R]*\f[V]n\f[R])
A Driscoll and Healy (1994) sampled grid describing the concentration
region R.
All elements should either be 1 (for inside the concentration region) or
0 (for outside R).
.TP
\f[V]n\f[R] : input, integer(int32)
The number of latitudinal samples in \f[V]dh_mask\f[R].
The effective spherical harmonic bandwidth of this grid is
\f[V]L=n/2-1\f[R].
.TP
\f[V]lmax\f[R] : input, integer(int32)
The maximum spherical harmonic degree of the matrix \f[V]dij\f[R].
.TP
\f[V]sampling\f[R] : input, optional, integer(int32), default = 1
For 1 (default), \f[V]dh_mask\f[R] has \f[V]n\f[R] x \f[V]n\f[R]
samples.
For 2, \f[V]dh_mask\f[R] has \f[V]n\f[R] x \f[V]2n\f[R] samples.
.TP
\f[V]degrees\f[R] : input, integer(int32), optional, dimension (\f[V]lmax\f[R]+1)
List of degrees to compute.
If degrees(l+1) is 0, do not compute degree l of the kernel.
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[V]ComputeDMap\f[R] will calculate the space-concentration kernel for
a generic mask defined on the sphere.
The input mask \f[V]dh_mask\f[R] must be sampled according to the
Driscoll and Healy (1994) sampling theorem with \f[V]n\f[R] samples in
latitude, and possess a value of 1 inside the concentration region, and
0 elsewhere.
\f[V]dh_mask\f[R] can either possess \f[V]n\f[R] samples in longitude
(\f[V]sampling=1\f[R]) or \f[V]2n\f[R] samples in longitude
(\f[V]sampling=2\f[R]).
Given the approximate way in which the elements of \f[V]dij\f[R] are
calculated (see below), \f[V]sampling=2\f[R] should be preferred.
\f[V]dij\f[R] is symmetric, and the elements are ordered according to
the scheme described in \f[V]YilmIndexVector\f[R].
See Simons et al.\ (2006) for further details.
If the optional vector \f[V]degrees\f[R] is specified, then the matrix
will be computed only for elements where \f[V]degrees(l+1)\f[R] is not
zero.
.PP
The elements of DIJ are explicitly given by
.PP
\f[V]Dlm,l\[aq]m\[aq] = 1/(4pi) Integral_R Ylm Yl\[aq]m\[aq] dOmega\f[R],
.PP
where \f[V]R\f[R] is the concentration region.
In this routine, all values of \f[V]l\[aq]m\[aq]\f[R] are calculated in
a single spherical harmonic transform for a given value of \f[V]lm\f[R]
according to
.PP
\f[V]Dl\[aq]m\[aq] = 1/(4pi) Integral_Omega F Yl\[aq]m\[aq] dOmega\f[R].
.PP
where
.PP
\f[V]F = Ylm dh_mask\f[R].
.PP
The function \f[V]F\f[R] is in general not a polynomial, and thus the
coefficients \f[V]Dl\[aq]m\[aq]\f[R] should not be expected to be exact.
For this reason, the effective spherical harmonic degree of the input
mask (\f[V]L=n/2-1\f[R]) should be greater than \f[V]lmax\f[R].
The exact value of \f[V]n\f[R] should be chosen such that further
increases in \f[V]n\f[R] do not alter the returned eigenvalues.
The routine prints out the fractional area of the mask computed in the
pixel domain divided by \f[V]D(1,1)\f[R] (the fractional area computed
by the spherical harmonic transforms), and the ratio of the two should
be close to 1.
Experience suggests that \f[V]l\f[R] should be about 5 times
\f[V]lmax\f[R].
.SH References
.PP
Driscoll, J.R.
and D.M.
Healy, Computing Fourier transforms and convolutions on the 2-sphere,
Adv.
Appl.
Math., 15, 202-250, 1994.
.PP
Simons, F.J., F.A.
Dahlen, and M.A.\ Wieczorek, Spatiospectral concentration on a sphere,
SIAM Review, 48, 504-536, 2006.
.SH See also
.PP
shreturntapersmap, yilmindexvector
