.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "computedmap" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH ComputeDMap
Compute the space\-concentration kernel of an arbitrary mask on the
sphere.
.SH Usage
call ComputeDMap (\f[CR]dij\f[R], \f[CR]dh_mask\f[R], \f[CR]n\f[R],
\f[CR]lmax\f[R], \f[CR]sampling\f[R], \f[CR]degrees\f[R],
\f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]dij\f[R] : output, real(dp), dimension ( (\f[CR]lmax\f[R]+1)**2, (\f[CR]lmax\f[R]+1)**2 )
The space\-concentration kernel corresponding to the mask dh_mask.
.TP
\f[CR]dh_mask\f[R] : input, integer(int32), dimension (\f[CR]n\f[R], \f[CR]sampling\f[R]*\f[CR]n\f[R])
A Driscoll and Healy (1994) sampled grid describing the concentration
region R. All elements should either be 1 (for inside the concentration
region) or 0 (for outside R).
.TP
\f[CR]n\f[R] : input, integer(int32)
The number of latitudinal samples in \f[CR]dh_mask\f[R].
The effective spherical harmonic bandwidth of this grid is
\f[CR]L=n/2\-1\f[R].
.TP
\f[CR]lmax\f[R] : input, integer(int32)
The maximum spherical harmonic degree of the matrix \f[CR]dij\f[R].
.TP
\f[CR]sampling\f[R] : input, optional, integer(int32), default = 1
For 1 (default), \f[CR]dh_mask\f[R] has \f[CR]n\f[R] x \f[CR]n\f[R]
samples.
For 2, \f[CR]dh_mask\f[R] has \f[CR]n\f[R] x \f[CR]2n\f[R] samples.
.TP
\f[CR]degrees\f[R] : input, integer(int32), optional, dimension (\f[CR]lmax\f[R]+1)
List of degrees to compute.
If degrees(l+1) is 0, do not compute degree l of the kernel.
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]ComputeDMap\f[R] will calculate the space\-concentration kernel
for a generic mask defined on the sphere.
The input mask \f[CR]dh_mask\f[R] must be sampled according to the
Driscoll and Healy (1994) sampling theorem with \f[CR]n\f[R] samples in
latitude, and possess a value of 1 inside the concentration region, and
0 elsewhere.
\f[CR]dh_mask\f[R] can either possess \f[CR]n\f[R] samples in longitude
(\f[CR]sampling=1\f[R]) or \f[CR]2n\f[R] samples in longitude
(\f[CR]sampling=2\f[R]).
Given the approximate way in which the elements of \f[CR]dij\f[R] are
calculated (see below), \f[CR]sampling=2\f[R] should be preferred.
\f[CR]dij\f[R] is symmetric, and the elements are ordered according to
the scheme described in \f[CR]YilmIndexVector\f[R].
See Simons et al.\ (2006) for further details.
If the optional vector \f[CR]degrees\f[R] is specified, then the matrix
will be computed only for elements where \f[CR]degrees(l+1)\f[R] is not
zero.
.PP
The elements of DIJ are explicitly given by
.PP
\f[CR]Dlm,l\(aqm\(aq = 1/(4pi) Integral_R Ylm Yl\(aqm\(aq dOmega\f[R],
.PP
where \f[CR]R\f[R] is the concentration region.
In this routine, all values of \f[CR]l\(aqm\(aq\f[R] are calculated in a
single spherical harmonic transform for a given value of \f[CR]lm\f[R]
according to
.PP
\f[CR]Dl\(aqm\(aq = 1/(4pi) Integral_Omega F Yl\(aqm\(aq dOmega\f[R].
.PP
where
.PP
\f[CR]F = Ylm dh_mask\f[R].
.PP
The function \f[CR]F\f[R] is in general not a polynomial, and thus the
coefficients \f[CR]Dl\(aqm\(aq\f[R] should not be expected to be exact.
For this reason, the effective spherical harmonic degree of the input
mask (\f[CR]L=n/2\-1\f[R]) should be greater than \f[CR]lmax\f[R].
The exact value of \f[CR]n\f[R] should be chosen such that further
increases in \f[CR]n\f[R] do not alter the returned eigenvalues.
The routine prints out the fractional area of the mask computed in the
pixel domain divided by \f[CR]D(1,1)\f[R] (the fractional area computed
by the spherical harmonic transforms), and the ratio of the two should
be close to 1.
Experience suggests that \f[CR]l\f[R] should be about 5 times
\f[CR]lmax\f[R].
.SH References
Driscoll, J.R.
and D.M.
Healy, Computing Fourier transforms and convolutions on the 2\-sphere,
Adv.
Appl.
Math., 15, 202\-250, 1994.
.PP
Simons, F.J., F.A.
Dahlen, and M.A.\ Wieczorek, Spatiospectral concentration on a sphere,
SIAM Review, 48, 504\-536, 2006.
.SH See also
shreturntapersmap, yilmindexvector
