.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shbias" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH SHBias
Calculate the (cross\-)power spectrum expectation of a windowed function
from its global spectrum.
.SH Usage
call SHBias (\f[CR]shh\f[R], \f[CR]lwin\f[R], \f[CR]incspectra\f[R],
\f[CR]ldata\f[R], \f[CR]outcspectra\f[R], \f[CR]save_cg\f[R],
\f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]shh\f[R] : input, real(dp), dimension (\f[CR]lwin\f[R]+1)
The power spectrum of the localizing window.
.TP
\f[CR]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing window.
.TP
\f[CR]incspectra\f[R] : input, real(dp), dimension (\f[CR]ldata\f[R]+1)
The global unwindowed (cross\-)power spectrum.
.TP
\f[CR]ldata\f[R] : input, integer(int32)
The maximum degree of the global unwindowed power spectrum.
.TP
\f[CR]outcspectra\f[R] : output, real(dp), dimension (\f[CR]ldata\f[R]+\f[CR]lwin\f[R]+1)
The expectation of the localized (cross\-)power spectrum.
.TP
\f[CR]save_cg\f[R] : optional, input, integer(int32), default = 0
If set equal to 1, the Clebsch\-Gordon coefficients will be precomputed
and saved for future use (if \f[CR]lwin\f[R] or \f[CR]ldata\f[R] change,
this will be recomputed).
To deallocate the saved memory, set this parameter equal to \-1.
If set equal to 0 (default), the Clebsch\-Gordon coefficients will be
recomputed for each call.
.TP
\f[CR]exitstatus\f[R] : output, optional(int32), integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]SHBias\f[R] will calculate the (cross\-)power spectrum expectation
of a function multiplied by a localizing window.
This is given by equation 35 of Wieczorek and Simons (2005) and equation
2.11 of Wieczorek and Simons (2007),
.PP
\f[CR]<SFG> = Sum_{j=0}\(haL Shh Sum_{i=|l\-j|}\(ha{|l+j|} Sfg (C_{j0i0}\(ha{l0})\(ha2\f[R]
.PP
where \f[CR]<SFG>\f[R] is the expectation of the localized
(cross\-)power spectrum, \f[CR]Shh\f[R] is the power spectrum of the
window bandlimited to degree \f[CR]L\f[R], \f[CR]Sfg\f[R] is the global
unwindowed (cross\-)power spectrum, and \f[CR]C\f[R] is a
Clebsch\-Gordan coefficient.
The Clebsch\-Gordan coefficients are calculated using a simple
relationship to the Wigner 3\-j symbols.
The maximum calculated degree of the windowed power spectrum expectation
corresponds to the smaller of (\f[CR]ldata+lwin\f[R]) and
\f[CR]size(outcspectra)\-1\f[R].
It is implicitly assumed that the power spectrum of
\f[CR]inspectrum\f[R] is zero beyond degree \f[CR]ldata.\f[R].
If this is not the case, the ouput power spectrum should be considered
valid only for the degrees up to and including \f[CR]ldata\f[R] \-
\f[CR]lwin\f[R].
.PP
If this routine is to be called several times using the same values of
\f[CR]lwin\f[R] and \f[CR]ldata\f[R], then the Clebsch\-Gordon
coefficients can be precomputed and saved by setting the optional
parameter \f[CR]save_cg\f[R] equal to 1.
To deallocate the saved memory, which is a matrix of size
(\f[CR]lwin+ldata,lwin,2*lwin+ldata+1\f[R]), set \f[CR]save_cg\f[R]
equal to \-1.
.SH References
Wieczorek, M. A. and F. J. Simons, Localized spectral analysis on the
sphere, Geophys.
J. Int., 162, 655\-675, doi:10.1111/j.1365\-246X.2005.02687.x, 2005.
.PP
Wieczorek, M. A. and F. J. Simons, Minimum\-variance multitaper spectral
estimation on a sphere, J. Fourier Anal.
Appl., 13, 665\-692, doi:10.1007/s00041\-006\-6904\-1, 2007.
.SH See also
shpowerspectrum,shcrosspowerspectrum, wigner3j, shreturntapers,
shreturntapersm, shbiasadmitcorr
