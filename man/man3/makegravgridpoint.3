.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "makegravgridpoint" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.12"
.hy
.SH MakeGravGridPoint
.PP
Determine the three components of the gravity vector at a single point.
.SH Usage
.PP
\f[V]value\f[R] = MakeGravGridPoint (\f[V]cilm\f[R], \f[V]lmax\f[R],
\f[V]gm\f[R], \f[V]r0\f[R], \f[V]r\f[R], \f[V]lat\f[R], \f[V]lon\f[R],
\f[V]omega\f[R], \f[V]dealloc\f[R])
.SH Parameters
.TP
\f[V]value\f[R] : output, real(dp), dimension (3)
Vector components (r, theta, phi) of the gravity at (\f[V]r\f[R],
\f[V]lat\f[R], \f[V]lon\f[R]).
.TP
\f[V]cilm\f[R] : input, real(dp), dimension (2, \f[V]lmax\f[R]+1, \f[V]lmax\f[R]+1)
The real 4-pi normalized spherical harmonic coefficients of the
gravitational potential.
The coefficients \f[V]C1lm\f[R] and \f[V]C2lm\f[R] refer to the cosine
(\f[V]Clm\f[R]) and sine (\f[V]Slm\f[R]) coefficients, respectively,
with \f[V]Clm=cilm(1,l+1,m+1)\f[R] and \f[V]Slm=cilm(2,l+1,m+1)\f[R].
.TP
\f[V]lmax\f[R] : input, integer(int32)
The maximum spherical harmonic degree used in evaluating the function.
.TP
\f[V]gm\f[R] : input, real(dp)
The gravitational constant multiplied by the mass of the planet.
.TP
\f[V]r0\f[R]: input, real(dp)
The reference radius of the spherical harmonic coefficients.
.TP
\f[V]r\f[R]: input, real(dp)
The radius to evaluate the gravity field.
.TP
\f[V]lat\f[R] : input, real(dp)
The latitude of the point in degrees.
.TP
\f[V]lon\f[R] : input, real(dp)
The longitude of the point in degrees.
.TP
\f[V]omega\f[R] : optional, input, real(dp)
The angular rotation rate of the planet.
.TP
\f[V]dealloc\f[R] : input, optional, integer(int32), default = 0
0 (default) = Save variables used in the external Legendre function
calls.
(1) Deallocate this memory at the end of the funcion call.
.SH Description
.PP
\f[V]MakeGravGridPoint\f[R] will compute the three components of the
gravity vector (gravitational force + centrifugal force) at a single
point.
The input latitude and longitude are in degrees, and the output
components of the gravity are in spherical coordinates (r, theta, phi).
The gravitational potential is given by
.PP
\f[V]V = GM/r Sum_{l=0}\[ha]lmax (r0/r)\[ha]l Sum_{m=-l}\[ha]l C_{lm} Y_{lm}\f[R],
.PP
and the gravitational acceleration is
.PP
\f[V]B = Grad V\f[R].
.PP
The coefficients are referenced to a radius \f[V]r0\f[R], and the output
accelerations are in m/s\[ha]2.
To convert m/s\[ha]2 to mGals, multiply by 10\[ha]5.
If the optional angular rotation rate \f[V]omega\f[R] is specified, the
gravity vector will be calculated in a body-fixed rotating reference
frame and will include the contribution of the centrifugal force.
.SH See also
.PP
makegeoidgrid, makegravgradgriddh, normalgravity
