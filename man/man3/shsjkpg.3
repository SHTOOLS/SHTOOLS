.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "shsjkpg" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.11"
.hy
.SH SHSjkPG
.PP
Calculate the expectation of the product of two functions, each
multiplied by a different data taper, for a given spherical harmonic
degree and two different angular orders.
.SH Usage
.PP
\f[V]value\f[R] = SHSjkPG (\f[V]incspectra\f[R], \f[V]l\f[R],
\f[V]m\f[R], \f[V]mprime\f[R], \f[V]hj_real\f[R], \f[V]hk_real\f[R],
\f[V]mj\f[R], \f[V]mk\f[R], \f[V]lwin\f[R], \f[V]hkcc\f[R])
.SH Parameters
.TP
\f[V]value\f[R] : output, complex(dp)
The expectation of the product of two functions, each multiplied by a
different data taper, for a given spherical harmonic degree and two
different angular orders.
.TP
\f[V]incspectra\f[R] : input, real(dp), dimension (\f[V]l\f[R]+\f[V]lwin\f[R]+1)
The global cross-power spectrum of \f[V]f\f[R] and \f[V]g\f[R].
.TP
\f[V]l\f[R] : input, integer(int32)
The spherical harmonic degree for which to calculate the expectation.
.TP
\f[V]m\f[R] : input, integer(int32)
The angular order of the first localized function, \f[V]Phi\f[R].
.TP
\f[V]mprime\f[R] : input, integer(int32)
The angular order of the second localized function, \f[V]Gamma\f[R].
.TP
\f[V]hj_real\f[R] : input, real(dp), dimension (\f[V]lwin\f[R]+1)
The real spherical harmonic coefficients of angular order \f[V]mj\f[R]
used to localize the first function \f[V]f\f[R].
These are obtained by a call to \f[V]SHReturnTapers\f[R].
.TP
\f[V]hk_real\f[R] : input, real(dp), dimension (\f[V]lwin\f[R]+1)
The real spherical harmonic coefficients of angular order \f[V]mk\f[R]
used to localize the second function \f[V]g\f[R].
These are obtained by a call to \f[V]SHReturnTapers\f[R].
.TP
\f[V]mj\f[R] : input, integer(int32)
The angular order of the window coefficients \f[V]hj_real\f[R].
.TP
\f[V]mk\f[R] : input, integer(int32)
The angular order of the window coefficients \f[V]hk_real\f[R].
.TP
\f[V]lwin\f[R] : input, integer(int32)
the spherical harmonic bandwidth of the localizing windows
\f[V]hj_real\f[R] and \f[V]hk_real\f[R].
.TP
\f[V]hkcc\f[R] : input, integer(int32)
If 1, the function described in the \f[V]description\f[R] will be
calculated as is.
If 2, the second localized function \f[V]Gamma\f[R] will not have its
complex conjugate taken.
.SH Description
.PP
\f[V]SHSjkPG\f[R] will calculate the expectation of two functions
(\f[V]f\f[R] and \f[V]g\f[R]), each localized by a different data taper
that is a solution of the spherical cap concentration problem, for a
given spherical harmonic degree and two different angular orders.
As described in Wieczorek and Simons (2007), this is the function
.IP
.nf
\f[C]
  /    m(j)       mprime(k)* \[rs]
 |  Phi      Gamma            |
  \[rs]    l          l          /
\f[R]
.fi
.PP
The global cross-power spectrum of \f[V]f\f[R] and \f[V]g\f[R] is input
as \f[V]incspectra\f[R], and the real coefficients of the two data
tapers of angular order \f[V]mj\f[R] and \f[V]mk\f[R] (obtained by a
call to \f[V]SHReturnTapers\f[R]) are specified by \f[V]hj_real\f[R] and
\f[V]hk_real\f[R].
If \f[V]hkcc\f[R] is set to 1, then the above function is calculated as
is.
However, if this is set to 2, then the complex conjugate of the second
localized function is not taken.
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, doi:10.1007/s00041-006-6904-1, 665-692, 2007.
.SH See also
.PP
shreturntapers, shmtvaropt
