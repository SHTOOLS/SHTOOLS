.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shsjkpg" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH SHSjkPG
Calculate the expectation of the product of two functions, each
multiplied by a different data taper, for a given spherical harmonic
degree and two different angular orders.
.SH Usage
\f[CR]value\f[R] = SHSjkPG (\f[CR]incspectra\f[R], \f[CR]l\f[R],
\f[CR]m\f[R], \f[CR]mprime\f[R], \f[CR]hj_real\f[R], \f[CR]hk_real\f[R],
\f[CR]mj\f[R], \f[CR]mk\f[R], \f[CR]lwin\f[R], \f[CR]hkcc\f[R])
.SH Parameters
.TP
\f[CR]value\f[R] : output, complex(dp)
The expectation of the product of two functions, each multiplied by a
different data taper, for a given spherical harmonic degree and two
different angular orders.
.TP
\f[CR]incspectra\f[R] : input, real(dp), dimension (\f[CR]l\f[R]+\f[CR]lwin\f[R]+1)
The global cross\-power spectrum of \f[CR]f\f[R] and \f[CR]g\f[R].
.TP
\f[CR]l\f[R] : input, integer(int32)
The spherical harmonic degree for which to calculate the expectation.
.TP
\f[CR]m\f[R] : input, integer(int32)
The angular order of the first localized function, \f[CR]Phi\f[R].
.TP
\f[CR]mprime\f[R] : input, integer(int32)
The angular order of the second localized function, \f[CR]Gamma\f[R].
.TP
\f[CR]hj_real\f[R] : input, real(dp), dimension (\f[CR]lwin\f[R]+1)
The real spherical harmonic coefficients of angular order \f[CR]mj\f[R]
used to localize the first function \f[CR]f\f[R].
These are obtained by a call to \f[CR]SHReturnTapers\f[R].
.TP
\f[CR]hk_real\f[R] : input, real(dp), dimension (\f[CR]lwin\f[R]+1)
The real spherical harmonic coefficients of angular order \f[CR]mk\f[R]
used to localize the second function \f[CR]g\f[R].
These are obtained by a call to \f[CR]SHReturnTapers\f[R].
.TP
\f[CR]mj\f[R] : input, integer(int32)
The angular order of the window coefficients \f[CR]hj_real\f[R].
.TP
\f[CR]mk\f[R] : input, integer(int32)
The angular order of the window coefficients \f[CR]hk_real\f[R].
.TP
\f[CR]lwin\f[R] : input, integer(int32)
the spherical harmonic bandwidth of the localizing windows
\f[CR]hj_real\f[R] and \f[CR]hk_real\f[R].
.TP
\f[CR]hkcc\f[R] : input, integer(int32)
If 1, the function described in the \f[CR]description\f[R] will be
calculated as is.
If 2, the second localized function \f[CR]Gamma\f[R] will not have its
complex conjugate taken.
.SH Description
\f[CR]SHSjkPG\f[R] will calculate the expectation of two functions
(\f[CR]f\f[R] and \f[CR]g\f[R]), each localized by a different data
taper that is a solution of the spherical cap concentration problem, for
a given spherical harmonic degree and two different angular orders.
As described in Wieczorek and Simons (2007), this is the function
.IP
.EX
  /    m(j)       mprime(k)* \(rs
 |  Phi      Gamma            |
  \(rs    l          l          /
.EE
.PP
The global cross\-power spectrum of \f[CR]f\f[R] and \f[CR]g\f[R] is
input as \f[CR]incspectra\f[R], and the real coefficients of the two
data tapers of angular order \f[CR]mj\f[R] and \f[CR]mk\f[R] (obtained
by a call to \f[CR]SHReturnTapers\f[R]) are specified by
\f[CR]hj_real\f[R] and \f[CR]hk_real\f[R].
If \f[CR]hkcc\f[R] is set to 1, then the above function is calculated as
is.
However, if this is set to 2, then the complex conjugate of the second
localized function is not taken.
.SH References
Wieczorek, M. A. and F. J. Simons, Minimum\-variance multitaper spectral
estimation on the sphere, J. Fourier Anal.
Appl., 13, doi:10.1007/s00041\-006\-6904\-1, 665\-692, 2007.
.SH See also
shreturntapers, shmtvaropt
