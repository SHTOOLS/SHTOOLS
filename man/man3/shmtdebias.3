.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "shmtdebias" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.12"
.hy
.SH SHMTDebias
.PP
Invert for the global power spectrum given a multitaper spectrum
estimate formed with spherical cap localization windows.
.SH Usage
.PP
call SHMTDebias (\f[V]mtdebias\f[R], \f[V]mtspectra\f[R],
\f[V]lmax\f[R], \f[V]tapers\f[R], \f[V]lwin\f[R], \f[V]k\f[R],
\f[V]nl\f[R], \f[V]lmid\f[R], \f[V]n\f[R], \f[V]taper_wt\f[R],
\f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]mtdebias\f[R] : output, real(dp), dimension (2, ceiling((\f[V]lmax\f[R]+1)/\f[V]nl\f[R]))
The global power spectrum (column 1) and uncertainty (column 2).
The midpoints of the N spherical harmonic bins are given in
\f[V]lmid\f[R].
.TP
\f[V]mtspectra\f[R] : input, real(dp), dimension (2, \f[V]lmax\f[R]+1)
The localized multitaper spectrum estimate and uncertainty, obtained
from a routine such as \f[V]SHMultitaperCSE\f[R] or
\f[V]SHMultitaperSE\f[R].
.TP
\f[V]lmax\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localized multitaper spectrum
estimates.
.TP
\f[V]tapers\f[R] : input, real(dp), dimension (\f[V]lmaxt\f[R]+1, \f[V]k\f[R])
An array of the K windowing functions, arranged in columns, obtained
from a call to \f[V]SHReturnTapers\f[R].
.TP
\f[V]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the windowing functions in the array
\f[V]tapers\f[R].
.TP
\f[V]k\f[R] : input, integer(int32)
The number of tapers utilized in the multitaper spectral analysis.
.TP
\f[V]nl\f[R] : input, integer(int32)
The global power spectrum is assumed to be constant within bins of
spherical harmonic wdith \f[V]nl\f[R].
In addition, the global power spectrum will be assumed to be constant
beyond \f[V]lmax\f[R].
.TP
\f[V]lmid\f[R] : output, real(dp), dimension ((\f[V]lmax\f[R]+1)/\f[V]nl\f[R]+1)
The midpoints of the spherical harmonic bins for which the global power
spectrum is constant.
.TP
\f[V]n\f[R] : output, integer(int32)
The number of bins used in \f[V]mtdebias\f[R] and \f[V]lmid\f[R].
.TP
\f[V]taper_wt\f[R] : input, optional, real(dp), dimension (\f[V]k\f[R])
The weights used in calculating the multitaper spectral estimates.
Optimal values of the weights (for a known global power spectrum) can be
obtained from the routine \f[V]SHMTVarOpt\f[R].
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[V]SHMTDebias\f[R] will invert for the global power spectrum given a
localized multitaper spectrum estimate formed from spherical cap
localization windows.
This linear inverse problem is inherently underdetermined, and in order
to achive a unique solution it is assumed that the global spectrum is
constant in bins of width \f[V]nl\f[R], and that the global power
spectrum is constant for degrees greater than \f[V]lmax\f[R].
In practice \f[V]nl\f[R] should be increased until the global power
spectrum is everywhere positive (negative values would be unphysical)
and the variances are reasonable.
Further details can be found in Wieczorek and Simons (2007).
.PP
This set of linear equations is solved using the method of singular
value decomposition as outlined in Press et al.\ (1992, pp.\ 670-672).
Each value of the multitaper spectrum estimate \f[V]mtspectra(1,:)\f[R],
as well as the corresponding rows of the transformation matrix, is
divided by the uncertainties of the estimate \f[V]mtspectra(2,:)\f[R].
The solution and uncertainty are given by eqs 15.4.17 and 15.4.19 of
Press et al.\ (1992, p.\ 671), respectively.
.PP
If \f[V]taper_wt\f[R] is not specified, the weights will all be assumed
to be equal to \f[V]1/K\f[R].
.SH References
.PP
Press, W.H., S.A.
Teukolsky, W.T.
Vetterling, and B.P.
Flannery, Numerical Recipes in FORTRAN: The Art of Scientific Computing,
2nd ed., Cambridge Univ.
Press, Cambridge, UK, 1992.
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, 665-692, doi:10.1007/s00041-006-6904-1, 2007.
.SH See also
.PP
shmultitaperse, shmultitapercse, shreturntapers, shmtvaropt,
shmtcouplingmatrix
