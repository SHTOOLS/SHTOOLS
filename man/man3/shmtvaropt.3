.\" Automatically generated by Pandoc 3.1.3
.\"
.\" Define V font for inline verbatim, using C font in formats
.\" that render this, and otherwise B font.
.ie "\f[CB]x\f[]"x" \{\
. ftr V B
. ftr VI BI
. ftr VB B
. ftr VBI BI
.\}
.el \{\
. ftr V CR
. ftr VI CI
. ftr VB CB
. ftr VBI CBI
.\}
.TH "shmtvaropt" "1" "2021-02-15" "Fortran 95" "SHTOOLS 4.12"
.hy
.SH SHMTVarOpt
.PP
Calculate the theoretical minimum variance of a localized multitaper
spectral estimate and the corresponding optimal weights to apply to each
localized spectrum.
.SH Usage
.PP
call SHMTVarOpt (\f[V]l\f[R], \f[V]tapers\f[R], \f[V]taper_order\f[R],
\f[V]lwin\f[R], \f[V]kmax\f[R], \f[V]sff\f[R], \f[V]var_opt\f[R],
\f[V]var_unit\f[R], \f[V]weight_opt\f[R], \f[V]unweighted_covar\f[R],
\f[V]nocross\f[R], \f[V]exitstatus\f[R])
.SH Parameters
.TP
\f[V]l\f[R] : input, integer
The spherical harmonic used degree to determine the minimum variance and
optimal weights.
.TP
\f[V]tapers\f[R] : input, real(dp), dimension (\f[V]lwin\f[R]+1, \f[V]kmax\f[R])
A matrix of localization functions obtained from
\f[V]SHReturnTapers\f[R] or \f[V]SHReturnTapersM\f[R].
.TP
\f[V]taper_order\f[R] : input, integer(int32), dimension (\f[V]kmax\f[R])
The angular order of the windowing coefficients in \f[V]tapers\f[R].
.TP
\f[V]lwin\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing windows.
.TP
\f[V]kmax\f[R] : input, integer(int32)
The maximum number of tapers to be used when calculating the minimum
variance and optimal weights.
.TP
\f[V]sff\f[R] : input, real(dp), dimension (\f[V]l\f[R]+\f[V]lwin\f[R]+1)
The global unwindowed power spectrum of the function to be localized.
.TP
\f[V]var_opt\f[R] : output, real(dp), dimension (\f[V]kmax\f[R])
The minimum variance of the multitaper spectral estimate for degree
\f[V]l\f[R] using 1 through \f[V]kmax\f[R] tapers.
.TP
\f[V]var_unit\f[R] : output, real(dp), dimension (\f[V]kmax\f[R])
The variance of the multitaper spectral estimate using equal weights for
degree \f[V]l\f[R] using 1 through \f[V]kmax\f[R] tapers.
.TP
\f[V]weight_opt\f[R] : optional, output, real(dp), dimension (\f[V]kmax\f[R], \f[V]kmax\f[R])
The optimal weights (in columns) that minimize the multitaper spectral
estimate\[cq]s variance using 1 through \f[V]kmax\f[R] tapers.
.TP
\f[V]unweighted_covar\f[R] : optional, output, real(dp), dimension (\f[V]kmax\f[R], \f[V]kmax\f[R])
The unweighted covariance matrix of the \f[V]kmax\f[R] tapers (i.e., Fij
in Wieczorek and Simons 2007).
.TP
\f[V]nocross\f[R] : optional, input, integer(int32), default = 0
If 1, only the diagonal terms of the covariance matrix Fij will be
computed.
If 0, all terms will be computed.
.TP
\f[V]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[V]SHMTVarOpt\f[R] will determine the minimum variance that can be
achieved by a weighted multitaper spectral analysis, as is described by
Wieczorek and Simons (2007).
The minimum variance is output as a function of the number of tapers
utilized, from 1 to a maximum of \f[V]kmax\f[R], and the corresponding
variance using equal weights is output for comparison.
The windowing functions are assumed to be solutions to the spherical-cap
concentration problem, as determined by a call to
\f[V]SHReturnTapers\f[R] or \f[V]SHReturnTapersM\f[R].
The minimum variance and weights are dependent upon the form of the
global unwindowed power spectrum, \f[V]Sff\f[R].
.PP
If the optional argument \f[V]weight_opt\f[R] is specified, then the
optimal weights will be returned as a function of the number of tapers
employed, from 1 to \f[V]kmax\f[R].
If \f[V]unweighted_covar\f[R] is specified, then the unweighted
covariance matrix of the \f[V]kmax\f[R] tapers (i.e., Fij) will be
output.
If the optional argument \f[V]nocross\f[R] is set to 1, then only the
diagnonal terms of \f[V]Fij\f[R] will be computed.
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, doi:10.1007/s00041-006-6904-1, 665-692, 2007.
.SH See also
.PP
shmtvar, shreturntapers, shreturntapersm, shmultitaperse,
shmultitapercse, shlocalizedadmitcorr, shbiasadmitcorr, shbiask,
shmtdebias
