.\" Automatically generated by Pandoc 3.8.2.1
.\"
.TH "shscouplingmatrix" "1" "2021\-02\-15" "Fortran 95" "SHTOOLS 4.14"
.SH SHSCouplingMatrix
This routine returns the spherical harmonic coupling matrix for a given
set of Slepian basis functions.
This matrix relates the power spectrum expectation of the function
expressed in a subset of the best\-localized Slepian functions to the
expectation of the global power spectrum.
.SH Usage
call SHSCouplingMatrix (\f[CR]kij\f[R], \f[CR]galpha\f[R],
\f[CR]lmax\f[R], \f[CR]nmax\f[R], \f[CR]exitstatus\f[R])
.SH Parameters
.TP
\f[CR]kij\f[R] : output, real(dp), dimension (\f[CR]lmax\f[R]+1, \f[CR]lmax\f[R]+1)
The coupling matrix that relates the power spectrum expectation of the
function expressed in a subset of the best\-localized Slepian functions
to the expectation of the global power spectrum.
.TP
\f[CR]galpha\f[R] : input, real(dp), dimension ((\f[CR]lmax\f[R]+1)**2, \f[CR]nmax\f[R])
An array of Slepian functions, arranged in columns from best to worst
localized.
.TP
\f[CR]lmax\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the Slepian functions.
.TP
\f[CR]nmax\f[R] : input, integer(int32)
The number of Slepian functions used in reconstructing the function.
.TP
\f[CR]exitstatus\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
\f[CR]SHSCouplingMatrix\f[R] returns the spherical harmonic coupling
matrix that relates the power spectrum expectation of the function
expressed in a subset of the best\-localized Slepian functions to the
expectation of the global power spectrum (assumed to be stationary).
The Slepian functions are determined by a call to either (1)
\f[CR]SHReturnTapers\f[R] and then \f[CR]SHRotateTapers\f[R], or (2)
\f[CR]SHReturnTapersMap\f[R].
Each row of \f[CR]galpha\f[R] contains the (\f[CR]lmax\f[R]+1)**2
spherical harmonic coefficients of a Slepian function that can be
unpacked using \f[CR]SHVectorToCilm\f[R].
The Slepian functions must be normalized to have unit power (that is the
sum of the coefficients squared is 1).
.PP
The relationship between the global and localized power spectra is given
by:
.PP
\f[CR]< S_{\(rstilde{f}}(l) > = \(rssum_{l\(aq=0}\(halmax K_{ll\(aq} S_{f}(l\(aq)\f[R]
.PP
where \f[CR]S_{\(rstilde{f}}\f[R] is the expectation of the power
spectrum at degree l of the function expressed in Slepian functions,
\f[CR]S_{f}(l\(aq)\f[R] is the expectation of the global power spectrum,
and \f[CR]< ... >\f[R] is the expectation operator.
The coupling matrix is given explicitly by
.PP
\f[CR]K_{ll\(aq} = \(rsfrac{1}{2l\(aq+1} Sum_{m=\-l}\(hal Sum_{m\(aq=\-l\(aq}\(hal\(aq ( Sum_{alpha=1}\(hanmax g_{l\(aqm\(aq}(alpha) g_{lm}(alpha) )**2\f[R]
.SH See also
shreturntapers, shrotatetapers, shreturntapersmap, shvectorrocilm,
shscouplingmatrixcap, shmtcouplingmatrix
