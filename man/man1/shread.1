.\" Automatically generated by Pandoc 2.10.1
.\"
.TH "shread" "1" "2020-10-14" "Fortran 95" "SHTOOLS 4.8"
.hy
.SH SHRead
.PP
Read spherical harmonic coefficients from an ascii-formatted file.
.SH Usage
.PP
call SHRead (\f[C]filename\f[R], \f[C]cilm\f[R], \f[C]lmax\f[R],
\f[C]skip\f[R], \f[C]header\f[R], \f[C]error\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]filename\f[B]\f[R] : input, character(:)
The filename of the ascii file containing the spherical harmonic
coefficients.
.TP
\f[B]\f[CB]cilm\f[B]\f[R] : output, real(dp), dimension (2, \f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1)
The spherical harmonic coefficients contained in \f[C]filename\f[R].
.TP
\f[B]\f[CB]lmax\f[B]\f[R] : output, integer(int32)
The maximum spherical harmonic degree of \f[C]cilm\f[R].
This is the minimum of the maximum spherical harmonic degree of
\f[C]filename\f[R] and the dimension of \f[C]cilm\f[R]-1.
.TP
\f[B]\f[CB]skip\f[B]\f[R] : input, optional, integer(int32)
The number of lines to skip before parsing \f[C]filename\f[R].
.TP
\f[B]\f[CB]header\f[B]\f[R] : output, optional, real(dp) dimension (\f[B]\f[CB]n\f[B]\f[R])
A vector containing the first \f[C]n\f[R] numbers in the first line of
the file (following any skipped lines).
.TP
\f[B]\f[CB]error\f[B]\f[R] : output, optional, real(dp) dimension (2, \f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1)
The errors corresponding to the spherical harmonic coefficients
\f[C]cilm\f[R].
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHRead\f[R] will read spherical harmonic coefficients from an
ascii-formatted file into an array \f[C]cilm\f[R].
The maximum spherical harmonic degree that is read is determined by the
minimum of the dimension of the input array \f[C]cilm\f[R]-1 and the
maximum degree of the coefficients in the file.
If the optional array \f[C]skip\f[R] is specified, parsing of the file
will commence after the first \f[C]skip\f[R] lines.
If the optional array \f[C]header\f[R] is specified, then the first
\f[C]n\f[R] elements after the skipped lines will be output, where
\f[C]n\f[R] is the length of the array \f[C]header\f[R].
.PP
The spherical harmonic coefficients in the file are assumed to be
ordered by increasing degree \f[C]l\f[R] and angular order \f[C]m\f[R]
according to the format
.PP
\f[C]l, m, cilm(1,l+1,m+1), cilm(2,l+1,m+1)\f[R]
.PP
The actual delimeters (commas, spaces, or tabs) are unimportant.
If the optional array \f[C]error\f[R] is specified, then the error for
each coefficient will be read according to the format
.PP
\f[C]l, m, cilm(1,l+1,m+1), cilm(2,l+1,m+1), error(1,l+1,m+1), error(2,l+1,m+1)\f[R]
.PP
The ordering of the file is explcitly given by
.PP
\f[C]l, 0 / l, 1 / l, 2 /l, ... / l, m / l+1, 0 / l+1, 1 / ...\f[R]
.PP
The first spherical harmonic degree of the filename does not have to be
0; this is determined from the first element after the \f[C]skip\f[R]
and \f[C]header\f[R] lines.
.SH See also
.PP
shread2, shreadjpl
