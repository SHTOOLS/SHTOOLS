.\" Automatically generated by Pandoc 2.1.3
.\"
.TH "pycilmplusrhohdh" "1" "2017\-11\-28" "Python" "SHTOOLS 4.2"
.hy
.SH CilmPlusRhoHDH
.PP
Calculate the gravitational potential exterior to relief with lateral
variations in density referenced to a spherical interface using the
finite\-amplitude algorithm of Wieczorek and Phillips (1998).
.SH Usage
.PP
\f[C]cilm\f[], \f[C]d\f[] = CilmPlusRhoHDH (\f[C]gridin\f[],
\f[C]rho\f[], \f[C]nmax\f[], \f[C]mass\f[], [\f[C]lmax\f[], \f[C]n\f[],
\f[C]dref\f[], \f[C]sampling\f[]])
.SH Returns
.TP
.B \f[C]cilm\f[] : float, dimension (2, \f[C]lmax\f[]+1, \f[C]lmax\f[]+1)
The real spherical harmonic coefficients (geodesy normalized) of the
gravitational potential corresponding to constant density relief
referenced to a spherical interface of radius \f[C]d\f[].
.RS
.RE
.TP
.B \f[C]d\f[] : float
The mean radius of the relief in meters.
.RS
.RE
.SH Parameters
.TP
.B \f[C]gridin\f[] : float, dimension (\f[C]nin\f[], \f[C]sampling\f[]*\f[C]nin\f[])
The radii of the interface evaluated on a grid, determined by a call to
\f[C]MakeGridDH\f[].
.RS
.RE
.TP
.B \f[C]rho\f[] : float, dimension (\f[C]nin\f[], \f[C]sampling\f[]*\f[C]nin\f[])
The density contrast of the relief in kg/m^3.
.RS
.RE
.TP
.B \f[C]nmax\f[] : integer
The maximum order used in the Taylor\-series expansion used in
calculating the potential coefficients.
.RS
.RE
.TP
.B \f[C]mass\f[] : float
The mass of the planet in kg.
.RS
.RE
.TP
.B \f[C]lmax\f[] : optional, integer, default = \f[C]n/2\-1\f[]
The maximum spherical harmonic degree of the output spherical harmonic
coefficients.
\f[C]lmax\f[] must be less than or equal to \f[C]n/2\-1\f[].
.RS
.RE
.TP
.B \f[C]n\f[] : optional, integer, default = \f[C]nin\f[]
The number of samples in latitude when using Driscoll\-Healy grids.
For a function bandlimited to \f[C]lmax\f[], \f[C]n=2(lmax+1)\f[].
.RS
.RE
.TP
.B \f[C]dref\f[] : optional, float
The reference radius to be used when calculating both the relief and
spherical harmonic coefficients.
If this is not specified, this parameter will be set equal to the mean
radius of \f[C]gridin\f[].
.RS
.RE
.TP
.B \f[C]sampling\f[] : optional, integer, default determined by dimensions of \f[C]gridin\f[]
If 1 the output grids are equally sampled (\f[C]n\f[] by \f[C]n\f[]).
If 2, the grids are equally spaced (\f[C]n\f[] by 2\f[C]n\f[]).
.RS
.RE
.SH Description
.PP
\f[C]CilmPlusRhoHDH\f[] will calculate the spherical harmonic
coefficients of the gravitational potential exterior to relief with
lateral variations in density referenced to a spherical interface.
This is equation 30 of Wieczorek (2007), which is based on the equation
10 of Wieczorek and Phillips (1998).
The potential is strictly valid only when the coefficients are evaluated
at a radius greater than the maximum radius of the relief.
The input relief \f[C]gridin\f[] must correspond to absolute radii.
The parameter \f[C]nmax\f[] is the order of the Taylor series used in
the algorithm to approximate the potential coefficients.
By default, the relief and spherical harmonic coefficients will be
referenced to the mean radius of \f[C]gridin\f[].
However, if the optional parameter \f[C]dref\f[] is specified, this will
be used instead as the reference radius.
.PP
It is important to understand that as an intermediate step, this routine
calculates the spherical harmonic coefficients of the density multiplied
by the relief (referenced to the mean radius of \f[C]gridin\f[] or
\f[C]dref\f[]) raised to the nth power.
As such, if the input function is bandlimited to degree \f[C]L\f[], the
resulting function will be bandlimited to degree \f[C]L*nmax\f[].
This subroutine implicitly assumes that the \f[C]gridin\f[] has an
effective spherical harmonic bandwidth greater or equal to this value.
(The effective bandwidth is equal to \f[C]n/2\-1\f[]) If this is not the
case, aliasing will occur.
In practice, for accurate results, it is found that the effective
bandwidth needs only to be about three times the size of \f[C]L\f[],
though this should be verified for each application.
Thus, if the input function is considered to be bandlimited to degree
\f[C]L\f[], the function should be evaluated on a grid corresponding to
a maximum degree of about \f[C]3*\f[]L.
.PP
This routine uses geodesy 4\-pi normalized spherical harmonics that
exclude the Condon\-Shortley phase.
.SH References
.PP
Wieczorek, M.
A.
and R.
J.
Phillips, Potential anomalies on a sphere: applications to the thickness
of the lunar crust, J.
Geophys.
Res., 103, 1715\-1724, 1998.
.PP
Wieczorek, M.
A., Gravity and topography of the terrestrial planets, Treatise on
Geophysics, 10, 165\-206, doi:10.1016/B978\-044452748\-6/00156\-5, 2007.
.SH See also
.PP
cilmplusdh, cilmminusdh, cilmminusrhohdh, makegriddh
