.\" Automatically generated by Pandoc 2.7.3
.\"
.TH "shlocalizedadmitcorr" "1" "2019-09-17" "Fortran 95" "SHTOOLS 4.5"
.hy
.SH SHLocalizedAdmitCorr
.PP
Calculate the localized admittance and correlation spectra of two
functions at a given location using spherical cap localization windows.
.SH Usage
.PP
call SHLocalizedAdmitCorr (\f[C]tapers\f[R], \f[C]taper_order\f[R],
\f[C]lwin\f[R], \f[C]lat\f[R], \f[C]lon\f[R], \f[C]gilm\f[R],
\f[C]tilm\f[R], \f[C]lmax\f[R], \f[C]admit\f[R], \f[C]corr\f[R],
\f[C]k\f[R], \f[C]admit_error\f[R], \f[C]corr_error\f[R],
\f[C]taper_wt\f[R], \f[C]mtdef\f[R], \f[C]k1linsig\f[R],
\f[C]exitstatus\f[R])
.SH Parameters
.TP
.B \f[C]tapers\f[R] : input, real(dp), dimension (\f[C]lwin\f[R]+1, \f[C]k\f[R])
A matrix of spherical cap localization functions obtained from
\f[C]SHReturnTapers\f[R] or \f[C]SHReturnTapersM\f[R].
.TP
.B \f[C]taper_order\f[R] : input, integer, dimension (\f[C]k\f[R])
The angular order of the windowing coefficients in \f[C]tapers\f[R].
.TP
.B \f[C]lwin\f[R] : input, integer
The spherical harmonic bandwidth of the localizing windows.
.TP
.B \f[C]lat\f[R] : input, real(dp)
The latitude of the localized analysis in degrees.
.TP
.B \f[C]lon\f[R] : input, real(dp)
The longitude of the localized analysis in degrees.
.TP
.B \f[C]gilm\f[R] : input, real(dp), dimension (2, \f[C]lmax\f[R]+1, \f[C]lmax\f[R]+1)
The spherical harmonic coefficients of the function G.
.TP
.B \f[C]tilm\f[R] : input, real(dp), dimension (2, \f[C]lmax\f[R]+1, \f[C]lmax\f[R]+1)
The spherical harmonic coefficients of the function T.
.TP
.B \f[C]lmax\f[R] : input, integer
The maximum spherical harmonic degree of the input functions
corresponding to \f[C]gilm\f[R] and \f[C]tilm\f[R].
.TP
.B \f[C]admit\f[R] : output, real(dp), dimension (\f[C]lmax\f[R]-\f[C]lwin\f[R]+1)
The admittance function, which is equal to \f[C]Sgt/Stt\f[R].
.TP
.B \f[C]corr\f[R] : output, real(dp), dimension (\f[C]lmax\f[R]-\f[C]lwin\f[R]+1)
The degree correlation function, which is equal to
\f[C]Sgt/sqrt(Sgg Stt)\f[R].
.TP
.B \f[C]k\f[R] : input, integer
The number of tapers to be used in the multitaper spectral analysis.
.TP
.B \f[C]admit_error\f[R] : output, optional, real(dp), dimension (\f[C]lmax\f[R]-\f[C]lwin\f[R]+1)
The standard error of the admittance function.
.TP
.B \f[C]corr_error\f[R] : output, optional, real(dp), dimension (\f[C]lmax\f[R]-\f[C]lwin\f[R]+1)
The standard error of the degree correlation function.
.TP
.B \f[C]taper_wt\f[R] : input, optional, real(dp), dimension (\f[C]k\f[R])
The weights to be applied to the spectral estimates when calculating the
admittance, correlation, and their associated errors.
This must sum to unity.
.TP
.B \f[C]mtdef\f[R] : input, optional, integer, default = 1
1 (default): Calculate the multitaper spectral estimates Sgt, Sgg and
Stt first, and then use these to calculate the admittance and
correlation functions.
2: Calculate admittance and correlation spectra using each individual
taper, and then average these to obtain the multitaper admittance and
correlation functions.
.TP
.B \f[C]k1linsig\f[R] : input, optional, integer
If equal to one, and only a single taper is being used, the errors in
the admittance function will be calculated by assuming that the
coefficients of \f[C]gilm\f[R] and \f[C]tilm\f[R] are related by a
linear degree-dependent transfer function and that the lack of
correlation is a result of uncorrelated noise.
This is the square root of eq.
33 of Simons et al.\ 1997.
.TP
.B \f[C]exitstatus\f[R] : output, optional, integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHLocalizedAdmitCorr\f[R] will calculate the localized admittance
and degree correlation spectra of two functions at a given location.
The windowing functions are solutions to the spherical-cap concentration
problem (as calculated by \f[C]SHReturnTapers\f[R] or
\f[C]SHReturnTapersM\f[R]), of which the best \f[C]k\f[R] concentrated
tapers are utilized.
If \f[C]k\f[R] is greater than 1, then estimates of the standard error
for the admittance and correlation will be returned in the optional
arrays \f[C]admit_error\f[R] and \f[C]corr_error\f[R].
The symmetry axis of the localizing windows are rotated to the
coordinates (\f[C]lat\f[R], \f[C]lon\f[R]) before performing the
windowing operation.
.PP
The admittance is defined as \f[C]Sgt/Stt\f[R], where \f[C]Sgt\f[R] is
the localized cross-power spectrum of two functions \f[C]G\f[R] and
\f[C]T\f[R] expressed in spherical harmonics.
The localized degree-correlation spectrum is defined as
\f[C]Sgt/sqrt(Sgg Stt)\f[R], which can possess values between -1 and 1.
Two methods are available for calculating the multitaper admittance and
correlation functions.
When \f[C]mtdef\f[R] is 1 (default), the multitaper estimates and errors
of Sgt, Stt, and Sgg are calculated by calls to \f[C]SHMultiTaperSE\f[R]
and \f[C]SHMultiTaperCSE\f[R], and these results are then used to
calculate the final admittance and correlation functions.
When \f[C]mtdef\f[R] is 2, the admitance and correlation are calculated
invidivually for each individual taper, and these results are then
averaged.
.PP
If the optional parameter \f[C]k1linsig\f[R] is specified, and only a
single taper is being used, the uncertainty in the admittance function
will be calculated by assuming the two sets of coefficients are related
by a linear degree-dependent transfer function and that the lack of
correlation is a result of uncorrelated noise.
.PP
When \f[C]mtdef\f[R] is 1, by default, the multitaper spectral estimates
are calculated as an unweighted average of the individual tapered
estimates.
However, if the optional argument \f[C]taper_wt\f[R] is specified, a
weighted average will be employed using the weights in this array.
Minimum variance optimal weights can be obtained from the routines
\f[C]SHMTVarOpt\f[R] if the form of the underlying global power spectrum
is known.
Taper weights can not be used when \f[C]mtdef\f[R] is 2
.PP
This routine assumes that the input functions and tapers are expressed
using geodesy 4-pi normalized spherical harmonic functions that exclude
the Condon-Shortley phase factor of (-1)\[ha]m.
.SH See also
.PP
shreturntapers, shreturntapersm, shmultitaperse, shmultitapercse
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, doi:10.1007/s00041-006-6904-1, 665-692, 2007.
.PP
Simons, F.
J., F.
A.
Dahlen and M.
A.
Wieczorek, Spatiospectral concentration on the sphere, SIAM Review, 48,
504-536, doi:10.1137/S0036144504445765, 2006.
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Localized spectral analysis on the sphere, Geophys.
J.
Int., 162, 655-675, 2005.
.PP
Simons, M., S.
C.
Solomon and B.
H.
Hager, Localization of gravity and topography: constrains on the
tectonics and mantle dynamics of Venus, Geophys.
J.
Int., 131, 24-44, 1997.
