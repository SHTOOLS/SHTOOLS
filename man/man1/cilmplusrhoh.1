.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "CILMPLUSRHOH 1"
.TH CILMPLUSRHOH 1 "2015-03-10" "SHTOOLS 3.0" "SHTOOLS 3.0"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "CilmPlusRhoH"
.IX Header "CilmPlusRhoH"
.IP "CilmPlusRhoH \-" 16
.IX Item "CilmPlusRhoH -"
Calculate the gravitational potential of relief referenced to a spherical interface with laterally varying density using the finite amplitude algorithm of Wieczorek (2007).
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.IP "\s-1SUBROUTINE\s0 CilmPlusRhoH (" 26
.IX Item "SUBROUTINE CilmPlusRhoH ("
\&\s-1CILM, GRIDIN, LMAX, NMAX, MASS, D, RHO, GRIDTYPE, W, ZERO, PLX, N, DREF \s0)
.RS 4
.IP "REAL*8" 18
.IX Item "REAL*8"
\&\s-1CILM\s0(2, \s-1LMAX+1, LMAX+1\s0), \s-1GRIDIN\s0(\s-1LMAX+1,\s0 2*LMAX+1), \s-1MASS, D, RHO\s0(\s-1LMAX+1,\s0 2*LMAX+1),
.IP "REAL*8, \s-1OPTIONAL\s0" 18
.IX Item "REAL*8, OPTIONAL"
W(\s-1LMAX+1\s0), \s-1ZERO\s0(\s-1LMAX+1\s0), \s-1PLX\s0(\s-1LMAX+1,\s0\ (\s-1LMAX+1\s0)*(\s-1LMAX+2\s0)/2), \s-1DREF\s0
.IP "\s-1INTEGER\s0" 18
.IX Item "INTEGER"
\&\s-1LMAX, NMAX, GRIDTYPE\s0
.IP "\s-1INTEGER, OPTIONAL\s0" 18
.IX Item "INTEGER, OPTIONAL"
N
.RE
.RS 4
.RE
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fICilmPlusRhoH\fR will calculate the spherical harmonic coefficients of the gravitational potential that correspond to relief referenced to a spherical interface with laterally varying density. This is equation 30 of Wieczorek (2007), which is based on the equation 10 of Wieczorek and Phillips (1998). The potential is strictly valid only when the coefficients are evaluated at a radius greater than the maximum radius of the relief. The relief and laterally varying density are input as a grid, whose type is specified by \s-1GRIDTYPE \s0(1 for Gauss-Legendre quadrature grids, 2 for NxN Driscoll and Healy sampled grids, and 3 for Nx2N Driscoll and Healy sampled grids). The input relief \s-1GRIDIN\s0 must correspond to absolute radii. The parameter \s-1NMAX\s0 is the order of the Taylor series used in the algorithm to approximate the potential coefficients. By default, the relief and spherical harmonic coefficients will be referenced to the mean radius of \s-1GRIDIN.\s0 However, if the optional parameter \s-1DREF\s0 is specified, this will be used instead as the reference radius.
.PP
It is important to understand that as an intermediate step, this routine calculates the spherical harmonic coefficients of the density multiplied by relief (referenced to the mean radius of \s-1GRIDIN\s0 or \s-1DREF\s0) raised to the nth power, i.e., RHO*(\s-1GRIDIN\-D\s0)**n. As such, if the input function is bandlimited to degree L, the resulting function will be bandlimited to degree L*NMAX. This subroutine implicitly assumes that the \s-1GRIDIN\s0 has an effective spherical harmonic bandwidth greater or equal to L*NMAX. (The effective bandwidth is equal to \s-1LMAX\s0 for GRIDIN=1, and is specified by N/2\-1 for GRIDIN=2 or 3.) If this is not the case, then aliasing will occur. In practice, for accurate results, it is found that the effective bandwidth needs only to be about three times the size of L, though this should be verified for each application. Thus, if the input function is considered to be bandlimited to degree L, the function should be evaluated on a grid corresponding to a maximum degree of about 3*L. Aliasing effects can be minimized by using Driscoll and Healy Nx2N grids.
.PP
If the input grid is evaluated on the Gauss-Legendre points, it is necessary to specify the optional parameters W and \s-1ZERO,\s0 or W and \s-1PLX,\s0 which are calculated by a call to \fIPreCompute\fR. In contast, if Driscoll-Healy grids are used (NxN or Nx2N), it is necessary to specify the optional parameter N.
.PP
If memory is not an issue, the algorithm can be speeded up considerably when using Gauss-Lengendre grids by inputing the optional array \s-1PLX \s0(along with W) of precomputed associated Legendre functions on the Gauss-Legendre nodes.  Both of these variables are computed by a call to \fIPreCompute\fR.
.SH "ARGUMENTS"
.IX Header "ARGUMENTS"
.IP "\s-1CILM \s0" 10
.IX Item "CILM "
(output) REAL*8, \s-1DIMENSION \s0(2, \s-1LMAX+1, LMAX+1\s0)
.Sp
The real spherical harmonic coefficients (geodesy normalized) of the gravitational potential corresponding to constant density relief referenced to a spherical interface of radius D.
.IP "\s-1GRIDIN\s0" 10
.IX Item "GRIDIN"
(input) REAL*8, \s-1DIMENSION \s0(\s-1LMAX+1,\s0 2*LMAX+1) for \s-1GRIDTYPE 1, DIMENSION \s0(N, N) for \s-1GRIDTYPE 2, DIMENSION \s0(N, 2*N) for \s-1GRIDTYPE 3\s0
.Sp
The radii of the interface evaluated on a grid corresponding to a function of maximum spherical harmonic degree \s-1LMAX.\s0 This is calculated by a call to either \fIMakeGridGLQ\fR or \fIMakeGridDH\fR.
.IP "\s-1LMAX\s0" 10
.IX Item "LMAX"
(input) \s-1INTEGER\s0
.Sp
The maximum spherical harmonic degree of the output spherical harmonic coefficients. This degree also determines the dimension of the input relief \s-1GRIDGLQ\s0 for \s-1GRIDTYPE 1. \s0(As a general rule, this should be about twice the spherical harmonic bandwidth of the input function.) For Driscoll-Healy grids, \s-1LMAX\s0 must be less than or equal to N/2 \- 1.
.IP "\s-1NMAX\s0" 10
.IX Item "NMAX"
(input) \s-1INTEGER\s0
.Sp
The maximum order used in the Taylor-series expansion used in calculating the potential coefficients. As a rule, this should be about 4.
.IP "\s-1MASS\s0" 10
.IX Item "MASS"
(input) REAL*8
.Sp
The mass of the planet in kg.
.IP "D" 10
.IX Item "D"
(output) REAL*8
.Sp
The mean radius of the relief in meters.
.IP "\s-1RHO\s0" 10
.IX Item "RHO"
(input) REAL*8, \s-1DIMENSION \s0(\s-1LMAX+1,\s0 2*LMAX+1) for \s-1GRIDTYPE 1, DIMENSION \s0(N, N) for \s-1GRIDTYPE 2, DIMENSION \s0(N, 2*N) for \s-1GRIDTYPE 3\s0
.Sp
The density contrast of the relief in kg/m^3 expressed on a grid with the same dimensions as \s-1GRIDIN.\s0
.IP "\s-1GRIDTYPE\s0" 10
.IX Item "GRIDTYPE"
(input) \s-1INTEGER\s0
.Sp
1 = Gauss-Legendre grids, calculated using \fIPreCompute\fR and \fIMakeGridGLQ\fR. 2 = Equally sampled Driscoll-Healy grids, NxN, calculated using \fIMakeGridDH\fR. 3 = Equally spaced Driscoll-Healy grids, Nx2N, calculated using \fIMakeGridDH\fR.
.IP "W" 10
.IX Item "W"
(input) REAL*8, \s-1OPTIONAL DIMENSION \s0(\s-1LMAX+1\s0)
.Sp
The weights used in the Gauss-Legendre quadrature, which are required for \s-1GRIDTYPE\s0 = 1. These are calculated from a call to \fIPreCompute\fR (or alternatively, \fIPreGLQ\fR).
.IP "\s-1ZERO\s0" 10
.IX Item "ZERO"
(input) REAL*8, \s-1OPTIONAL, DIMENSION \s0(\s-1LMAX+1\s0)
.Sp
The nodes used in the Gauss-Legendre quadrature over latitude for \s-1GRIDTYPE 1,\s0 calculated by a call to \fIPreCompute\fR. One of \s-1PLX\s0 or \s-1ZERO\s0 must be present when \s-1GRIDTYPE\s0 = 1, but not both.
.IP "\s-1PLX\s0" 10
.IX Item "PLX"
(input) REAL*8, \s-1OPTIONAL, DIMENSION \s0(\s-1LMAX+1, \s0(\s-1LMAX+1\s0)*(\s-1LMAX+2\s0)/2)
.Sp
An array of the associated Legendre functions calculated at the nodes used in the Gauss-Legendre quadrature for \s-1GRIDTYPE 1.\s0 These are determined from a call to \fIPreCompute\fR. One of \s-1PLX\s0 or \s-1ZERO\s0 must be present when \s-1GRIDTYPE\s0 = 1, but not both.
.IP "N" 10
.IX Item "N"
(input) \s-1INTEGER, OPTIONAL\s0
.Sp
The number of samples in latitude when using Driscoll-Healy grids. For a function bandlimited to \s-1LMAX, N\s0 = 2 (\s-1LMAX + 1\s0). This is required for \s-1GRIDTYPE\s0 = 2 and 3.
.IP "\s-1DREF\s0" 10
.IX Item "DREF"
(input) REAL*8, \s-1OPTIONAL\s0
.Sp
The reference radius to be used when calculating both the relief and spherical harmonic coefficients. If this is not specified, this parameter will be set equal to the mean radius of \s-1GRIDIN.\s0
.SH "NOTES"
.IX Header "NOTES"
This routine uses geodesy 4\-pi normalized spherical harmonics that exclude the Condon-Shortley phase; This can not be modified.
.PP
This routine requires the fast Fourier transform library \fI\s-1FFTW\s0\fR, which is available at <http://www.fftw.org>.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIcilmplus\fR\|(1), \fIshexpandglq\fR\|(1), \fImakegridglq\fR\|(1), \fIprecompute\fR\|(1), \fIpreglq\fR\|(1), \fIglqgridcoord\fR\|(1), \fImakegriddh\fR\|(1)
.PP
<http://shtools.ipgp.fr/>
.SH "REFERENCES"
.IX Header "REFERENCES"
Wieczorek, M. A. and R. J. Phillips, Potential anomalies on a sphere: applications to the thickness of the lunar crust, \fIJ. Geophys. Res.\fR, 103, 1715\-1724, 1998.
.PP
Wieczorek, M. A., Gravity and topography of the terrestrial planets, \fITreatise on Geophysics\fR, 10, 165\-206, doi:10.1016/B978\-044452748\-6/00156\-5, 2007.
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright 2012 by Mark Wieczorek <wieczor@ipgp.fr>.
.PP
This is free software; you can distribute and modify it under the terms of the revised \s-1BSD\s0 license.
