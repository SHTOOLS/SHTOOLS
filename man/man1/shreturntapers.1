.\" Automatically generated by Pandoc 2.5
.\"
.TH "shreturntapers" "1" "2019\-01\-08" "Fortran 95" "SHTOOLS 4.5"
.hy
.SH SHReturnTapers
.PP
Calculate the eigenfunctions of the spherical\-cap concentration
problem.
.SH Usage
.PP
call SHReturnTapers (\f[C]theta0\f[R], \f[C]lmax\f[R], \f[C]tapers\f[R],
\f[C]eigenvalues\f[R], \f[C]taper_order\f[R], \f[C]degrees\f[R],
\f[C]exitstatus\f[R])
.SH Parameters
.TP
.B \f[C]theta0\f[R] : input, real*8
The angular radius of the spherical cap in radians.
.TP
.B \f[C]lmax\f[R] : input, integer
The spherical harmonic bandwidth of the localization windows.
.TP
.B \f[C]tapers\f[R] : output, real*8, dimension (\f[C]lmax\f[R]+1, (\f[C]lmax\f[R]+1)**2)
The spherical harmonic coefficients of the \f[C](lmax+1)**2\f[R]
localization windows.
Each column contains the coefficients of a single window that possesses
non\-zero coefficients for the single angular order specified in
\f[C]taper_order\f[R].
The first and last rows of each column correspond to spherical harmonic
degrees 0 and \f[C]lmax\f[R], respectively, and the columns are arranged
from best to worst concentrated.
.TP
.B \f[C]eigenvalues\f[R] : output, real*8, dimension ((\f[C]lmax\f[R]+1)**2)
The concentration factors of the localization windows.
.TP
.B \f[C]taper_order\f[R] : output, integer, dimension ((\f[C]lmax\f[R]+1)**2)
The angular order of the non\-zero spherical harmonic coefficients in
each column of \f[C]tapers\f[R].
.TP
.B \f[C]degrees\f[R] : input, integer, optional, dimension (\f[C]lmax\f[R]+1)
List of degrees to use when computing the eigenfunctions.
Only those degrees where \f[C]degrees(l+1)\f[R] is non\-zero will be
employed.
.TP
.B \f[C]exitstatus\f[R] : output, optional, integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHReturnTapers\f[R] will calculate the eigenfunctions of the
spherical\-cap concentration problem.
Each column of the matrix \f[C]tapers\f[R] contains the spherical
harmonic coefficients of a single window and the corresponding
concentration factor is given in the array \f[C]eigenvalues\f[R].
Each window has non\-zero coefficients for only a single angular order
that is specified in \f[C]taper_order\f[R]: all other spherical harmonic
coefficients for a given window are identically zero.
The columns of \f[C]tapers\f[R] are ordered from best to worst
concentrated, and the first and last rows of each column correspond to
spherical harmonic degrees 0 and \f[C]lmax\f[R], respectively.
The localization windows are normalized such that they have unit power.
If the optional vector \f[C]degrees\f[R] is specified, then the
eigenfunctions will be computed using only those degrees where
\f[C]degrees(l+1)\f[R] is not zero.
.PP
When possible, the eigenfunctions are calculated using the kernel of
Grunbaum et al.\ 1982 and the eigenvalues are then calculated by
integration using the definition of the space\-concentration problem.
Use of the Grunbaum et al.\ kernel is prefered over the
space\-concentration kernel as the eigenfunctions of the later are
unreliable when there are several eigenvalues identical (within machine
precision) to either 1 or zero.
If, the optional parameter \f[C]degrees\f[R] is specified, and at least
one element is zero for degrees greater or equal to abs(m), then the
eigenfunctions and eigenvalues will instead be computed directly using
the space\-concentration kernel.
.SH References
.PP
Grunbaum, F.
A., L.
Longhi, and M.
Perlstadt, Differential operators commuting with finite convolution
integral operators: Some non\-abelian examples, SIAM, J.
Appl.
Math.
42, 941\[en]955, 1982.
.PP
Simons, F.
J., F.
A.
Dahlen, and M.
A.
Wieczorek, Spatiospectral concentration on a sphere, SIAM Review, 48,
504\-536, 2006.
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Localized spectral analysis on the sphere, Geophys.
J.
Int., 162, 655\-675, 2005.
.SH See also
.PP
shreturntapersm, computedg82, computedm
