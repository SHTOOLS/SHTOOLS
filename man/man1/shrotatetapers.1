.\" Automatically generated by Pandoc 2.10.1
.\"
.TH "shrotatetapers" "1" "2020-10-14" "Fortran 95" "SHTOOLS 4.8"
.hy
.SH SHRotateTapers
.PP
Rotate orthogonal spherical-cap Slepian functions centered at the North
pole to a different location.
.SH Usage
.PP
call SHRotateTapers(\f[C]tapersrot\f[R], \f[C]tapers\f[R],
\f[C]taper_order\f[R], \f[C]lmax\f[R], \f[C]nrot\f[R], \f[C]x\f[R],
\f[C]dj\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]tapersrot\f[B]\f[R] : output, real(dp), dimension ((\f[B]\f[CB]lmax\f[B]\f[R]+1)**2, \f[B]\f[CB]nrot\f[B]\f[R])
An array containing the spherical harmonic coefficients of the rotated
spherical-cap functions.
Each column corresponds to a single function of which the spherical
harmonic coefficients can be unpacked with \f[C]SHVectorToCilm\f[R].
.TP
\f[B]\f[CB]tapers\f[B]\f[R] : input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]nrot\f[B]\f[R])
An array containing the eigenfunctions of the spherical-cap
concentration problem obtained from \f[C]SHReturnTapers\f[R].
The functions are listed by columns, ordered from best to worst
concentrated.
.TP
\f[B]\f[CB]taper_order\f[B]\f[R] : input, integer(int32), dimension (\f[B]\f[CB]nrot\f[B]\f[R])
The angular order of the non-zero spherical harmonic coefficients in
each column of \f[C]tapers\f[R].
.TP
\f[B]\f[CB]lmax\f[B]\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the functions.
.TP
\f[B]\f[CB]nrot\f[B]\f[R] : input, integer(int32)
The number of functions to rotate, which must be less than or equal to
(\f[C]lmax\f[R]+1)**2.
.TP
\f[B]\f[CB]x\f[B]\f[R] : input, real(dp), dimension(3)
The three Euler angles, alpha, beta, and gamma, in radians.
.TP
\f[B]\f[CB]dj\f[B]\f[R] : input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1)
The rotation matrix \f[C]dj(pi/2)\f[R], obtained from a call to
\f[C]djpi2\f[R].
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHRotateTapers\f[R] will rotate a set of orthogonal spherical-cap
Slepian functions originally centered at the North pole to a different
location according to the three Euler angles in the vector \f[C]x\f[R].
The original matrix \f[C]tapers\f[R] is computed by a call to
\f[C]SHReturnTapers\f[R].
Only the first \f[C]nrot\f[R] tapers are rotated, each of which is
returned in a column of the output matrix \f[C]tapersrot\f[R].
The spherical harmonic coefficients are geodesy 4pi normalized, and each
column of \f[C]tapersrot\f[R] can be unpacked using
\f[C]SHVectorCilm\f[R].
The input rotation matrix \f[C]dj\f[R] is computed by a call to
\f[C]djpi2\f[R].
.PP
The rotation of a coordinate system or body can be viewed in two
complementary ways involving three successive rotations.
Both methods have the same initial and final configurations, and the
angles listed in both schemes are the same.
.PP
\f[C]Scheme A:\f[R]
.IP "  (I)" 6
Rotation about the z axis by alpha.
.IP " (II)" 6
Rotation about the new y axis by beta.
.IP "(III)" 6
Rotation about the new z axis by gamma.
.PP
\f[C]Scheme B:\f[R]
.IP "  (I)" 6
Rotation about the z axis by gamma.
.IP " (II)" 6
Rotation about the initial y axis by beta.
.IP "(III)" 6
Rotation about the initial z axis by alpha.
.PP
The rotations can further be viewed either as a rotation of the
coordinate system or the physical body.
For a rotation of the coordinate system without rotation of the physical
body, use
.PP
\f[C]x(alpha, beta, gamma)\f[R].
.PP
For a rotation of the physical body without rotation of the coordinate
system, use
.PP
\f[C]x(-gamma, -beta, -alpha)\f[R].
.PP
To perform the inverse transform of \f[C]x(alpha, beta, gamma)\f[R], use
\f[C]x(-gamma, -beta, -alpha)\f[R].
.PP
Note that this routine uses the \[lq]y convention\[rq], where the second
rotation is with respect to the new y axis.
If alpha, beta, and gamma were originally defined in terms of the \[lq]x
convention\[rq], where the second rotation was with respect to the new x
axis, the Euler angles according to the y convention would be
\f[C]alpha_y=alpha_x-pi/2\f[R], \f[C]beta_x=beta_y\f[R], and
\f[C]gamma_y=gamma_x+pi/2\f[R].
.PP
This routine first converts the real coefficients to complex form using
\f[C]SHrtoc\f[R].
Then the coefficients are converted to indexed form using
\f[C]SHCilmToCindex\f[R], these are sent to \f[C]SHRotateCoef\f[R], the
result if converted back to \f[C]cilm\f[R] complex form using
\f[C]SHCindexToCilm\f[R], and these are finally converted back to real
form using \f[C]SHctor\f[R].
.SH See also
.PP
djpi2, shreturntapers, shctor, shrtoc, shcilmtocindex, shcindextocilm,
shvectortocilm
