.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.14)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SHROTATEREALCOEF 1"
.TH SHROTATEREALCOEF 1 "2014-10-02" "SHTOOLS 3.0" "SHTOOLS 3.0"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "SHRotateRealCoef"
.IX Header "SHRotateRealCoef"
.IP "SHRotateRealCoef \-" 19
.IX Item "SHRotateRealCoef -"
Determine the spherical harmonic coefficients of a real function rotated by three Euler angles.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.IP "\s-1SUBROUTINE\s0 SHRotateRealCoef (" 30
.IX Item "SUBROUTINE SHRotateRealCoef ("
\&\s-1CILMROT\s0, \s-1CILM\s0, \s-1LMAX\s0, X, \s-1DJ\s0 )
.RS 4
.IP "REAL*8" 10
.IX Item "REAL*8"
\&\s-1CILMROT\s0(2, \s-1LMAX+1\s0, \s-1LMAX+1\s0), \s-1CILM\s0(2,\ \s-1LMAX+1\s0,\ \s-1LMAX+1\s0), X(3), \s-1DJ\s0(\s-1LMAX+1\s0,\ \s-1LMAX+1\s0,\ \s-1LMAX+1\s0)
.IP "\s-1INTEGER\s0" 10
.IX Item "INTEGER"
\&\s-1LMAX\s0
.RE
.RS 4
.RE
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fISHRotateRealCoef\fR will take the real spherical harmonic coefficients of a function, rotate it according to the three Euler anlges in X, and output the spherical harmonic coefficients of the rotated function. The input and output coefficients must correspond to geodesy 4\-pi normalized spherical harmonics that do not possess the Condon-Shortley phase convention. The input rotation matrix \s-1DJ\s0 is computed by a call to \fIDJPi2\fR.
.PP
The rotation of a coordinate system or body can be viewed in two complementary ways involving three successive rotations. Both methods have the same initial and final configurations, and the angles listed in both schemes are the same.
.IP "Scheme A:" 12
.IX Item "Scheme A:"
(I) Rotation about the z axis by alpha.
.Sp
(\s-1II\s0) Rotation about the new y axis by beta.
.Sp
(\s-1III\s0) Rotation about the new z axis by gamma.
.IP "Scheme B:" 12
.IX Item "Scheme B:"
(I) Rotation about the z axis by gamma.
.Sp
(\s-1II\s0) Rotation about the initial y axis by beta.
.Sp
(\s-1III\s0) Rotation about the initial z axis by alpha.
.PP
The rotations can further be viewed either as a rotation of the coordinate system or the physical body. For a rotation of the coordinate system without rotation of the physical body, use
.Sp
.RS 12
X(alpha, beta, gamma).
.RE
.PP
For a rotation of the physical body without rotation of the coordinate system, use
.Sp
.RS 12
X(\-gamma, \-beta, \-alpha).
.RE
.PP
To perform the inverse transform of X(alpha, beta, gamma), use X(\-gamma, \-beta, \-alpha).
.PP
Note that this routine uses the \*(L"y convention\*(R", where the second rotation is with respect to the new y axis. If alpha, beta, and gamma were orginally defined in terms of the \*(L"x convention\*(R", where the second rotation was with respect to the newx axis, the Euler angles according to the y convention would be alpha_y = alpha_x \- pi/2, beta_x = beta_y, and gamma_y = gamma_x + pi/2.
.SH "ARGUMENTS"
.IX Header "ARGUMENTS"
.IP "\s-1CILMROT\s0" 13
.IX Item "CILMROT"
(output) REAL*8, \s-1DIMENSION\s0 (2, \s-1LMAX+1\s0, \s-1LMAX+1\s0)
.Sp
The spherical harmonic coefficients of the rotated function, normalized for use with the geodesy 4\-pi spherical harmonics.
.IP "\s-1CILM\s0" 13
.IX Item "CILM"
(input) REAL*8, \s-1DIMENSION\s0 (2, \s-1LMAX+1\s0, \s-1LMAX+1\s0)
.Sp
The input real spherical harmonic coefficients. The coefficients must correspond to geodesy 4\-pi normalized spherical harmonics that do not possess the Condon-Shortley phase convention.
.IP "X" 13
.IX Item "X"
(input) REAL*8, \s-1DIMENSION\s0(3 )
.Sp
The three Euler angles, alpha, beta, and gamma.
.IP "\s-1DJ\s0" 13
.IX Item "DJ"
(input) REAL*8, \s-1DIMENSION\s0 (\s-1LMAX+1\s0, \s-1LMAX+1\s0, \s-1LMAX+1\s0)
.Sp
The rotation matrix \s-1DJ\s0(pi/2), obtained from a call to \fIDJPi2\fR.
.IP "\s-1LMAX\s0" 13
.IX Item "LMAX"
(input) \s-1INTEGER\s0, \s-1OPTIONAL\s0
.Sp
The maximum spherical harmonic degree of the input and output coefficients.
.SH "NOTES"
.IX Header "NOTES"
This routine first converts the real coefficients to complex form using \fISHrtoc\fR. If the compilation-time parameter \s-1CSPHASE_DEFAULT\s0 is set to 1 (default), then the Condon-Shortley phase of the coefficients is modified. Then the coefficients are converted to indexed form using \fISHCilmToCindex\fR, these are sent to \fISHRotateCoef\fR, the result if converted back to \s-1CILM\s0 complex form using \fISHCindexToCilm\fR, and these are finally converted back to real form using \fISHctor\fR.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIdjpi2\fR\|(1), \fIshrotatecoef\fR\|(1), \fIshctor\fR\|(1), \fIshrtoc\fR\|(1), \fIshcilmtocindex\fR\|(1), \fIshcindextocilm\fR\|(1)
.PP
<http://shtools.ipgp.fr/>
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright 2012 by Mark Wieczorek <wieczor@ipgp.fr>.
.PP
This is free software; you can distribute and modify it under the terms of the revised \s-1BSD\s0 license.
