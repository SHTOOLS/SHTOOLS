.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SHRETURNTAPERSMAP 1"
.TH SHRETURNTAPERSMAP 1 "2015-03-10" "SHTOOLS 3.0" "SHTOOLS 3.0"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "SHReturnTapersMap"
.IX Header "SHReturnTapersMap"
.IP "SHReturnTapersMap \-" 20
.IX Item "SHReturnTapersMap -"
Calculate the eigenfunctions and eigenvalues of the space-concentration problem for an arbitrary region.
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.IP "\s-1SUBROUTINE\s0 SHReturnTapersMap (" 31
.IX Item "SUBROUTINE SHReturnTapersMap ("
\&\s-1TAPERS, EIGENVALUES, DH_MASK, N, LMAX, SAMPLING, NTAPERS \s0)
.RS 4
.IP "REAL*8" 20
.IX Item "REAL*8"
\&\s-1TAPERS\s0\ (\ (\s-1LMAX+1\s0)**2,\ (\s-1LMAX+1\s0)**2\ ) or (\ (\s-1LMAX+1\s0)**2,\ \s-1NTAPERS\s0\ ), \s-1EIGENVALUES\s0(\ \s-1LMAX+1\s0\ )\ or\ (\s-1NTAPERS\s0)
.IP "\s-1INTEGER\s0" 20
.IX Item "INTEGER"
\&\s-1DH_MASK \s0(N, N) or (N, 2*N), N, \s-1LMAX\s0
.IP "\s-1INTEGER, OPTIONAL\s0" 20
.IX Item "INTEGER, OPTIONAL"
\&\s-1SAMPLING, NTAPERS\s0
.RE
.RS 4
.RE
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fISHReturnTapersMap\fR will calculate the eigenfunctions (i.e., localization windows) of the space-concentration problem for an arbitrary concentration region specified in \s-1DH_MASK \s0(see Simons et al. (2006) for further details). The input mask \s-1DH_MASK\s0 must be sampled according to the Driscoll and Healy (1994) sampling theorem with N samples in latitude, and possess a value of 1 inside the concentration region, and 0 elsewhere. \s-1DH_MASK\s0 can either possess N samples in longitude (SAMPLING=1) or 2*N samples in longitude (SAMPLING=2). Given the approximate way in which the elements of the space-concentration kernel are calculated (see \fIComputeDMap\fR for details), SAMPLING=2 should be preferred. Furthermore, the effective spherical harmonic bandwidth (L=N/2\-1) of the grid \s-1DH_MASK\s0 determines the accuracy of the results, and experience shows that this should be about 4 times larger than \s-1LMAX. \s0
.PP
The spherical harmonic coefficients of each window are given in the columns of \s-1TAPERS,\s0 and the corresponding concentration factors are given in \s-1EIGENVAULES.\s0 The spherical harmonic coefficients are ordered according to the scheme described in \fIYilmIndex\fR, which can be converted to matrix form using \fISHVectorToCilm\fR, and the columns of \s-1TAPERS\s0 are ordered from best to worst concentrated. The localization windows are normalized such that they have unit power. If the optional parameter \s-1NTAPERS\s0 is specified, then only the \s-1NTAPERS\s0 largest eigenvalues and corresponding eigenfunctions will be calculated and returned.
.SH "ARGUMENTS"
.IX Header "ARGUMENTS"
.IP "\s-1TAPERS\s0" 14
.IX Item "TAPERS"
(input) REAL*8 \s-1DIMENSION \s0( (\s-1LMAX+1\s0)**2, (\s-1LMAX+1\s0)**2 ) or ( (\s-1LMAX+1\s0)**2, \s-1NTAPERS \s0)
.Sp
The spherical harmonic coefficients of the tapers, arranged in columns, from best to worst concentrated. The spherical harmonic coefficients in each column are indexed according to the scheme described in \fIYilmIndex\fR.
.IP "\s-1EIGENVALUES\s0" 14
.IX Item "EIGENVALUES"
(input) REAL*8 \s-1DIMENSION \s0( (\s-1LMAX+1\s0)**2 ) or ( \s-1NTAPERS \s0)
.Sp
The concentration factor for each localization window specified in the columns of \s-1TAPERS.\s0
.IP "\s-1DH_MASK\s0" 14
.IX Item "DH_MASK"
(input) \s-1INTEGER, DIMENSION \s0(N, N) or \s-1DIMENSION \s0(N, 2*N)
.Sp
A Driscoll and Healy (1994) sampled grid describing the concentration region R. All elements should either be 1 (for inside the concentration region) or 0 (for outside R).
.IP "N" 14
.IX Item "N"
(input) \s-1INTEGER\s0
.Sp
The number of latitudinal samples in \s-1DH_MASK.\s0 The effective spherical harmonic bandwidth of this grid is L = N/2 \- 1.
.IP "\s-1LMAX\s0" 14
.IX Item "LMAX"
(input) \s-1INTEGER\s0
.Sp
The spherical harmonic bandwidth of the localization windows.
.IP "\s-1SAMPLING\s0" 14
.IX Item "SAMPLING"
(input) \s-1INTEGER\s0
.Sp
For 1 (default), \s-1DH_MASK\s0 has N x N samples. For 2, \s-1DH_MASK\s0 has N x 2N samples.
.IP "\s-1NTAPERS\s0" 14
.IX Item "NTAPERS"
(input) \s-1INTEGER, OPTIONAL\s0
.Sp
The number of best concentrated eigenvalues and corresponding eigenfunctions to return in \s-1TAPERS\s0 and \s-1EIGENVALUES.\s0
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fIcomputedmap\fR\|(1), \fIyilmindex\fR\|(1), \fIshvectortocilm\fR\|(1)
.PP
<http://shtools.ipgp.fr/>
.SH "REFERENCES"
.IX Header "REFERENCES"
Driscoll, J.R. and D.M. Healy, Computing Fourier transforms and convolutions on the 2\-sphere, \fIAdv. Appl. Math.\fR, 15, 202\-250, 1994.
.PP
Simons, F.J., F.A. Dahlen, and M.A. Wieczorek, Spatiospectral concentration on a sphere, \fI\s-1SIAM\s0 Review\fR, 48, 504\-536, 2006.
.SH "COPYRIGHT AND LICENSE"
.IX Header "COPYRIGHT AND LICENSE"
Copyright 2012 by Mark Wieczorek <wieczor@ipgp.fr>.
.PP
This is free software; you can distribute and modify it under the terms of the revised \s-1BSD\s0 license.
