.\" Automatically generated by Pandoc 2.1.3
.\"
.TH "pyshmultitapermaskcse" "1" "2017\-11\-28" "Python" "SHTOOLS 4.2"
.hy
.SH SHMultiTaperMaskCSE
.PP
Perform a localized multitaper cross\-spectral analysis using arbitrary
windows derived from a mask.
.SH Usage
.PP
\f[C]mtse\f[], \f[C]sd\f[] = SHMultiTaperMaskCSE (\f[C]sh1\f[],
\f[C]sh2\f[], \f[C]tapers\f[], [\f[C]lmax1\f[], \f[C]lmax2\f[],
\f[C]lmaxt\f[], \f[C]k\f[], \f[C]taper_wt\f[], \f[C]norm\f[],
\f[C]csphase\f[]])
.SH Returns
.TP
.B \f[C]mtse\f[] : float, dimension (\f[C]lmax\f[]\-\f[C]lmaxt\f[]+1)
The localized multitaper cross\-power spectrum estimate.
\f[C]lmax\f[] is the smaller of \f[C]lmax1\f[] and \f[C]lmax2\f[].
.RS
.RE
.TP
.B \f[C]sd\f[] : float, dimension (\f[C]lmax\f[]\-\f[C]lmaxt\f[]+1)
The standard error of the localized multitaper cross\-power spectral
estimates.
\f[C]lmax\f[] is the smaller of \f[C]lmax1\f[] and \f[C]lmax2\f[].
.RS
.RE
.SH Parameters
.TP
.B \f[C]sh1\f[] : float, dimension (2, \f[C]lmax1in\f[]+1, \f[C]lmax1in\f[]+1)
The spherical harmonic coefficients of the first function.
.RS
.RE
.TP
.B \f[C]sh2\f[] : float, dimension (2, \f[C]lmax2in\f[]+1, \f[C]lmax2in\f[]+1)
The spherical harmonic coefficients of the second function.
.RS
.RE
.TP
.B \f[C]tapers\f[] : float, dimension ((\f[C]lmaxtin\f[]+1)**2, \f[C]kin\f[])
An array of the \f[C]k\f[] windowing functions, arranged in columns,
obtained from a call to \f[C]SHReturnTapersMap\f[].
The spherical harmonic coefficients are packed according to the
conventions in \f[C]SHCilmToVector\f[].
.RS
.RE
.TP
.B \f[C]lmax1\f[] : optional, integer, default = \f[C]lmax1in\f[]
The spherical harmonic bandwidth of \f[C]sh1\f[].
This must be less than or equal to \f[C]lmax1in\f[].
.RS
.RE
.TP
.B \f[C]lmax2\f[] : optional, integer, default = \f[C]lmax2in\f[]
The spherical harmonic bandwidth of \f[C]sh2\f[].
This must be less than or equal to \f[C]lmax2in\f[].
.RS
.RE
.TP
.B \f[C]lmaxt\f[] : optional, integer, default = \f[C]lmaxtin\f[]
The spherical harmonic bandwidth of the windowing functions in the array
\f[C]tapers\f[].
.RS
.RE
.TP
.B \f[C]k\f[] : optional, integer, default = \f[C]kin\f[]
The number of tapers to be utilized in performing the multitaper
spectral analysis.
.RS
.RE
.TP
.B \f[C]taper_wt\f[] : optional, float, dimension (\f[C]kin\f[]), default = \-1
The weights used in calculating the multitaper spectral estimates and
standard error.
Optimal values of the weights (for a known global power spectrum) can be
obtained from the routine \f[C]SHMTVarOpt\f[].
The default value specifies not to use \f[C]taper_wt\f[].
.RS
.RE
.TP
.B \f[C]norm\f[] : optional, intger, default = 1
1 (default) = 4\-pi (geodesy) normalized harmonics; 2 = Schmidt
semi\-normalized harmonics; 3 = unnormalized harmonics; 4 = orthonormal
harmonics.
.RS
.RE
.TP
.B \f[C]csphase\f[] : optional, integer, default = 1
1 (default) = do not apply the Condon\-Shortley phase factor to the
associated Legendre functions; \-1 = append the Condon\-Shortley phase
factor of (\-1)^m to the associated Legendre functions.
.RS
.RE
.SH Description
.PP
\f[C]SHMultiTaperMaskCSE\f[] will perform a localized multitaper
cross\-spectral analysis of two input functions expressed in spherical
harmonics, \f[C]SH1\f[] and \f[C]SH2\f[], using an arbitrary set of
windows derived from a mask.
The maximum degree of the localized multitaper power spectrum estimate
is \f[C]lmax\-lmaxt\f[], where \f[C]lmax\f[] is the smaller of
\f[C]lmax1\f[] and \f[C]lmax2\f[].
The matrix \f[C]tapers\f[] contains the spherical harmonic coefficients
of the windows and can be obtained by a call to
\f[C]SHReturnTapersMap\f[].
The coefficients of each window are stored in a single column, ordered
according to the conventions used in \f[C]SHCilmToVector\f[].
.PP
If the optional array \f[C]taper_wt\f[] is specified, then these weights
will be used in calculating a weighted average of the individual
\f[C]k\f[] tapered estimates (\f[C]mtse\f[]) and the corresponding
standard error of the estimates (\f[C]sd\f[]).
If not present, the weights will all be assumed to be equal.
When \f[C]taper_wt\f[] is not specified, the mutltitaper spectral
estimate for a given degree is calculated as the average obtained from
the \f[C]k\f[] individual tapered estimates.
The standard error of the multitaper estimate at degree l is simply the
population standard deviation,
\f[C]S\ =\ sqrt(sum\ (Si\ \-\ mtse)^2\ /\ (k\-1))\f[], divided by
sqrt(\f[C]k\f[]).
See Wieczorek and Simons (2007) for the relevant expressions when
weighted estimates are used.
.PP
The employed spherical harmonic normalization and Condon\-Shortley phase
convention can be set by the optional arguments \f[C]norm\f[] and
\f[C]csphase\f[]; if not set, the default is to use geodesy 4\-pi
normalized harmonics that exclude the Condon\-Shortley phase of (\-1)^m.
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum\-variance multitaper spectral estimation on the sphere,
J.
Fourier Anal.
Appl., 13, doi:10.1007/s00041\-006\-6904\-1, 665\-692, 2007.
.SH See also
.PP
shmultitapermaskse, shreturntapersmap, shcilmtovector
