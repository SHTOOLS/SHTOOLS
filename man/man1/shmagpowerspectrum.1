.\" Automatically generated by Pandoc 2.7.3
.\"
.TH "shmagpowerspectrum" "1" "2019-09-17" "Fortran 95" "SHTOOLS 4.5"
.hy
.SH SHMagPowerSpectrum
.PP
Compute the power spectrum of the magnetic field given the Schmidt
seminormalized magnetic potential spherical harmonic coefficients.
.SH Usage
.PP
call SHMagPowerSpectrum (\f[C]c\f[R], \f[C]a\f[R], \f[C]r\f[R],
\f[C]lmax\f[R], \f[C]spectrum\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
.B \f[C]c\f[R] : input, real(dp), dimension (2, \f[C]lmax\f[R]+1, \f[C]lmax\f[R]+1)
The Schmidt seminormalized spherical harmonic coefficients of the
magnetic potential.
.TP
.B \f[C]a\f[R] : input, real(dp)
The reference radius of the magnetic potential spherical harmonic
coefficients.
.TP
.B \f[C]r\f[R] : input, real(dp)
The radius to evaluate the magnetic field.
.TP
.B \f[C]lmax\f[R] : input, integer
The maximum spherical harmonic degree to calculate the power spectrum.
.TP
.B \f[C]spectrum\f[R] : output, real(dp), dimension (\f[C]lmax\f[R]+1)
The power spectrum of the magnetic field.
.TP
.B \f[C]exitstatus\f[R] : output, optional, integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHMagPowerSpectrum\f[R] will calculate the power spectrum of the
magnetic field at radius \f[C]r\f[R] given the magnetic potential
Schmidt seminormalized spherical harmonic coefficients \f[C]c\f[R]
evaluated at radius \f[C]a\f[R].
For a given degree \f[C]l\f[R], this is explicitly calculated as (Lowes
1966):
.PP
\f[C]S(l) = (l+1) (a/r)**(2l+4) Sum_{m=0}\[ha]l [ c(1, l+1, m+1)**2 + c(2, l+1, m+1)**2 ].\f[R]
.SH Reference
.PP
Lowes, F.
J., Mean-square values on sphere of spherical harmonic fields, J.
Geophys.
Res., 71(8), 2179, 1966.
.SH See also
.PP
shmagpowerl
