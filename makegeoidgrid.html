<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="fortran,  spherical harmonics software package, spherical harmonic transform, legendre functions, multitaper spectral analysis, fortran, Python, gravity, magnetic field">
<title>MakeGeoidGrid (Fortran) | SHTOOLS - Tools for working with spherical harmonics</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://shtools.github.io/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> SHTOOLS</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                <!-- entries without drop-downs appear here -->




                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/" target="_blank">GitHub</a></li>
                
                
                
                <li><a href="https://github.com/SHTOOLS/SHTOOLS/wiki" target="_blank">Wiki</a></li>
                
                
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
			<li>



  <a class="email" title="Submit feedback" href="#" onclick="javascript:window.location='mailto:mark.wieczorek@oca.eu?subject=SHTOOLS feedback&body=I have some feedback about MakeGeoidGrid (Fortran) page: ' + window.location.href;"><i class="fa fa-envelope-o"></i> Feedback</a>

</li>

		
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="MakeGeoidGrid (Fortran)">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">SHTOOLS 4.2</li>
  
  
  
      
  
  <li>
      <a href="#">Getting started</a>
      <ul>
          
          
          
          <li><a href="index.html">Overview</a></li>
          
          
          
          
          
          
          <li><a href="installing.html">Installing</a></li>
          
          
          
          
          
          
          <li><a href="using-with-f95.html">Using with Fortran 95</a></li>
          
          
          
          
          
          
          <li><a href="using-with-python.html">Using with Python</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Spherical harmonics</a>
      <ul>
          
          
          
          <li><a href="real-spherical-harmonics.html">Real spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="complex-spherical-harmonics.html">Complex spherical harmonics</a></li>
          
          
          
          
          
          
          <li><a href="implementation-details.html">Implementation details</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Fortran 95 Routines</a>
      <ul>
          
          
          
          <li><a href="f95-modules.html">Modules</a></li>
          
          
          
          
          
          
          <li><a href="legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="global-spectral-analysis.html">Global spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="localized-spectral-analysis.html">Localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="miscellaneous-routines.html">Miscellaneous</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Python components</a>
      <ul>
          
          
          
          <li><a href="python-classes.html">Python classes</a></li>
          
          
          
          
          
          
          <li><a href="python-legendre-functions.html">Legendre functions</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-transforms.html">Spherical harmonic transformations</a></li>
          
          
          
          
          
          
          <li><a href="python-io.html">I/O, storage, conversions</a></li>
          
          
          
          
          
          
          <li><a href="python-spectral-analysis.html">Global and localized spectral analysis</a></li>
          
          
          
          
          
          
          <li><a href="python-spherical-harmonic-rotations.html">Spherical harmonic rotations</a></li>
          
          
          
          
          
          
          <li><a href="python-gravity-magnetics.html">Gravity and magnetics</a></li>
          
          
          
          
          
          
          <li><a href="python-utilities.html">Utilities</a></li>
          
          
          
          
          
          
          <li><a href="python-constants.html">Constants</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Examples programs</a>
      <ul>
          
          
          
          <li><a href="python-examples.html">Python examples</a></li>
          
          
          
          
          
          
          <li><a href="fortran-examples.html">Fortran 95 examples</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Support</a>
      <ul>
          
          
          
          <li><a href="faq.html">FAQ</a></li>
          
          
          
          
          
          
          <li><a href="fortran-95-problems.html">Fortran 95 problems</a></li>
          
          
          
          
          
          
          <li><a href="how-to-contribute.html">How to contribute</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a href="#">Release Notes</a>
      <ul>
          
          
          
          <li><a href="release-notes-v4.html">Version 4</a></li>
          
          
          
          
          
          
          <li><a href="release-notes-v3.html">Version 3</a></li>
          
          
          
          
          
          
          <li><a href="license.html">License</a></li>
          
          
          
          
          
          
          <li><a href="contributors.html">Contributors</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  displayAlign: "left",
  displayIndent: "2em"
});
</script>

<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<div class="post-header">
   <h1 class="post-title-main">MakeGeoidGrid (Fortran)</h1>
</div>



<div class="post-content">

   

    


    


    

  <p>Create a global map of the geoid.</p>

<h2 id="usage">Usage</h2>

<p>call MakeGeoidGrid (<code class="highlighter-rouge">geoid</code>, <code class="highlighter-rouge">cilm</code>, <code class="highlighter-rouge">lmax</code>, <code class="highlighter-rouge">r0</code>, <code class="highlighter-rouge">gm</code>, <code class="highlighter-rouge">potref</code>, <code class="highlighter-rouge">omega</code>, <code class="highlighter-rouge">r</code>, <code class="highlighter-rouge">gridtype</code>, <code class="highlighter-rouge">order</code>, <code class="highlighter-rouge">nlat</code>, <code class="highlighter-rouge">nlong</code>, <code class="highlighter-rouge">interval</code>, <code class="highlighter-rouge">lmax_calc</code>, <code class="highlighter-rouge">a</code>, <code class="highlighter-rouge">f</code>, <code class="highlighter-rouge">exitstatus</code>)</p>

<h2 id="parameters">Parameters</h2>

<dl>
  <dt><code class="highlighter-rouge">geoid</code> : output, real*8, dimension(<code class="highlighter-rouge">nlat</code>, <code class="highlighter-rouge">nlong</code>)</dt>
  <dd>A global grid of the height to the potential <code class="highlighter-rouge">potref</code> above a sphere of radius <code class="highlighter-rouge">r</code> (or above a flattened ellipsoid if both <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">f</code> are specified). The number of latitude and longitude points depends upon <code class="highlighter-rouge">gridtype</code>: (1) <code class="highlighter-rouge">lmax+1</code> by <code class="highlighter-rouge">2lmax+1</code>, (2) <code class="highlighter-rouge">2lmax+2</code> by <code class="highlighter-rouge">2lmax+2</code>, (3) <code class="highlighter-rouge">2lmax+2</code> by <code class="highlighter-rouge">4lmax+4</code>, or (4) <code class="highlighter-rouge">180/interval+1</code> by <code class="highlighter-rouge">360/interval+1</code>.</dd>
  <dt><code class="highlighter-rouge">cilm</code> : input, real*8, dimension (2, <code class="highlighter-rouge">lmax</code>+1, <code class="highlighter-rouge">lmax</code>+1)</dt>
  <dd>The real spherical harmonic coefficients (geodesy normalized) of the gravitational potential referenced to a spherical interface of radius <code class="highlighter-rouge">r0pot</code>.</dd>
  <dt><code class="highlighter-rouge">lmax</code> : input, integer</dt>
  <dd>The maximum spherical harmonic degree of the gravitational-potential coefficients. For <code class="highlighter-rouge">gridtype</code>s 1, 2 and 3, this determines the number of latitudinal and longitudinal samples.</dd>
  <dt><code class="highlighter-rouge">r0</code> : input, real*8</dt>
  <dd>The reference radius of the spherical harmonic coefficients.</dd>
  <dt><code class="highlighter-rouge">gm</code> : input, real*8</dt>
  <dd>The product of the gravitational constant and mass of the planet.</dd>
  <dt><code class="highlighter-rouge">potref</code> : input, real*8</dt>
  <dd>The value of the potential on the chosen geoid, in SI units.</dd>
  <dt><code class="highlighter-rouge">omega</code> : input, real*8</dt>
  <dd>The angular rotation rate of the planet.</dd>
  <dt><code class="highlighter-rouge">r</code> : input, real*8</dt>
  <dd>The radius of the reference sphere that the Taylor expansion of the potential is performed on. If <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">f</code> are not specified, the geoid height will be referenced to this spherical interface.</dd>
  <dt><code class="highlighter-rouge">gridtype</code> : input, integer</dt>
  <dd>The output grid is (1) a Gauss-Legendre quadrature grid whose grid nodes are determined by <code class="highlighter-rouge">lmax</code>, (2) an equally sampled <code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">n</code> grid used with the Driscoll and Healy (1994) sampling theorem, (3) ar a similar <code class="highlighter-rouge">n</code> by 2<code class="highlighter-rouge">n</code> grid that is oversampled in longitude, or (4) a 2D Cartesian grid with latitudinal and longitudinal spacing given by <code class="highlighter-rouge">interval</code>.</dd>
  <dt><code class="highlighter-rouge">order</code> : input, integer</dt>
  <dd>The order of the Taylor series expansion of the potential about the reference radius <code class="highlighter-rouge">r</code>. This can be either 1, 2, or 3.</dd>
  <dt><code class="highlighter-rouge">nlat</code> : output, integer</dt>
  <dd>The number of latitudinal samples.</dd>
  <dt><code class="highlighter-rouge">nlong</code> : output, integer</dt>
  <dd>The number of longitudinal samples.</dd>
  <dt><code class="highlighter-rouge">interval</code>: optional, input, real*8</dt>
  <dd>The latitudinal and longitudinal spacing of the output grid when <code class="highlighter-rouge">gridtype</code> is 4.</dd>
  <dt><code class="highlighter-rouge">lmax_calc</code> : optional, input, integer</dt>
  <dd>The maximum degree used in evaluating the spherical harmonic coefficients. This must be less than or equal to <code class="highlighter-rouge">lmax</code>.</dd>
  <dt><code class="highlighter-rouge">a</code> : optional, input, real*8, default = <code class="highlighter-rouge">r0</code></dt>
  <dd>The semi-major axis of the flattened ellipsoid that the output grid <code class="highlighter-rouge">geoid</code> is referenced to. The optional parameter <code class="highlighter-rouge">f</code> must also be specified.</dd>
  <dt><code class="highlighter-rouge">f</code> : optional, input, real*8, default = 0</dt>
  <dd>The flattening <code class="highlighter-rouge">(R_equator-R_pole)/R_equator</code> of the reference ellipsoid. The optional parameter <code class="highlighter-rouge">a</code> (i.e., <code class="highlighter-rouge">R_equator</code>) must be specified.</dd>
  <dt><code class="highlighter-rouge">exitstatus</code> : output, optional, integer</dt>
  <dd>If present, instead of executing a STOP when an error is encountered, the variable exitstatus will be returned describing the error. 0 = No errors; 1 = Improper dimensions of input array; 2 = Improper bounds for input variable; 3 = Error allocating memory; 4 = File IO error.</dd>
</dl>

<h2 id="description">Description</h2>

<p><code class="highlighter-rouge">MakeGeoidGrid</code> will create a global map of the geoid, accurate to either first, second, or third order, using the method described in Wieczorek (2007; equation 19-20). The algorithm expands the potential in a Taylor series on a spherical interface of radius <code class="highlighter-rouge">r</code>, and computes the height above this interface to the potential <code class="highlighter-rouge">potref</code> exactly from the linear, quadratic, or cubic equation at each grid point. If the optional parameters <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">f</code> are specified, the geoid height will be referenced to a flattened ellipsoid with semi-major axis <code class="highlighter-rouge">a</code> and flattening <code class="highlighter-rouge">f</code>. The pseudo-rotational potential is explicitly accounted for by specifying the angular rotation rate <code class="highlighter-rouge">omega</code> of the planet.</p>

<p>It should be noted that this geoid calculation is only strictly exact when the radius <code class="highlighter-rouge">r</code> lies above the maximum radius of the planet. Furthermore, the geoid is only strictly valid when it lies above the surface of the planet (it is necessary to know the density structure of the planet when calculating the potential below the surface).</p>

<p>The geoid can be computed on one of four different grids: (1) a Gauss-Legendre quadrature grid (see <code class="highlighter-rouge">MakeGridGLQ</code>), (2) A <code class="highlighter-rouge">n</code> by <code class="highlighter-rouge">n</code> equally sampled grid (see <code class="highlighter-rouge">MakeGridDH</code>), (3) an <code class="highlighter-rouge">n</code> by 2<code class="highlighter-rouge">n</code> equally spaced grid (see <code class="highlighter-rouge">MakeGridDH</code>), or (4) A 2D Cartesian grid (see <code class="highlighter-rouge">MakeGrid2D</code>). This routine uses geodesy 4-pi normalized spherical harmonics that exclude the Condon-Shortley phase. This can not be modified.</p>

<h2 id="references">References</h2>

<p>Driscoll, J.R. and D.M. Healy, Computing Fourier transforms and convolutions on the 2-sphere, Adv. Appl. Math., 15, 202-250, 1994.</p>

<p>Wieczorek, M. A. Gravity and topography of the terrestrial planets, Treatise on Geophysics, 10, 165-206, 2007.</p>

<h2 id="see-also">See also</h2>

<p><a href="makegrid2d.html">makegrid2d</a>, <a href="makegridglq.html">makegridglq</a>, <a href="makegriddh.html">makegriddh</a>, <a href="makegravgriddh.html">makegravgriddh</a>, <a href="makegravgradgriddh.html">makegravgradgriddh</a></p>


    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_fortran.html" class="btn btn-default navbar-btn cursorNorm" role="button">fortran</a>
        
        
        
    </div>

</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               &copy;2017 SHTOOLS. All rights reserved. <br />
<a href="https://www.oca.eu/?lang=en" target="_blank" rel="noopener">Observatoire de la CÃ´te d'Azur</a><br />
<a href="https://lagrange.oca.eu/fr/accueil-lagrange" target="_blank" rel="noopener">Laboratoire Lagrange</a><br />
<p><img src="images/company_logo.png" alt="SHTOOLS"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
